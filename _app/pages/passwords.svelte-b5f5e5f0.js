import{X as ue,Y as Ne,Z as Ue,C as je,W as Ie,_ as Oe,a0 as De,S as Q,i as R,s as x,a1 as ie,a2 as fe,e as k,k as U,t as A,j as C,c as $,a as j,d as m,n as I,g as S,m as G,b as d,L as Z,f as P,F as b,a3 as O,o as W,M as B,a4 as ce,x as q,u as J,v as X,a5 as ee,a6 as pe,J as de,h as te,l as _e,r as he,w as me,a7 as we,K as Ke,a8 as Ae}from"../chunks/vendor-f23cb189.js";import{g as se,r as le,L as Se}from"../chunks/keys-ac9139ce.js";import{M as be}from"../chunks/Modal-4ba55855.js";import{b as ne}from"../chunks/paths-28a87002.js";import"../chunks/preload-helper-04e99934.js";const z=je({}),Be=ue(z,l=>Object.entries(l).map(([e,s])=>[e,Object.entries(s).map(([t,o])=>({username:t,password:o}))]));ue(z,Object.keys);function Me(l,e,s){z.update(t=>{const o=t[l]||(t[l]={});return o[e]=s,t}),ge()}function Ve(l,e){z.update(s=>{const t=s[l]||(s[l]={});return delete t[e],s}),ge()}let ve=!1;async function ge(){if(!ve)try{const[l,e]=await se();await qe(l,e)}finally{ve=!1}}function ye(l){return Object.entries(l).reduce((e,[s,t])=>((!e[s]||!Object.keys(t).length)&&delete e[s],e),l)}async function qe(l,e){const s=ye(Ie(z)),t=await Oe({message:await De({text:JSON.stringify(s),filename:"passwords.json.pgp"}),encryptionKeys:e,signingKeys:l});await le.scope("/").storeFile("pgp","passwords.json.pgp",t)}async function ke(l,e){const s=await le.scope("/").getFile("/passwords.json.pgp").then(({data:t})=>t);if(s){const{data:t}=await Ne({message:await Ue({armoredMessage:s}),verificationKeys:e,decryptionKeys:l});z.set(ye(JSON.parse(t)))}}se().then(([l,e])=>ke(l,e)),le.on("sync-done",async()=>{const[l,e]=await se();ke(l,e)});function Je(l){let e,s;return{c(){e=k("img"),this.h()},l(t){e=$(t,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){d(e,"class","w-6 h-6"),pe(e.src,s=`${ne}/hidden.svg`)||d(e,"src",s),d(e,"alt","Show")},m(t,o){P(t,e,o)},p:de,d(t){t&&m(e)}}}function Fe(l){let e,s;return{c(){e=k("img"),this.h()},l(t){e=$(t,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){d(e,"class","w-6 h-6"),pe(e.src,s=`${ne}/visible.svg`)||d(e,"src",s),d(e,"alt","Hide")},m(t,o){P(t,e,o)},p:de,d(t){t&&m(e)}}}function He(l){let e,s,t,o,r,c,w,f,p,v,n;return{c(){e=k("p"),s=A("Delete "),t=A(l[2]),o=U(),r=A(l[0]),c=A(" Password?"),w=U(),f=k("button"),p=A("Delete"),this.h()},l(a){e=$(a,"P",{class:!0});var u=j(e);s=S(u,"Delete "),t=S(u,l[2]),o=I(u),r=S(u,l[0]),c=S(u," Password?"),u.forEach(m),w=I(a),f=$(a,"BUTTON",{class:!0});var N=j(f);p=S(N,"Delete"),N.forEach(m),this.h()},h(){d(e,"class","mb-2"),d(f,"class","btn danger")},m(a,u){P(a,e,u),b(e,s),b(e,t),b(e,o),b(e,r),b(e,c),P(a,w,u),P(a,f,u),b(f,p),v||(n=B(f,"click",l[10]),v=!0)},p(a,u){u&4&&te(t,a[2]),u&1&&te(r,a[0])},d(a){a&&m(e),a&&m(w),a&&m(f),v=!1,n()}}}function Le(l){let e,s;return{c(){e=k("h3"),s=A("Deleting Password"),this.h()},l(t){e=$(t,"H3",{slot:!0});var o=j(e);s=S(o,"Deleting Password"),o.forEach(m),this.h()},h(){d(e,"slot","title")},m(t,o){P(t,e,o),b(e,s)},d(t){t&&m(e)}}}function ze(l){let e,s,t,o,r,c,w,f,p,v,n,a,u,N,E,D,M,F,V,g;function Y(h,y){return h[4]?Fe:Je}let i=Y(l),_=i(l);function K(h){l[11](h)}let T={$$slots:{title:[Le],default:[He]},$$scope:{ctx:l}};return l[3]!==void 0&&(T.open=l[3]),D=new be({props:T}),ie.push(()=>fe(D,"open",K)),{c(){e=k("div"),s=k("div"),t=k("input"),o=U(),r=k("div"),c=k("input"),w=U(),f=k("input"),p=U(),v=k("button"),_.c(),n=U(),a=k("div"),u=k("button"),N=A("\xD7"),E=U(),C(D.$$.fragment),this.h()},l(h){e=$(h,"DIV",{class:!0});var y=j(e);s=$(y,"DIV",{class:!0});var H=j(s);t=$(H,"INPUT",{class:!0,type:!0,placeholder:!0}),H.forEach(m),o=I(y),r=$(y,"DIV",{class:!0});var L=j(r);c=$(L,"INPUT",{class:!0,type:!0,placeholder:!0}),w=I(L),f=$(L,"INPUT",{class:!0,type:!0,placeholder:!0}),p=I(L),v=$(L,"BUTTON",{class:!0});var ae=j(v);_.l(ae),ae.forEach(m),L.forEach(m),n=I(y),a=$(y,"DIV",{class:!0});var re=j(a);u=$(re,"BUTTON",{class:!0});var oe=j(u);N=S(oe,"\xD7"),oe.forEach(m),re.forEach(m),y.forEach(m),E=I(h),G(D.$$.fragment,h),this.h()},h(){d(t,"class","input h-full"),d(t,"type","text"),d(t,"placeholder","Username"),d(s,"class","relative flex-1"),d(c,"class","input h-full"),d(c,"type","text"),d(c,"placeholder","Password"),Z(c,"hidden",!l[4]),d(f,"class","input h-full"),d(f,"type","password"),d(f,"placeholder","Password"),Z(f,"hidden",l[4]),d(v,"class","text-black absolute top-0 bottom-0 right-2"),d(r,"class","relative flex-1"),d(u,"class","btn danger px-4"),d(a,"class","relative flex-grow-0"),d(e,"class","flex")},m(h,y){P(h,e,y),b(e,s),b(s,t),O(t,l[0]),b(e,o),b(e,r),b(r,c),O(c,l[1]),b(r,w),b(r,f),O(f,l[1]),b(r,p),b(r,v),_.m(v,null),b(e,n),b(e,a),b(a,u),b(u,N),P(h,E,y),W(D,h,y),F=!0,V||(g=[B(t,"input",l[5]),B(c,"input",l[6]),B(f,"input",l[7]),B(v,"click",l[8]),B(u,"click",l[9])],V=!0)},p(h,[y]){y&1&&t.value!==h[0]&&O(t,h[0]),y&2&&c.value!==h[1]&&O(c,h[1]),y&16&&Z(c,"hidden",!h[4]),y&2&&f.value!==h[1]&&O(f,h[1]),y&16&&Z(f,"hidden",h[4]),i===(i=Y(h))&&_?_.p(h,y):(_.d(1),_=i(h),_&&(_.c(),_.m(v,null)));const H={};y&4101&&(H.$$scope={dirty:y,ctx:h}),!M&&y&8&&(M=!0,H.open=h[3],ce(()=>M=!1)),D.$set(H)},i(h){F||(q(D.$$.fragment,h),F=!0)},o(h){J(D.$$.fragment,h),F=!1},d(h){h&&m(e),_.d(),h&&m(E),X(D,h),V=!1,ee(g)}}}function Ce(l,e,s){let{app:t}=e,{username:o}=e,{password:r}=e,c=!1,w=!1;function f(){o=this.value,s(0,o)}function p(){r=this.value,s(1,r)}function v(){r=this.value,s(1,r)}const n=()=>s(4,w=!w),a=()=>s(3,c=!c),u=()=>Ve(t,o);function N(E){c=E,s(3,c)}return l.$$set=E=>{"app"in E&&s(2,t=E.app),"username"in E&&s(0,o=E.username),"password"in E&&s(1,r=E.password)},[o,r,t,c,w,f,p,v,n,a,u,N]}class Ge extends Q{constructor(e){super();R(this,e,Ce,ze,x,{app:2,username:0,password:1})}}function $e(l,e,s){const t=l.slice();return t[5]=e[s][0],t[14]=e[s][1],t}function Pe(l,e,s){const t=l.slice();return t[17]=e[s],t}function We(l){let e,s,t,o,r,c,w,f,p,v;return{c(){e=k("input"),s=U(),t=k("input"),o=U(),r=k("input"),c=U(),w=k("button"),f=A("Add"),this.h()},l(n){e=$(n,"INPUT",{class:!0,type:!0,placeholder:!0}),s=I(n),t=$(n,"INPUT",{class:!0,type:!0,placeholder:!0}),o=I(n),r=$(n,"INPUT",{class:!0,type:!0,placeholder:!0}),c=I(n),w=$(n,"BUTTON",{class:!0});var a=j(w);f=S(a,"Add"),a.forEach(m),this.h()},h(){d(e,"class","input mt-1"),d(e,"type","text"),d(e,"placeholder","Application"),d(t,"class","input mt-1"),d(t,"type","text"),d(t,"placeholder","Username"),d(r,"class","input mt-1"),d(r,"type","password"),d(r,"placeholder","Password"),d(w,"class","btn primary mt-3")},m(n,a){P(n,e,a),O(e,l[5]),P(n,s,a),P(n,t,a),O(t,l[0]),P(n,o,a),P(n,r,a),O(r,l[1]),P(n,c,a),P(n,w,a),b(w,f),p||(v=[B(e,"input",l[7]),B(t,"input",l[8]),B(r,"input",l[9]),B(w,"click",l[10])],p=!0)},p(n,a){a&32&&e.value!==n[5]&&O(e,n[5]),a&1&&t.value!==n[0]&&O(t,n[0]),a&2&&r.value!==n[1]&&O(r,n[1])},d(n){n&&m(e),n&&m(s),n&&m(t),n&&m(o),n&&m(r),n&&m(c),n&&m(w),p=!1,ee(v)}}}function Te(l){let e,s;return e=new Ge({props:{app:l[5],username:l[17].username,password:l[17].password}}),{c(){C(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,o){W(e,t,o),s=!0},p(t,o){const r={};o&16&&(r.app=t[5]),o&20&&(r.username=t[17].username),o&20&&(r.password=t[17].password),e.$set(r)},i(t){s||(q(e.$$.fragment,t),s=!0)},o(t){J(e.$$.fragment,t),s=!1},d(t){X(e,t)}}}function Ee(l){let e,s,t=l[5]+"",o,r,c,w,f=l[14].filter(l[13]),p=[];for(let n=0;n<f.length;n+=1)p[n]=Te(Pe(l,f,n));const v=n=>J(p[n],1,1,()=>{p[n]=null});return{c(){e=k("h2"),s=A("Application: "),o=A(t),r=U();for(let n=0;n<p.length;n+=1)p[n].c();c=_e(),this.h()},l(n){e=$(n,"H2",{class:!0});var a=j(e);s=S(a,"Application: "),o=S(a,t),a.forEach(m),r=I(n);for(let u=0;u<p.length;u+=1)p[u].l(n);c=_e(),this.h()},h(){d(e,"class","mt-2")},m(n,a){P(n,e,a),b(e,s),b(e,o),P(n,r,a);for(let u=0;u<p.length;u+=1)p[u].m(n,a);P(n,c,a),w=!0},p(n,a){if((!w||a&16)&&t!==(t=n[5]+"")&&te(o,t),a&20){f=n[14].filter(n[13]);let u;for(u=0;u<f.length;u+=1){const N=Pe(n,f,u);p[u]?(p[u].p(N,a),q(p[u],1)):(p[u]=Te(N),p[u].c(),q(p[u],1),p[u].m(c.parentNode,c))}for(he(),u=f.length;u<p.length;u+=1)v(u);me()}},i(n){if(!w){for(let a=0;a<f.length;a+=1)q(p[a]);w=!0}},o(n){p=p.filter(Boolean);for(let a=0;a<p.length;a+=1)J(p[a]);w=!1},d(n){n&&m(e),n&&m(r),we(p,n),n&&m(c)}}}function Xe(l){let e,s,t,o,r,c,w,f,p,v,n,a,u,N,E,D;function M(i){l[11](i)}let F={$$slots:{default:[We]},$$scope:{ctx:l}};l[3]!==void 0&&(F.open=l[3]),f=new be({props:F}),ie.push(()=>fe(f,"open",M));let V=l[4],g=[];for(let i=0;i<V.length;i+=1)g[i]=Ee($e(l,V,i));const Y=i=>J(g[i],1,1,()=>{g[i]=null});return{c(){e=k("div"),s=k("button"),t=A("Add"),o=U(),r=k("a"),c=A("Keys"),w=U(),C(f.$$.fragment),v=U(),n=k("input"),a=U(),u=k("div");for(let i=0;i<g.length;i+=1)g[i].c();this.h()},l(i){e=$(i,"DIV",{class:!0});var _=j(e);s=$(_,"BUTTON",{class:!0});var K=j(s);t=S(K,"Add"),K.forEach(m),o=I(_),r=$(_,"A",{class:!0,href:!0});var T=j(r);c=S(T,"Keys"),T.forEach(m),_.forEach(m),w=I(i),G(f.$$.fragment,i),v=I(i),n=$(i,"INPUT",{class:!0,type:!0,placeholder:!0}),a=I(i),u=$(i,"DIV",{class:!0});var h=j(u);for(let y=0;y<g.length;y+=1)g[y].l(h);h.forEach(m),this.h()},h(){d(s,"class","btn primary"),d(r,"class","btn primary"),d(r,"href",`${ne}/keys`),d(e,"class","flex justify-between mb-2"),d(n,"class","input"),d(n,"type","text"),d(n,"placeholder","Search..."),d(u,"class","mt-1")},m(i,_){P(i,e,_),b(e,s),b(s,t),b(e,o),b(e,r),b(r,c),P(i,w,_),W(f,i,_),P(i,v,_),P(i,n,_),O(n,l[2]),P(i,a,_),P(i,u,_);for(let K=0;K<g.length;K+=1)g[K].m(u,null);N=!0,E||(D=[B(s,"click",l[6]),B(n,"input",l[12])],E=!0)},p(i,[_]){const K={};if(_&1048611&&(K.$$scope={dirty:_,ctx:i}),!p&&_&8&&(p=!0,K.open=i[3],ce(()=>p=!1)),f.$set(K),_&4&&n.value!==i[2]&&O(n,i[2]),_&20){V=i[4];let T;for(T=0;T<V.length;T+=1){const h=$e(i,V,T);g[T]?(g[T].p(h,_),q(g[T],1)):(g[T]=Ee(h),g[T].c(),q(g[T],1),g[T].m(u,null))}for(he(),T=V.length;T<g.length;T+=1)Y(T);me()}},i(i){if(!N){q(f.$$.fragment,i);for(let _=0;_<V.length;_+=1)q(g[_]);N=!0}},o(i){J(f.$$.fragment,i),g=g.filter(Boolean);for(let _=0;_<g.length;_+=1)J(g[_]);N=!1},d(i){i&&m(e),i&&m(w),X(f,i),i&&m(v),i&&m(n),i&&m(a),i&&m(u),we(g,i),E=!1,ee(D)}}}function Ye(l,e,s){let t;Ke(l,Be,M=>s(4,t=M));let o,r,c,w="",f=!1;const p=()=>s(3,f=!f);function v(){o=this.value,s(5,o)}function n(){r=this.value,s(0,r)}function a(){c=this.value,s(1,c)}const u=()=>Me(o,r,c);function N(M){f=M,s(3,f)}function E(){w=this.value,s(2,w)}return[r,c,w,f,t,o,p,v,n,a,u,N,E,M=>w?Ae(w,M.username):!0]}class Ze extends Q{constructor(e){super();R(this,e,Ye,Xe,x,{})}}function Qe(l){let e,s;return e=new Ze({}),{c(){C(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,o){W(e,t,o),s=!0},i(t){s||(q(e.$$.fragment,t),s=!0)},o(t){J(e.$$.fragment,t),s=!1},d(t){X(e,t)}}}function Re(l){let e,s;return e=new Se({props:{$$slots:{default:[Qe]},$$scope:{ctx:l}}}),{c(){C(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,o){W(e,t,o),s=!0},p(t,[o]){const r={};o&1&&(r.$$scope={dirty:o,ctx:t}),e.$set(r)},i(t){s||(q(e.$$.fragment,t),s=!0)},o(t){J(e.$$.fragment,t),s=!1},d(t){X(e,t)}}}class nt extends Q{constructor(e){super();R(this,e,null,Re,x,{})}}export{nt as default};
