import{S as be,i as _e,s as ye,a1 as we,a2 as Ee,e as m,t as E,k as g,j as ee,c as b,a as _,g as P,d as u,n as I,m as te,b as y,f as j,F as i,o as ae,M as J,a4 as ge,h as he,x as se,u as le,v as re,a5 as ve,K as Pe}from"../chunks/vendor-f23cb189.js";import{k as Ie,s as je,L as De}from"../chunks/keys-ac9139ce.js";import{M as Te}from"../chunks/Modal-4ba55855.js";import{b as Le}from"../chunks/paths-28a87002.js";import"../chunks/preload-helper-04e99934.js";function Ue(s){let e,a,t,l,d,o,v,$,k,h;return{c(){e=m("label"),a=E("Public and Private Keys"),t=g(),l=m("input"),d=g(),o=m("button"),v=E("Import"),this.h()},l(n){e=b(n,"LABEL",{for:!0});var f=_(e);a=P(f,"Public and Private Keys"),f.forEach(u),t=I(n),l=b(n,"INPUT",{id:!0,type:!0,class:!0}),d=I(n),o=b(n,"BUTTON",{class:!0});var c=_(o);v=P(c,"Import"),c.forEach(u),this.h()},h(){y(e,"for","public-key-upload"),y(l,"id","public-key-upload"),y(l,"type","file"),l.multiple=!0,y(l,"class","input"),y(o,"class","btn primary mt-8"),o.disabled=$=s[1]||!s[3]||!s[2]},m(n,f){j(n,e,f),i(e,a),j(n,t,f),j(n,l,f),j(n,d,f),j(n,o,f),i(o,v),k||(h=[J(l,"change",s[6]),J(o,"click",s[5])],k=!0)},p(n,f){f&14&&$!==($=n[1]||!n[3]||!n[2])&&(o.disabled=$)},d(n){n&&u(e),n&&u(t),n&&u(l),n&&u(d),n&&u(o),k=!1,ve(h)}}}function Fe(s){var ie,ue;let e,a,t,l,d,o,v,$,k,h,n,f,c,w,T,K,L,O,Q,W,V,B=((ie=s[4].publicKey)==null?void 0:ie.armor())+"",H,X,U,R,Y,Z,M,N=((ue=s[4].privateKey)==null?void 0:ue.armor())+"",S,F,x,ne;function ke(r){s[9](r)}let oe={$$slots:{default:[Ue]},$$scope:{ctx:s}};return s[0]!==void 0&&(oe.open=s[0]),c=new Te({props:oe}),we.push(()=>Ee(c,"open",ke)),{c(){e=m("div"),a=m("div"),t=m("button"),l=E("Import"),d=g(),o=m("button"),v=E("Download"),k=g(),h=m("a"),n=E("Passwords"),f=g(),ee(c.$$.fragment),T=g(),K=m("div"),L=m("div"),O=m("h1"),Q=E("Public Key"),W=g(),V=m("pre"),H=E(B),X=g(),U=m("div"),R=m("h1"),Y=E("Private Key"),Z=g(),M=m("pre"),S=E(N),this.h()},l(r){e=b(r,"DIV",{class:!0});var p=_(e);a=b(p,"DIV",{});var D=_(a);t=b(D,"BUTTON",{class:!0});var A=_(t);l=P(A,"Import"),A.forEach(u),d=I(D),o=b(D,"BUTTON",{class:!0});var C=_(o);v=P(C,"Download"),C.forEach(u),D.forEach(u),k=I(p),h=b(p,"A",{class:!0,href:!0});var ce=_(h);n=P(ce,"Passwords"),ce.forEach(u),p.forEach(u),f=I(r),te(c.$$.fragment,r),T=I(r),K=b(r,"DIV",{class:!0});var q=_(K);L=b(q,"DIV",{});var z=_(L);O=b(z,"H1",{class:!0});var fe=_(O);Q=P(fe,"Public Key"),fe.forEach(u),W=I(z),V=b(z,"PRE",{});var pe=_(V);H=P(pe,B),pe.forEach(u),z.forEach(u),X=I(q),U=b(q,"DIV",{});var G=_(U);R=b(G,"H1",{class:!0});var de=_(R);Y=P(de,"Private Key"),de.forEach(u),Z=I(G),M=b(G,"PRE",{});var me=_(M);S=P(me,N),me.forEach(u),G.forEach(u),q.forEach(u),this.h()},h(){y(t,"class","btn primary"),y(o,"class","btn primary"),o.disabled=$=!s[4].publicKey||!s[4].privateKey,y(h,"class","btn primary"),y(h,"href",`${Le}/passwords`),y(e,"class","flex justify-between mb-2"),y(O,"class","border-b"),y(R,"class","border-b"),y(K,"class","grid grid-cols-2 gap-2")},m(r,p){j(r,e,p),i(e,a),i(a,t),i(t,l),i(a,d),i(a,o),i(o,v),i(e,k),i(e,h),i(h,n),j(r,f,p),ae(c,r,p),j(r,T,p),j(r,K,p),i(K,L),i(L,O),i(O,Q),i(L,W),i(L,V),i(V,H),i(K,X),i(K,U),i(U,R),i(R,Y),i(U,Z),i(U,M),i(M,S),F=!0,x||(ne=[J(t,"click",s[7]),J(o,"click",s[8])],x=!0)},p(r,[p]){var A,C;(!F||p&16&&$!==($=!r[4].publicKey||!r[4].privateKey))&&(o.disabled=$);const D={};p&1038&&(D.$$scope={dirty:p,ctx:r}),!w&&p&1&&(w=!0,D.open=r[0],ge(()=>w=!1)),c.$set(D),(!F||p&16)&&B!==(B=((A=r[4].publicKey)==null?void 0:A.armor())+"")&&he(H,B),(!F||p&16)&&N!==(N=((C=r[4].privateKey)==null?void 0:C.armor())+"")&&he(S,N)},i(r){F||(se(c.$$.fragment,r),F=!0)},o(r){le(c.$$.fragment,r),F=!1},d(r){r&&u(e),r&&u(f),re(c,r),r&&u(T),r&&u(K),x=!1,ve(ne)}}}function $e(s){return new Promise(e=>{const a=new FileReader;a.onload=t=>{const l=t.target.result;l||e(""),e(l)},a.readAsText(s)})}function Ke(s,e){const a=new File([e.armor()],s,{type:"application/pgp-key"}),t=document.createElement("a");t.href=URL.createObjectURL(a),t.download=a.name,t.click()}function Oe(s,e){for(let a=0;a<s.length;a++){const t=s[a];if(e(t))return a}return-1}function Re(s,e){Ke("aicacia-password-public.pub",s),Ke("aicacia-password-private",e)}function Ve(s,e,a){let t;Pe(s,Ie,c=>a(4,t=c));let l=!1,d=!1,o,v;async function $(){a(1,d=!0);try{await je(v,o,!0)}finally{a(0,l=!1),a(1,d=!1)}}async function k(c){const w=c.target.files;if(!w||w.length<2)return;const T=Oe(w,K=>K.name.includes(".pub"));a(2,o=await $e(w[T])),a(3,v=await $e(w[T===0?1:0]))}const h=()=>a(0,l=!l),n=()=>Re(t.publicKey,t.privateKey);function f(c){l=c,a(0,l)}return[l,d,o,v,t,$,k,h,n,f]}class Be extends be{constructor(e){super();_e(this,e,Ve,Fe,ye,{})}}function Me(s){let e,a;return e=new Be({}),{c(){ee(e.$$.fragment)},l(t){te(e.$$.fragment,t)},m(t,l){ae(e,t,l),a=!0},i(t){a||(se(e.$$.fragment,t),a=!0)},o(t){le(e.$$.fragment,t),a=!1},d(t){re(e,t)}}}function Ne(s){let e,a;return e=new De({props:{$$slots:{default:[Me]},$$scope:{ctx:s}}}),{c(){ee(e.$$.fragment)},l(t){te(e.$$.fragment,t)},m(t,l){ae(e,t,l),a=!0},p(t,[l]){const d={};l&1&&(d.$$scope={dirty:l,ctx:t}),e.$set(d)},i(t){a||(se(e.$$.fragment,t),a=!0)},o(t){le(e.$$.fragment,t),a=!1},d(t){re(e,t)}}}class ze extends be{constructor(e){super();_e(this,e,null,Ne,ye,{})}}export{ze as default};
