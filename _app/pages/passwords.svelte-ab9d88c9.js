import{X as ee,Y as Ee,Z as De,C as Te,W as Ie,_ as je,a0 as Ne,a1 as Oe,S as te,i as se,s as le,e as E,k as O,t as V,c as D,a as N,d as h,n as $,g as M,b as m,L as x,f as T,F as k,a2 as S,M as K,r as ne,u as L,w as re,x as B,a3 as ae,a4 as $e,a5 as Ke,j as W,m as X,o as Y,v as Z,a6 as Be,a7 as pe,a8 as de,l as _e,h as ue,a9 as he,aa as me,K as we,ab as Se,ac as Ae}from"../chunks/vendor-cf18c955.js";import{g as oe,r as ie,L as Le}from"../chunks/keys-b9524687.js";import{M as be}from"../chunks/Modal-76280f12.js";import{b as Ve}from"../chunks/paths-28a87002.js";import"../chunks/preload-helper-04e99934.js";const z=Te({});ee(z,l=>Object.values(l));const Me=ee(z,l=>l),Fe=ee(z,l=>Object.values(l).reduce((e,s)=>((e[s.url]||(e[s.url]=[])).push(s),e),{}));function qe(l,e,s){const t=Oe(),o=new URL(l);o.pathname=o.pathname.replace(/\/$/,"");const a={id:t,url:o.toString(),username:e,password:s};z.update(i=>(i[a.id]=a,i)),ce()}function Re(l,e,s,t){z.update(o=>{const a=o[l];if(a){const i=new URL(e);i.pathname=i.pathname.replace(/\/$/,""),a.url=i.toString(),a.username=s,a.password=t}return o}),ce()}function Je(l){z.update(e=>(delete e[l],e)),ce()}let fe=!1;async function ce(){fe||(fe=!0,setTimeout(async()=>{try{const[l,e]=await oe();await ze(l,e)}finally{fe=!1}},300))}function ge(l){return Object.entries(l).reduce((e,[s,t])=>((!e[s]||!Object.keys(t).length)&&delete e[s],e),l)}async function ze(l,e){const s=ge(Ie(z)),t=await je({message:await Ne({text:JSON.stringify(s),filename:"passwords.json.pgp"}),encryptionKeys:e,signingKeys:l});await ie.scope("/").storeFile("pgp","passwords.json.pgp",t)}async function ve(l,e){const s=await ie.scope("/").getFile("/passwords.json.pgp").then(({data:t})=>t);if(s){const{data:t}=await Ee({message:await De({armoredMessage:s}),verificationKeys:e,decryptionKeys:l});z.set(ge(JSON.parse(t)))}}oe().then(([l,e])=>ve(l,e)),ie.on("sync-done",async()=>{const[l,e]=await oe();ve(l,e)});function Ce(l){let e,s;return e=new Ke({}),{c(){W(e.$$.fragment)},l(t){X(e.$$.fragment,t)},m(t,o){Y(e,t,o),s=!0},i(t){s||(B(e.$$.fragment,t),s=!0)},o(t){L(e.$$.fragment,t),s=!1},d(t){Z(e,t)}}}function He(l){let e,s;return e=new Be({}),{c(){W(e.$$.fragment)},l(t){X(e.$$.fragment,t)},m(t,o){Y(e,t,o),s=!0},i(t){s||(B(e.$$.fragment,t),s=!0)},o(t){L(e.$$.fragment,t),s=!1},d(t){Z(e,t)}}}function We(l){let e,s,t,o,a,i,w,c,p,g,n,u,f,y,P,v,U,j,F,G;const C=[He,Ce],q=[];function H(d,_){return d[4]?0:1}return u=H(l),f=q[u]=C[u](l),{c(){e=E("div"),s=E("div"),t=E("input"),o=O(),a=E("div"),i=E("input"),w=O(),c=E("input"),p=O(),g=E("button"),n=E("div"),f.c(),y=O(),P=E("div"),v=E("button"),U=V("\xD7"),this.h()},l(d){e=D(d,"DIV",{class:!0});var _=N(e);s=D(_,"DIV",{class:!0});var J=N(s);t=D(J,"INPUT",{class:!0,type:!0,placeholder:!0}),J.forEach(h),o=$(_),a=D(_,"DIV",{class:!0});var r=N(a);i=D(r,"INPUT",{class:!0,type:!0,placeholder:!0}),w=$(r),c=D(r,"INPUT",{class:!0,type:!0,placeholder:!0}),p=$(r),g=D(r,"BUTTON",{class:!0});var b=N(g);n=D(b,"DIV",{class:!0});var A=N(n);f.l(A),A.forEach(h),b.forEach(h),r.forEach(h),y=$(_),P=D(_,"DIV",{class:!0});var R=N(P);v=D(R,"BUTTON",{class:!0});var I=N(v);U=M(I,"\xD7"),I.forEach(h),R.forEach(h),_.forEach(h),this.h()},h(){m(t,"class","input h-full"),m(t,"type","text"),m(t,"placeholder","Username"),m(s,"class","relative flex-1"),m(i,"class","input h-full"),m(i,"type","text"),m(i,"placeholder","Password"),x(i,"hidden",!l[4]),m(c,"class","input h-full"),m(c,"type","password"),m(c,"placeholder","Password"),x(c,"hidden",l[4]),m(n,"class","w-6 h-6"),m(g,"class","text-black absolute top-0 bottom-0 right-2"),m(a,"class","relative flex-1"),m(v,"class","btn danger px-4"),m(P,"class","relative flex-grow-0"),m(e,"class","flex")},m(d,_){T(d,e,_),k(e,s),k(s,t),S(t,l[0]),k(e,o),k(e,a),k(a,i),S(i,l[1]),k(a,w),k(a,c),S(c,l[1]),k(a,p),k(a,g),k(g,n),q[u].m(n,null),k(e,y),k(e,P),k(P,v),k(v,U),j=!0,F||(G=[K(t,"input",l[7]),K(t,"input",l[5]),K(i,"input",l[8]),K(i,"input",l[5]),K(c,"input",l[9]),K(c,"input",l[5]),K(g,"click",l[10]),K(v,"click",l[11])],F=!0)},p(d,[_]){_&1&&t.value!==d[0]&&S(t,d[0]),_&2&&i.value!==d[1]&&S(i,d[1]),_&16&&x(i,"hidden",!d[4]),_&2&&c.value!==d[1]&&S(c,d[1]),_&16&&x(c,"hidden",d[4]);let J=u;u=H(d),u!==J&&(ne(),L(q[J],1,1,()=>{q[J]=null}),re(),f=q[u],f||(f=q[u]=C[u](d),f.c()),B(f,1),f.m(n,null))},i(d){j||(B(f),j=!0)},o(d){L(f),j=!1},d(d){d&&h(e),q[u].d(),F=!1,ae(G)}}}function Xe(l,e,s){let{id:t}=e,{url:o}=e,{username:a}=e,{password:i}=e,{onDelete:w=()=>{}}=e,c=!1;const p=$e(()=>{o&&a&&i&&Re(t,o,a,i)},500);function g(){a=this.value,s(0,a)}function n(){i=this.value,s(1,i)}function u(){i=this.value,s(1,i)}const f=()=>s(4,c=!c),y=()=>w(t);return l.$$set=P=>{"id"in P&&s(2,t=P.id),"url"in P&&s(6,o=P.url),"username"in P&&s(0,a=P.username),"password"in P&&s(1,i=P.password),"onDelete"in P&&s(3,w=P.onDelete)},[a,i,t,w,c,p,o,g,n,u,f,y]}class Ye extends te{constructor(e){super();se(this,e,Xe,We,le,{id:2,url:6,username:0,password:1,onDelete:3})}}function ye(l,e,s){const t=l.slice();return t[9]=e[s][0],t[21]=e[s][1],t}function ke(l,e,s){const t=l.slice();return t[24]=e[s],t}function Ze(l){let e,s,t,o,a,i,w,c,p,g;return{c(){e=E("input"),s=O(),t=E("input"),o=O(),a=E("input"),i=O(),w=E("button"),c=V("Add"),this.h()},l(n){e=D(n,"INPUT",{class:!0,type:!0,placeholder:!0}),s=$(n),t=D(n,"INPUT",{class:!0,type:!0,placeholder:!0}),o=$(n),a=D(n,"INPUT",{class:!0,type:!0,placeholder:!0}),i=$(n),w=D(n,"BUTTON",{class:!0});var u=N(w);c=M(u,"Add"),u.forEach(h),this.h()},h(){m(e,"class","input mt-1"),m(e,"type","text"),m(e,"placeholder","Application"),m(t,"class","input mt-1"),m(t,"type","text"),m(t,"placeholder","Username"),m(a,"class","input mt-1"),m(a,"type","password"),m(a,"placeholder","Password"),m(w,"class","btn primary mt-3")},m(n,u){T(n,e,u),S(e,l[9]),T(n,s,u),T(n,t,u),S(t,l[0]),T(n,o,u),T(n,a,u),S(a,l[1]),T(n,i,u),T(n,w,u),k(w,c),p||(g=[K(e,"input",l[13]),K(t,"input",l[14]),K(a,"input",l[15]),K(w,"click",l[16])],p=!0)},p(n,u){u&512&&e.value!==n[9]&&S(e,n[9]),u&1&&t.value!==n[0]&&S(t,n[0]),u&2&&a.value!==n[1]&&S(a,n[1])},d(n){n&&h(e),n&&h(s),n&&h(t),n&&h(o),n&&h(a),n&&h(i),n&&h(w),p=!1,ae(g)}}}function Ge(l){var y,P;let e,s,t=((y=l[7])==null?void 0:y.url)+"",o,a,i=((P=l[7])==null?void 0:P.username)+"",w,c,p,g,n,u,f;return{c(){e=E("p"),s=V("Delete "),o=V(t),a=O(),w=V(i),c=V(" Password?"),p=O(),g=E("button"),n=V(">Delete"),this.h()},l(v){e=D(v,"P",{class:!0});var U=N(e);s=M(U,"Delete "),o=M(U,t),a=$(U),w=M(U,i),c=M(U," Password?"),U.forEach(h),p=$(v),g=D(v,"BUTTON",{class:!0});var j=N(g);n=M(j,">Delete"),j.forEach(h),this.h()},h(){m(e,"class","mb-2"),m(g,"class","btn danger")},m(v,U){T(v,e,U),k(e,s),k(e,o),k(e,a),k(e,w),k(e,c),T(v,p,U),T(v,g,U),k(g,n),u||(f=K(g,"click",function(){Ae(l[5])&&l[5].apply(this,arguments)}),u=!0)},p(v,U){var j,F;l=v,U&128&&t!==(t=((j=l[7])==null?void 0:j.url)+"")&&ue(o,t),U&128&&i!==(i=((F=l[7])==null?void 0:F.username)+"")&&ue(w,i)},d(v){v&&h(e),v&&h(p),v&&h(g),u=!1,f()}}}function Qe(l){let e,s;return{c(){e=E("h3"),s=V("Deleting Password"),this.h()},l(t){e=D(t,"H3",{slot:!0});var o=N(e);s=M(o,"Deleting Password"),o.forEach(h),this.h()},h(){m(e,"slot","title")},m(t,o){T(t,e,o),k(e,s)},d(t){t&&h(e)}}}function Pe(l){let e,s;return e=new Ye({props:{id:l[24].id,url:l[9],username:l[24].username,password:l[24].password,onDelete:l[6]}}),{c(){W(e.$$.fragment)},l(t){X(e.$$.fragment,t)},m(t,o){Y(e,t,o),s=!0},p(t,o){const a={};o&260&&(a.id=t[24].id),o&256&&(a.url=t[9]),o&260&&(a.username=t[24].username),o&260&&(a.password=t[24].password),o&64&&(a.onDelete=t[6]),e.$set(a)},i(t){s||(B(e.$$.fragment,t),s=!0)},o(t){L(e.$$.fragment,t),s=!1},d(t){Z(e,t)}}}function Ue(l){let e,s,t=l[9]+"",o,a,i,w,c=l[21].filter(l[20]),p=[];for(let n=0;n<c.length;n+=1)p[n]=Pe(ke(l,c,n));const g=n=>L(p[n],1,1,()=>{p[n]=null});return{c(){e=E("h2"),s=V("Application: "),o=V(t),a=O();for(let n=0;n<p.length;n+=1)p[n].c();i=_e(),this.h()},l(n){e=D(n,"H2",{class:!0});var u=N(e);s=M(u,"Application: "),o=M(u,t),u.forEach(h),a=$(n);for(let f=0;f<p.length;f+=1)p[f].l(n);i=_e(),this.h()},h(){m(e,"class","mt-2")},m(n,u){T(n,e,u),k(e,s),k(e,o),T(n,a,u);for(let f=0;f<p.length;f+=1)p[f].m(n,u);T(n,i,u),w=!0},p(n,u){if((!w||u&256)&&t!==(t=n[9]+"")&&ue(o,t),u&324){c=n[21].filter(n[20]);let f;for(f=0;f<c.length;f+=1){const y=ke(n,c,f);p[f]?(p[f].p(y,u),B(p[f],1)):(p[f]=Pe(y),p[f].c(),B(p[f],1),p[f].m(i.parentNode,i))}for(ne(),f=c.length;f<p.length;f+=1)g(f);re()}},i(n){if(!w){for(let u=0;u<c.length;u+=1)B(p[u]);w=!0}},o(n){p=p.filter(Boolean);for(let u=0;u<p.length;u+=1)L(p[u]);w=!1},d(n){n&&h(e),n&&h(a),he(p,n),n&&h(i)}}}function xe(l){let e,s,t,o,a,i,w,c,p,g,n,u,f,y,P,v,U,j,F;function G(r){l[17](r)}let C={$$slots:{default:[Ze]},$$scope:{ctx:l}};l[3]!==void 0&&(C.open=l[3]),c=new be({props:C}),pe.push(()=>de(c,"open",G));function q(r){l[18](r)}let H={$$slots:{title:[Qe],default:[Ge]},$$scope:{ctx:l}};l[4]!==void 0&&(H.open=l[4]),n=new be({props:H}),pe.push(()=>de(n,"open",q));let d=Object.entries(l[8]),_=[];for(let r=0;r<d.length;r+=1)_[r]=Ue(ye(l,d,r));const J=r=>L(_[r],1,1,()=>{_[r]=null});return{c(){e=E("div"),s=E("button"),t=V("Add"),o=O(),a=E("a"),i=V("Keys"),w=O(),W(c.$$.fragment),g=O(),W(n.$$.fragment),f=O(),y=E("input"),P=O(),v=E("div");for(let r=0;r<_.length;r+=1)_[r].c();this.h()},l(r){e=D(r,"DIV",{class:!0});var b=N(e);s=D(b,"BUTTON",{class:!0});var A=N(s);t=M(A,"Add"),A.forEach(h),o=$(b),a=D(b,"A",{class:!0,href:!0});var R=N(a);i=M(R,"Keys"),R.forEach(h),b.forEach(h),w=$(r),X(c.$$.fragment,r),g=$(r),X(n.$$.fragment,r),f=$(r),y=D(r,"INPUT",{class:!0,type:!0,placeholder:!0}),P=$(r),v=D(r,"DIV",{class:!0});var I=N(v);for(let Q=0;Q<_.length;Q+=1)_[Q].l(I);I.forEach(h),this.h()},h(){m(s,"class","btn primary"),m(a,"class","btn primary"),m(a,"href",`${Ve}/keys`),m(e,"class","flex justify-between mb-2"),m(y,"class","input"),m(y,"type","text"),m(y,"placeholder","Search..."),m(v,"class","mt-1")},m(r,b){T(r,e,b),k(e,s),k(s,t),k(e,o),k(e,a),k(a,i),T(r,w,b),Y(c,r,b),T(r,g,b),Y(n,r,b),T(r,f,b),T(r,y,b),S(y,l[2]),T(r,P,b),T(r,v,b);for(let A=0;A<_.length;A+=1)_[A].m(v,null);U=!0,j||(F=[K(s,"click",l[12]),K(y,"input",l[19])],j=!0)},p(r,[b]){const A={};b&134218243&&(A.$$scope={dirty:b,ctx:r}),!p&&b&8&&(p=!0,A.open=r[3],me(()=>p=!1)),c.$set(A);const R={};if(b&134217888&&(R.$$scope={dirty:b,ctx:r}),!u&&b&16&&(u=!0,R.open=r[4],me(()=>u=!1)),n.$set(R),b&4&&y.value!==r[2]&&S(y,r[2]),b&324){d=Object.entries(r[8]);let I;for(I=0;I<d.length;I+=1){const Q=ye(r,d,I);_[I]?(_[I].p(Q,b),B(_[I],1)):(_[I]=Ue(Q),_[I].c(),B(_[I],1),_[I].m(v,null))}for(ne(),I=d.length;I<_.length;I+=1)J(I);re()}},i(r){if(!U){B(c.$$.fragment,r),B(n.$$.fragment,r);for(let b=0;b<d.length;b+=1)B(_[b]);U=!0}},o(r){L(c.$$.fragment,r),L(n.$$.fragment,r),_=_.filter(Boolean);for(let b=0;b<_.length;b+=1)L(_[b]);U=!1},d(r){r&&h(e),r&&h(w),Z(c,r),r&&h(g),Z(n,r),r&&h(f),r&&h(y),r&&h(P),r&&h(v),he(_,r),j=!1,ae(F)}}}function et(l,e,s){let t,o,a,i,w;we(l,Me,d=>s(11,i=d)),we(l,Fe,d=>s(8,w=d));let c,p,g,n="",u=!1,f,y=!1;const P=()=>s(3,u=!u);function v(){c=this.value,s(9,c)}function U(){p=this.value,s(0,p)}function j(){g=this.value,s(1,g)}const F=()=>qe(c,p,g);function G(d){u=d,s(3,u)}function C(d){y=d,s(4,y),s(10,f)}function q(){n=this.value,s(2,n)}const H=d=>n?Se(n,d.username):!0;return l.$$.update=()=>{l.$$.dirty&1024&&s(5,a=()=>{Je(f),s(10,f=void 0),s(4,y=!1)}),l.$$.dirty&3072&&s(7,t=i[f])},s(6,o=d=>{s(10,f=d),s(4,y=!0)}),[p,g,n,u,y,a,o,t,w,c,f,i,P,v,U,j,F,G,C,q,H]}class tt extends te{constructor(e){super();se(this,e,et,xe,le,{})}}function st(l){let e,s;return e=new tt({}),{c(){W(e.$$.fragment)},l(t){X(e.$$.fragment,t)},m(t,o){Y(e,t,o),s=!0},i(t){s||(B(e.$$.fragment,t),s=!0)},o(t){L(e.$$.fragment,t),s=!1},d(t){Z(e,t)}}}function lt(l){let e,s;return e=new Le({props:{$$slots:{default:[st]},$$scope:{ctx:l}}}),{c(){W(e.$$.fragment)},l(t){X(e.$$.fragment,t)},m(t,o){Y(e,t,o),s=!0},p(t,[o]){const a={};o&1&&(a.$$scope={dirty:o,ctx:t}),e.$set(a)},i(t){s||(B(e.$$.fragment,t),s=!0)},o(t){L(e.$$.fragment,t),s=!1},d(t){Z(e,t)}}}class it extends te{constructor(e){super();se(this,e,null,lt,le,{})}}export{it as default};
