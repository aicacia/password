function wt(){}function vt(e,t){for(const r in t)e[r]=t[r];return e}function sr(e){return e()}function ar(){return Object.create(null)}function At(e){e.forEach(sr)}function ur(e){return typeof e=="function"}function Lt(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function wn(e){return Object.keys(e).length===0}function cr(e,...t){if(e==null)return wt;const r=e.subscribe(...t);return r.unsubscribe?()=>r.unsubscribe():r}function _o(e,t,r){e.$$.on_destroy.push(cr(t,r))}function En(e,t,r,a){if(e){const s=lr(e,t,r,a);return e[0](s)}}function lr(e,t,r,a){return e[1]&&a?vt(r.ctx.slice(),e[1](a(t))):r.ctx}function Pn(e,t,r,a){if(e[2]&&a){const s=e[2](a(r));if(t.dirty===void 0)return s;if(typeof s=="object"){const o=[],f=Math.max(t.dirty.length,s.length);for(let d=0;d<f;d+=1)o[d]=t.dirty[d]|s[d];return o}return t.dirty|s}return t.dirty}function xn(e,t,r,a,s,o){if(s){const f=lr(t,r,a,o);e.p(f,s)}}function Tn(e){if(e.ctx.length>32){const t=[],r=e.ctx.length/32;for(let a=0;a<r;a++)t[a]=-1;return t}return-1}function kt(e){const t={};for(const r in e)r[0]!=="$"&&(t[r]=e[r]);return t}let Zt=!1;function Sn(){Zt=!0}function An(){Zt=!1}function kn(e,t,r,a){for(;e<t;){const s=e+(t-e>>1);r(s)<=a?e=s+1:t=s}return e}function Nn(e){if(e.hydrate_init)return;e.hydrate_init=!0;let t=e.childNodes;if(e.nodeName==="HEAD"){const g=[];for(let b=0;b<t.length;b++){const A=t[b];A.claim_order!==void 0&&g.push(A)}t=g}const r=new Int32Array(t.length+1),a=new Int32Array(t.length);r[0]=-1;let s=0;for(let g=0;g<t.length;g++){const b=t[g].claim_order,A=(s>0&&t[r[s]].claim_order<=b?s+1:kn(1,s,N=>t[r[N]].claim_order,b))-1;a[g]=r[A]+1;const y=A+1;r[y]=g,s=Math.max(y,s)}const o=[],f=[];let d=t.length-1;for(let g=r[s]+1;g!=0;g=a[g-1]){for(o.push(t[g-1]);d>=g;d--)f.push(t[d]);d--}for(;d>=0;d--)f.push(t[d]);o.reverse(),f.sort((g,b)=>g.claim_order-b.claim_order);for(let g=0,b=0;g<f.length;g++){for(;b<o.length&&f[g].claim_order>=o[b].claim_order;)b++;const A=b<o.length?o[b]:null;e.insertBefore(f[g],A)}}function Te(e,t){if(Zt){for(Nn(e),(e.actual_end_child===void 0||e.actual_end_child!==null&&e.actual_end_child.parentElement!==e)&&(e.actual_end_child=e.firstChild);e.actual_end_child!==null&&e.actual_end_child.claim_order===void 0;)e.actual_end_child=e.actual_end_child.nextSibling;t!==e.actual_end_child?(t.claim_order!==void 0||t.parentNode!==e)&&e.insertBefore(t,e.actual_end_child):e.actual_end_child=t.nextSibling}else(t.parentNode!==e||t.nextSibling!==null)&&e.appendChild(t)}function Bt(e,t,r){Zt&&!r?Te(e,t):(t.parentNode!==e||t.nextSibling!=r)&&e.insertBefore(t,r||null)}function mt(e){e.parentNode.removeChild(e)}function bo(e,t){for(let r=0;r<e.length;r+=1)e[r]&&e[r].d(t)}function Rn(e){return document.createElement(e)}function Nt(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function te(e){return document.createTextNode(e)}function wo(){return te(" ")}function hr(){return te("")}function Eo(e,t,r,a){return e.addEventListener(t,r,a),()=>e.removeEventListener(t,r,a)}function Et(e,t,r){r==null?e.removeAttribute(t):e.getAttribute(t)!==r&&e.setAttribute(t,r)}function Po(e){return e===""?null:+e}function Rt(e){return Array.from(e.childNodes)}function On(e){e.claim_info===void 0&&(e.claim_info={last_index:0,total_claimed:0})}function fr(e,t,r,a,s=!1){On(e);const o=(()=>{for(let f=e.claim_info.last_index;f<e.length;f++){const d=e[f];if(t(d)){const g=r(d);return g===void 0?e.splice(f,1):e[f]=g,s||(e.claim_info.last_index=f),d}}for(let f=e.claim_info.last_index-1;f>=0;f--){const d=e[f];if(t(d)){const g=r(d);return g===void 0?e.splice(f,1):e[f]=g,s?g===void 0&&e.claim_info.last_index--:e.claim_info.last_index=f,d}}return a()})();return o.claim_order=e.claim_info.total_claimed,e.claim_info.total_claimed+=1,o}function dr(e,t,r,a){return fr(e,s=>s.nodeName===t,s=>{const o=[];for(let f=0;f<s.attributes.length;f++){const d=s.attributes[f];r[d.name]||o.push(d.name)}o.forEach(f=>s.removeAttribute(f))},()=>a(t))}function xo(e,t,r){return dr(e,t,r,Rn)}function $t(e,t,r){return dr(e,t,r,Nt)}function pr(e,t){return fr(e,r=>r.nodeType===3,r=>{const a=""+t;if(r.data.startsWith(a)){if(r.data.length!==a.length)return r.splitText(a.length)}else r.data=a},()=>te(t),!0)}function To(e){return pr(e," ")}function In(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function So(e,t){e.value=t==null?"":t}function Ao(e,t,r){e.classList[r?"add":"remove"](t)}function ko(e,t=document.body){return Array.from(t.querySelectorAll(e))}let qt;function Gt(e){qt=e}function Se(){if(!qt)throw new Error("Function called outside component initialization");return qt}function No(e){Se().$$.on_mount.push(e)}function Ro(e){Se().$$.after_update.push(e)}function Oo(e,t){Se().$$.context.set(e,t)}const Jt=[],mr=[],ee=[],Ae=[],Cn=Promise.resolve();let ke=!1;function Mn(){ke||(ke=!0,Cn.then(gr))}function Ne(e){ee.push(e)}function Io(e){Ae.push(e)}const Re=new Set;let re=0;function gr(){const e=qt;do{for(;re<Jt.length;){const t=Jt[re];re++,Gt(t),jn(t.$$)}for(Gt(null),Jt.length=0,re=0;mr.length;)mr.pop()();for(let t=0;t<ee.length;t+=1){const r=ee[t];Re.has(r)||(Re.add(r),r())}ee.length=0}while(Jt.length);for(;Ae.length;)Ae.pop()();ke=!1,Re.clear(),Gt(e)}function jn(e){if(e.fragment!==null){e.update(),At(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Ne)}}const ne=new Set;let Pt;function Co(){Pt={r:0,c:[],p:Pt}}function Mo(){Pt.r||At(Pt.c),Pt=Pt.p}function Ot(e,t){e&&e.i&&(ne.delete(e),e.i(t))}function ie(e,t,r,a){if(e&&e.o){if(ne.has(e))return;ne.add(e),Pt.c.push(()=>{ne.delete(e),a&&(r&&e.d(1),a())}),e.o(t)}}function jo(e,t){e.d(1),t.delete(e.key)}function Uo(e,t,r,a,s,o,f,d,g,b,A,y){let N=e.length,x=o.length,w=N;const v={};for(;w--;)v[e[w].key]=w;const P=[],_=new Map,U=new Map;for(w=x;w--;){const n=y(s,o,w),p=r(n);let h=f.get(p);h?a&&h.p(n,t):(h=b(p,n),h.c()),_.set(p,P[w]=h),p in v&&U.set(p,Math.abs(w-v[p]))}const I=new Set,$=new Set;function C(n){Ot(n,1),n.m(d,A),f.set(n.key,n),A=n.first,x--}for(;N&&x;){const n=P[x-1],p=e[N-1],h=n.key,T=p.key;n===p?(A=n.first,N--,x--):_.has(T)?!f.has(h)||I.has(h)?C(n):$.has(T)?N--:U.get(h)>U.get(T)?($.add(h),C(n)):(I.add(T),N--):(g(p,f),N--)}for(;N--;){const n=e[N];_.has(n.key)||g(n,f)}for(;x;)C(P[x-1]);return P}function Oe(e,t){const r={},a={},s={$$scope:1};let o=e.length;for(;o--;){const f=e[o],d=t[o];if(d){for(const g in f)g in d||(a[g]=1);for(const g in d)s[g]||(r[g]=d[g],s[g]=1);e[o]=d}else for(const g in f)s[g]=1}for(const f in a)f in r||(r[f]=void 0);return r}function Ie(e){return typeof e=="object"&&e!==null?e:{}}function Fo(e,t,r){const a=e.$$.props[t];a!==void 0&&(e.$$.bound[a]=r,r(e.$$.ctx[a]))}function Ce(e){e&&e.c()}function Me(e,t){e&&e.l(t)}function oe(e,t,r,a){const{fragment:s,on_mount:o,on_destroy:f,after_update:d}=e.$$;s&&s.m(t,r),a||Ne(()=>{const g=o.map(sr).filter(ur);f?f.push(...g):At(g),e.$$.on_mount=[]}),d.forEach(Ne)}function se(e,t){const r=e.$$;r.fragment!==null&&(At(r.on_destroy),r.fragment&&r.fragment.d(t),r.on_destroy=r.fragment=null,r.ctx=[])}function Un(e,t){e.$$.dirty[0]===-1&&(Jt.push(e),Mn(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ae(e,t,r,a,s,o,f,d=[-1]){const g=qt;Gt(e);const b=e.$$={fragment:null,ctx:null,props:o,update:wt,not_equal:s,bound:ar(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(g?g.$$.context:[])),callbacks:ar(),dirty:d,skip_bound:!1,root:t.target||g.$$.root};f&&f(b.root);let A=!1;if(b.ctx=r?r(e,t.props||{},(y,N,...x)=>{const w=x.length?x[0]:N;return b.ctx&&s(b.ctx[y],b.ctx[y]=w)&&(!b.skip_bound&&b.bound[y]&&b.bound[y](w),A&&Un(e,y)),N}):[],b.update(),A=!0,At(b.before_update),b.fragment=a?a(b.ctx):!1,t.target){if(t.hydrate){Sn();const y=Rt(t.target);b.fragment&&b.fragment.l(y),y.forEach(mt)}else b.fragment&&b.fragment.c();t.intro&&Ot(e.$$.fragment),oe(e,t.target,t.anchor,t.customElement),An(),gr()}Gt(g)}class ue{$destroy(){se(this,1),this.$destroy=wt}$on(t,r){const a=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return a.push(r),()=>{const s=a.indexOf(r);s!==-1&&a.splice(s,1)}}$set(t){this.$$set&&!wn(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const It=[];function Fn(e,t){return{subscribe:Dn(e,t).subscribe}}function Dn(e,t=wt){let r;const a=new Set;function s(d){if(Lt(e,d)&&(e=d,r)){const g=!It.length;for(const b of a)b[1](),It.push(b,e);if(g){for(let b=0;b<It.length;b+=2)It[b][0](It[b+1]);It.length=0}}}function o(d){s(d(e))}function f(d,g=wt){const b=[d,g];return a.add(b),a.size===1&&(r=t(s)||wt),d(e),()=>{a.delete(b),a.size===0&&(r(),r=null)}}return{set:s,update:o,subscribe:f}}function Do(e,t,r){const a=!Array.isArray(e),s=a?[e]:e,o=t.length<2;return Fn(r,f=>{let d=!1;const g=[];let b=0,A=wt;const y=()=>{if(b)return;A();const x=t(a?g[0]:g,f);o?f(x):A=ur(x)?x:wt},N=s.map((x,w)=>cr(x,v=>{g[w]=v,b&=~(1<<w),d&&y()},()=>{b|=1<<w}));return d=!0,y(),function(){At(N),A()}})}function Lo(e,t,r=!1){const a=t.length,s=e.length;return s>a?!1:Ln(r!==!0?e.toLowerCase():e,s,r!==!0?t.toLowerCase():t,a)}function Ln(e,t,r,a){let s=0,o=0;t:for(;s<t;){const f=e.charAt(s++);for(;o<a;)if(r.charAt(o++)===f)continue t;return!1}return!0}var ce,Bn=new Uint8Array(16);function $n(){if(!ce&&(ce=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!ce))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ce(Bn)}var qn=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Gn(e){return typeof e=="string"&&qn.test(e)}var st=[];for(var je=0;je<256;++je)st.push((je+256).toString(16).substr(1));function Jn(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(st[e[t+0]]+st[e[t+1]]+st[e[t+2]]+st[e[t+3]]+"-"+st[e[t+4]]+st[e[t+5]]+"-"+st[e[t+6]]+st[e[t+7]]+"-"+st[e[t+8]]+st[e[t+9]]+"-"+st[e[t+10]]+st[e[t+11]]+st[e[t+12]]+st[e[t+13]]+st[e[t+14]]+st[e[t+15]]).toLowerCase();if(!Gn(r))throw TypeError("Stringified UUID is invalid");return r}function Bo(e,t,r){e=e||{};var a=e.random||(e.rng||$n)();if(a[6]=a[6]&15|64,a[8]=a[8]&63|128,t){r=r||0;for(var s=0;s<16;++s)t[r+s]=a[s];return t}return Jn(a)}var Wn=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Hn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var yr={exports:{}};/*! remotestorage.js 2.0.0-beta.1, https://remotestorage.io, MIT licensed */(function(e,t){(function(r,a){e.exports=a()})(Wn,function(){return function(r){var a={};function s(o){if(a[o])return a[o].exports;var f=a[o]={i:o,l:!1,exports:{}};return r[o].call(f.exports,f,f.exports,s),f.l=!0,f.exports}return s.m=r,s.c=a,s.d=function(o,f,d){s.o(o,f)||Object.defineProperty(o,f,{enumerable:!0,get:d})},s.r=function(o){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},s.t=function(o,f){if(1&f&&(o=s(o)),8&f||4&f&&typeof o=="object"&&o&&o.__esModule)return o;var d=Object.create(null);if(s.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:o}),2&f&&typeof o!="string")for(var g in o)s.d(d,g,function(b){return o[b]}.bind(null,g));return d},s.n=function(o){var f=o&&o.__esModule?function(){return o.default}:function(){return o};return s.d(f,"a",f),f},s.o=function(o,f){return Object.prototype.hasOwnProperty.call(o,f)},s.p="",s(s.s=17)}([function(r,a,s){(function(o,f){Object.defineProperty(a,"__esModule",{value:!0}),a.applyMixins=a.toBase64=a.getTextFromArrayBuffer=a.shouldBeTreatedAsBinary=a.getJSONFromLocalStorage=a.localStorageAvailable=a.pathsFromRoot=a.deepClone=a.equal=a.bindAll=a.cleanPath=a.baseName=a.isDocument=a.isFolder=a.containingFolder=a.extend=a.getGlobalContext=a.globalContext=a.logError=void 0,a.logError=d=>{typeof d=="string"?console.error(d):console.error(d.message,d.stack)},a.globalContext=typeof window!="undefined"?window:typeof self=="object"?self:o,a.getGlobalContext=()=>typeof window!="undefined"?window:typeof self=="object"?self:o,a.extend=(...d)=>{const g=d[0];return Array.prototype.slice.call(d,1).forEach(function(b){for(const A in b)g[A]=b[A]}),g},a.containingFolder=d=>{if(d==="")return"/";if(!d)throw"Path not given!";return d.replace(/\/+/g,"/").replace(/[^\/]+\/?$/,"")},a.isFolder=d=>d.substr(-1)==="/",a.isDocument=d=>!a.isFolder(d),a.baseName=d=>{const g=d.split("/");return a.isFolder(d)?g[g.length-2]+"/":g[g.length-1]},a.cleanPath=d=>d.replace(/\/+/g,"/").split("/").map(encodeURIComponent).join("/").replace(/'/g,"%27"),a.bindAll=d=>{for(const g in this)typeof d[g]=="function"&&(d[g]=d[g].bind(d))},a.equal=(d,g,b=[])=>{let A;if(typeof d!=typeof g)return!1;if(typeof d=="number"||typeof d=="boolean"||typeof d=="string")return d===g;if(typeof d=="function")return d.toString()===g.toString();if(d instanceof ArrayBuffer&&g instanceof ArrayBuffer&&(d=new Uint8Array(d),g=new Uint8Array(g)),d instanceof Array){if(d.length!==g.length)return!1;for(let y=0,N=d.length;y<N;y++)if(!a.equal(d[y],g[y],b))return!1}else{for(A in d)if(d.hasOwnProperty(A)&&!(A in g))return!1;for(A in g){if(!g.hasOwnProperty(A))continue;if(!(A in d))return!1;let y;if(typeof g[A]=="object"){if(b.indexOf(g[A])>=0)continue;y=b.slice(),y.push(g[A])}if(!a.equal(d[A],g[A],y))return!1}}return!0},a.deepClone=d=>{if(d!==void 0){const g=JSON.parse(JSON.stringify(d));return function b(A,y){if(typeof A=="object"&&!Array.isArray(A)&&A!==null){for(const N in A)if(typeof A[N]=="object"&&A[N]!==null)if(A[N].toString()==="[object ArrayBuffer]"){y[N]=new ArrayBuffer(A[N].byteLength);const x=new Int8Array(A[N]);new Int8Array(y[N]).set(x)}else b(A[N],y[N])}}(d,g),g}},a.pathsFromRoot=d=>{const g=[d],b=d.replace(/\/$/,"").split("/");for(;b.length>1;)b.pop(),g.push(b.join("/")+"/");return g},a.localStorageAvailable=()=>{const d=a.getGlobalContext();if(!("localStorage"in d))return!1;try{return d.localStorage.setItem("rs-check","1"),d.localStorage.removeItem("rs-check"),!0}catch{return!1}},a.getJSONFromLocalStorage=d=>{const g=a.getGlobalContext();try{return JSON.parse(g.localStorage.getItem(d))}catch{}},a.shouldBeTreatedAsBinary=(d,g)=>!!(g&&g.match(/charset=binary/)||/[\x00-\x08\x0E-\x1F\uFFFD]/.test(d)),a.getTextFromArrayBuffer=(d,g)=>new Promise(b=>{if(typeof Blob=="undefined"){const A=new f(new Uint8Array(d));b(A.toString(g))}else{let A;const y=a.globalContext;if(y.BlobBuilder=y.BlobBuilder||y.WebKitBlobBuilder,y.BlobBuilder!==void 0){const x=new y.BlobBuilder;x.append(d),A=x.getBlob()}else A=new Blob([d]);const N=new FileReader;typeof N.addEventListener=="function"?N.addEventListener("loadend",function(x){b(x.target.result)}):N.onloadend=function(x){b(x.target.result)},N.readAsText(A,g)}}),a.toBase64=d=>{const g=a.getGlobalContext();return"btoa"in g?g.btoa(d):f.from(d).toString("base64")},a.applyMixins=function(d,g){g.forEach(b=>{Object.getOwnPropertyNames(b.prototype).forEach(A=>{Object.defineProperty(d.prototype,A,Object.getOwnPropertyDescriptor(b.prototype,A))})})}}).call(this,s(5),s(19).Buffer)},function(r,a,s){const o=(this&&this.__importDefault||function(f){return f&&f.__esModule?f:{default:f}})(s(3));r.exports=function(...f){o.default.logging&&console.log(...f)}},function(r,a,s){const o=(this&&this.__importDefault||function(f){return f&&f.__esModule?f:{default:f}})(s(1));r.exports=class{addEvents(f){f.forEach(d=>this._addEvent(d))}addEventListener(f,d){if(typeof f!="string")throw new Error("Argument eventName should be a string");if(typeof d!="function")throw new Error("Argument handler should be a function");o.default("[EventHandling] Adding event listener",f),this._validateEvent(f),this._handlers[f].push(d)}on(f,d){return this.addEventListener(f,d)}removeEventListener(f,d){this._validateEvent(f);const g=this._handlers[f].length;for(let b=0;b<g;b++)if(this._handlers[f][b]===d)return void this._handlers[f].splice(b,1)}_emit(f,...d){this._validateEvent(f),this._handlers[f].slice().forEach(g=>{g.apply(this,d)})}_validateEvent(f){if(!(f in this._handlers))throw new Error("Unknown event: "+f)}_delegateEvent(f,d){d.on(f,g=>{this._emit(f,g)})}_addEvent(f){this._handlers===void 0&&(this._handlers={}),this._handlers[f]=[]}}},function(r,a,s){const o={cache:!0,changeEvents:{local:!0,window:!1,remote:!0,conflict:!0},cordovaRedirectUri:void 0,logging:!1,modules:[],backgroundSyncInterval:6e4,disableFeatures:[],discoveryTimeout:1e4,isBackground:!1,requestTimeout:3e4,syncInterval:1e4};r.exports=o},function(r,a,s){class o extends Error{constructor(d,g={}){super(),this.name="Unauthorized",this.message=d===void 0?"App authorization expired or revoked.":d,g.code!==void 0&&(this.code=g.code),this.stack=new Error().stack}}r.exports=o},function(r,a){var s;s=function(){return this}();try{s=s||new Function("return this")()}catch{typeof window=="object"&&(s=window)}r.exports=s},function(r,a,s){var o=this&&this.__importDefault||function(N){return N&&N.__esModule?N:{default:N}};const f=o(s(1)),d=s(0),g=o(s(4));let b;function A(N){const x=N||y.getLocation().href,w=x.indexOf("#");if(w===-1)return;const v=x.substring(w+1);return v.includes("=")?v.split("&").reduce(function(P,_){const U=_.split("=");if(U[0]==="state"&&U[1].match(/rsDiscovery/)){let I=decodeURIComponent(U[1]);const $=I.substr(I.indexOf("rsDiscovery=")).split("&")[0].split("=")[1];P.rsDiscovery=JSON.parse(atob($)),I=I.replace(new RegExp("&?rsDiscovery="+$),""),I.length>0&&(P.state=I)}else P[decodeURIComponent(U[0])]=decodeURIComponent(U[1]);return P},{}):void 0}class y{static authorize(x,{authURL:w,scope:v,redirectUri:P,clientId:_}){if(f.default("[Authorize] authURL = ",w,"scope = ",v,"redirectUri = ",P,"clientId = ",_),!d.localStorageAvailable()&&x.backend==="remotestorage"){P+=P.indexOf("#")>0?"&":"#";const I={userAddress:x.remote.userAddress,href:x.remote.href,storageApi:x.remote.storageApi,properties:x.remote.properties};P+="rsDiscovery="+d.toBase64(JSON.stringify(I))}const U=function(I,$,C,n){const p=$.indexOf("#");let h=I;return h+=I.indexOf("?")>0?"&":"?",h+="redirect_uri="+encodeURIComponent($.replace(/#.*$/,"")),h+="&scope="+encodeURIComponent(C),h+="&client_id="+encodeURIComponent(n),p!==-1&&p+1!==$.length&&(h+="&state="+encodeURIComponent($.substring(p+1))),h+="&response_type=token",h}(w,P,v,_);d.globalContext.cordova?y.openWindow(U,P,"location=yes,clearsessioncache=yes,clearcache=yes").then(I=>{x.remote.configure({token:I.access_token})}):y.setLocation(U)}static setLocation(x){if(typeof x=="string")document.location.href=x;else{if(typeof x!="object")throw"Invalid location "+x;document.location=x}}static _rs_supported(){return typeof document!="undefined"}static _rs_cleanup(x){x.removeEventListener("features-loaded",b)}}y.IMPLIED_FAKE_TOKEN=!1,y.getLocation=function(){return document.location},y.openWindow=function(N,x,w){return new Promise((v,P)=>{const _=open(N,"_blank",w);if(!_||_.closed)return P("Authorization popup was blocked");function U(){return P("Authorization was canceled")}_.addEventListener("loadstart",function(I){if(I.url.indexOf(x)!==0)return;_.removeEventListener("exit",U),_.close();const $=A(I.url);return $?v($):P("Authorization error")}),_.addEventListener("exit",U)})},y._rs_init=function(N){const x=A();let w;x&&(w=y.getLocation(),w.hash=""),b=function(){let v=!1;if(x){if(x.error)throw x.error==="access_denied"?new g.default("Authorization failed: access denied",{code:"access_denied"}):new g.default("Authorization failed: "+x.error);x.rsDiscovery&&N.remote.configure(x.rsDiscovery),x.access_token&&(N.remote.configure({token:x.access_token}),v=!0),x.remotestorage&&(N.connect(x.remotestorage),v=!0),x.state&&(w=y.getLocation(),y.setLocation(w.href.split("#")[0]+"#"+x.state)),v||N.remote.stopWaitingForToken()}else N.remote.stopWaitingForToken()},N.on("features-loaded",b)},r.exports=y},function(r,a,s){var o=this&&this.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};const f=o(s(23)),d=o(s(24)),g=o(s(25)),b=o(s(2)),A=o(s(3)),y=s(0);class N{constructor(w,v){if(this.schemas={configurable:!0,get:function(){return N.Types.inScope(this.moduleName)}},v[v.length-1]!=="/")throw"Not a folder: "+v;v==="/"&&(this.makePath=_=>(_[0]==="/"?"":"/")+_),this.storage=w,this.base=v;const P=this.base.split("/");P.length>2?this.moduleName=P[1]:this.moduleName="root",this.addEvents(["change"]),this.on=this.on.bind(this),w.onChange(this.base,this._fireChange.bind(this))}scope(w){return new N(this.storage,this.makePath(w))}getListing(w,v){if(typeof w!="string")w="";else if(w.length>0&&w[w.length-1]!=="/")return Promise.reject("Not a folder: "+w);return this.storage.get(this.makePath(w),v).then(function(P){return P.statusCode===404?{}:P.body})}getAll(w,v){if(typeof w!="string")w="";else if(w.length>0&&w[w.length-1]!=="/")return Promise.reject("Not a folder: "+w);return this.storage.get(this.makePath(w),v).then(P=>{if(P.statusCode===404)return{};if(typeof P.body=="object"){const _=Object.keys(P.body);if(_.length===0)return{};const U=_.map(I=>this.storage.get(this.makePath(w+I),v).then(function($){if(typeof $.body=="string")try{$.body=JSON.parse($.body)}catch{}typeof $.body=="object"&&(P.body[I]=$.body)}));return Promise.all(U).then(function(){return P.body})}})}getFile(w,v){return typeof w!="string"?Promise.reject("Argument 'path' of baseClient.getFile must be a string"):this.storage.get(this.makePath(w),v).then(function(P){return{data:P.body,contentType:P.contentType,revision:P.revision}})}storeFile(w,v,P){return typeof w!="string"?Promise.reject("Argument 'mimeType' of baseClient.storeFile must be a string"):typeof v!="string"?Promise.reject("Argument 'path' of baseClient.storeFile must be a string"):typeof P!="string"&&typeof P!="object"?Promise.reject("Argument 'body' of baseClient.storeFile must be a string, ArrayBuffer, or ArrayBufferView"):(this.storage.access.checkPathPermission(this.makePath(v),"rw")||console.warn("WARNING: Editing a document to which only read access ('r') was claimed"),this.storage.put(this.makePath(v),P,w).then(_=>_.statusCode===200||_.statusCode===201?_.revision:Promise.reject("Request (PUT "+this.makePath(v)+") failed with status: "+_.statusCode)))}getObject(w,v){return typeof w!="string"?Promise.reject("Argument 'path' of baseClient.getObject must be a string"):this.storage.get(this.makePath(w),v).then(P=>{if(typeof P.body=="object")return P.body;if(typeof P.body=="string")try{return JSON.parse(P.body)}catch{throw new Error("Not valid JSON: "+this.makePath(w))}else if(P.body!==void 0&&P.statusCode===200)return Promise.reject("Not an object: "+this.makePath(w))})}storeObject(w,v,P){if(typeof w!="string")return Promise.reject("Argument 'typeAlias' of baseClient.storeObject must be a string");if(typeof v!="string")return Promise.reject("Argument 'path' of baseClient.storeObject must be a string");if(typeof P!="object")return Promise.reject("Argument 'object' of baseClient.storeObject must be an object");this._attachType(P,w);try{const _=this.validate(P);if(!_.valid)return Promise.reject(_)}catch(_){return Promise.reject(_)}return this.storage.put(this.makePath(v),JSON.stringify(P),"application/json; charset=UTF-8").then(_=>_.statusCode===200||_.statusCode===201?_.revision:Promise.reject("Request (PUT "+this.makePath(v)+") failed with status: "+_.statusCode))}remove(w){return typeof w!="string"?Promise.reject("Argument 'path' of baseClient.remove must be a string"):(this.storage.access.checkPathPermission(this.makePath(w),"rw")||console.warn("WARNING: Removing a document to which only read access ('r') was claimed"),this.storage.delete(this.makePath(w)))}getItemURL(w){if(typeof w!="string")throw"Argument 'path' of baseClient.getItemURL must be a string";return this.storage.connected?(w=y.cleanPath(this.makePath(w)),this.storage.remote.href+w):void 0}cache(w,v="ALL"){if(typeof w!="string")throw"Argument 'path' of baseClient.cache must be a string";if(typeof v!="string")throw"Argument 'strategy' of baseClient.cache must be a string or undefined";if(v!=="FLUSH"&&v!=="SEEN"&&v!=="ALL")throw`Argument 'strategy' of baseclient.cache must be one of ["FLUSH", "SEEN", "ALL"]`;return this.storage.caching.set(this.makePath(w),v),this}flush(w){return this.storage.local.flush(w)}declareType(w,v,P){let _;P?_=v:(P=v,_=this._defaultTypeURI(w)),N.Types.declare(this.moduleName,w,_,P)}validate(w){const v=N.Types.getSchema(w["@context"]);if(v)return f.default.validateResult(w,v);throw new g.default(w["@context"])}_defaultTypeURI(w){return"http://remotestorage.io/spec/modules/"+encodeURIComponent(this.moduleName)+"/"+encodeURIComponent(w)}_attachType(w,v){w["@context"]=N.Types.resolveAlias(this.moduleName+"/"+v)||this._defaultTypeURI(v)}makePath(w){return this.base+(w||"")}_fireChange(w){A.default.changeEvents[w.origin]&&(["new","old","lastCommon"].forEach(function(v){if((!w[v+"ContentType"]||/^application\/(.*)json(.*)/.exec(w[v+"ContentType"]))&&typeof w[v+"Value"]=="string")try{w[v+"Value"]=JSON.parse(w[v+"Value"])}catch{}}),this._emit("change",w))}static _rs_init(){}}N.Types=d.default,y.applyMixins(N,[b.default]),r.exports=N},function(r,a,s){(function(o){var f=this&&this.__awaiter||function(C,n,p,h){return new(p||(p=Promise))(function(T,E){function O(B){try{J(h.next(B))}catch(k){E(k)}}function q(B){try{J(h.throw(B))}catch(k){E(k)}}function J(B){var k;B.done?T(B.value):(k=B.value,k instanceof p?k:new p(function(D){D(k)})).then(O,q)}J((h=h.apply(C,n||[])).next())})},d=this&&this.__importDefault||function(C){return C&&C.__esModule?C:{default:C}};const g=d(s(6)),b=d(s(2)),A=d(s(4)),y=d(s(3)),N=d(s(1)),x=s(0);let w;const v="remotestorage:wireclient",P={"draft-dejong-remotestorage-00":2,"draft-dejong-remotestorage-01":3,"draft-dejong-remotestorage-02":4,"https://www.w3.org/community/rww/wiki/read-write-web-00#simple":1};let _;if(typeof(o||window).ArrayBufferView=="function")_=function(C){return C&&C instanceof(o||window).ArrayBufferView};else{const C=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];_=function(n){for(let p=0;p<8;p++)if(n instanceof C[p])return!0;return!1}}function U(C){return typeof C!="string"?C:C==="*"?"*":'"'+C+'"'}function I(C){return typeof C!="string"?C:C.replace(/^["']|["']$/g,"")}class ${constructor(n){if(this._revisionCache={},w=x.localStorageAvailable(),this.rs=n,this.connected=!1,this.addEvents(["connected","not-connected"]),w){const p=function(){const h=x.getJSONFromLocalStorage(v)||{},{userAddress:T,href:E,storageApi:O,token:q,properties:J}=h;return{userAddress:T,href:E,storageApi:O,token:q,properties:J}}();p&&setTimeout(()=>{this.configure(p)},0)}this.connected&&setTimeout(this._emit.bind(this),0,"connected")}get storageType(){if(this.storageApi){const n=this.storageApi.match(/draft-dejong-(remotestorage-\d\d)/);return n?n[1]:"2012.04"}}_request(n,p,h,T,E,O,q){return f(this,void 0,void 0,function*(){if(function(B,k){return(B==="PUT"||B==="DELETE")&&x.isFolder(k)}(n,p))return Promise.reject(`Don't use ${n} on directories!`);let J;return h!==g.default.IMPLIED_FAKE_TOKEN&&(T.Authorization="Bearer "+h),this.rs._emit("wire-busy",{method:n,isFolder:x.isFolder(p)}),$.request(n,p,{body:E,headers:T,responseType:"arraybuffer"}).then(B=>{if(this.online||(this.online=!0,this.rs._emit("network-online")),this.rs._emit("wire-done",{method:n,isFolder:x.isFolder(p),success:!0}),k=B.status,[401,403,404,412].indexOf(k)>=0)return N.default("[WireClient] Error response status",B.status),J=O?I(B.getResponseHeader("ETag")):void 0,B.status===401&&this.rs._emit("error",new A.default),Promise.resolve({statusCode:B.status,revision:J});if(function(D){return[201,204,304].indexOf(D)>=0}(B.status)||B.status===200&&n!=="GET")return J=I(B.getResponseHeader("ETag")),N.default("[WireClient] Successful request",J),Promise.resolve({statusCode:B.status,revision:J});{const D=B.getResponseHeader("Content-Type");J=O?I(B.getResponseHeader("ETag")):B.status===200?q:void 0;const u=function(l){let S,R="UTF-8";return l&&(S=l.match(/charset=(.+)$/),S&&(R=S[1])),R}(D);return x.shouldBeTreatedAsBinary(B.response,D)?(N.default("[WireClient] Successful request with unknown or binary mime-type",J),Promise.resolve({statusCode:B.status,body:B.response,contentType:D,revision:J})):x.getTextFromArrayBuffer(B.response,u).then(l=>(N.default("[WireClient] Successful request",J),Promise.resolve({statusCode:B.status,body:l,contentType:D,revision:J})))}var k},B=>(this.online&&(this.online=!1,this.rs._emit("network-offline")),this.rs._emit("wire-done",{method:n,isFolder:x.isFolder(p),success:!1}),Promise.reject(B)))})}configure(n){if(typeof n!="object")throw new Error("WireClient configure settings parameter should be an object");if(n.userAddress!==void 0&&(this.userAddress=n.userAddress),n.href!==void 0&&(this.href=n.href),n.storageApi!==void 0&&(this.storageApi=n.storageApi),n.token!==void 0&&(this.token=n.token),n.properties!==void 0&&(this.properties=n.properties),typeof this.storageApi=="string"){const p=P[this.storageApi]||5;this.supportsRevs=p>=2}this.href&&this.token?(this.connected=!0,this.online=!0,this._emit("connected")):this.connected=!1,w&&(localStorage[v]=JSON.stringify({userAddress:this.userAddress,href:this.href,storageApi:this.storageApi,token:this.token,properties:this.properties}))}stopWaitingForToken(){this.connected||this._emit("not-connected")}get(n,p={}){if(!this.connected)return Promise.reject("not connected (path: "+n+")");const h={};return this.supportsRevs&&p.ifNoneMatch&&(h["If-None-Match"]=U(p.ifNoneMatch)),this._request("GET",this.href+x.cleanPath(n),this.token,h,void 0,this.supportsRevs,this._revisionCache[n]).then(T=>{if(!x.isFolder(n))return Promise.resolve(T);let E={};if(T.body!==void 0)try{T.body=JSON.parse(T.body)}catch{return Promise.reject("Folder description at "+this.href+x.cleanPath(n)+" is not JSON")}if(T.statusCode===200&&typeof T.body=="object"){if(Object.keys(T.body).length===0)T.statusCode=404;else if((O=T.body)["@context"]==="http://remotestorage.io/spec/folder-description"&&typeof O.items=="object"){for(const q in T.body.items)this._revisionCache[n+q]=T.body.items[q].ETag;E=T.body.items}else Object.keys(T.body).forEach(q=>{this._revisionCache[n+q]=T.body[q],E[q]={ETag:T.body[q]}});return T.body=E,Promise.resolve(T)}return Promise.resolve(T);var O})}put(n,p,h,T={}){if(!this.connected)return Promise.reject("not connected (path: "+n+")");!h.match(/charset=/)&&(p instanceof ArrayBuffer||_(p))&&(h+="; charset=binary");const E={"Content-Type":h};return this.supportsRevs&&(T.ifMatch&&(E["If-Match"]=U(T.ifMatch)),T.ifNoneMatch&&(E["If-None-Match"]=U(T.ifNoneMatch))),this._request("PUT",this.href+x.cleanPath(n),this.token,E,p,this.supportsRevs)}delete(n,p={}){if(!this.connected)throw new Error("not connected (path: "+n+")");p||(p={});const h={};return this.supportsRevs&&p.ifMatch&&(h["If-Match"]=U(p.ifMatch)),this._request("DELETE",this.href+x.cleanPath(n),this.token,h,void 0,this.supportsRevs)}static request(n,p,h){return f(this,void 0,void 0,function*(){return typeof fetch=="function"?$._fetchRequest(n,p,h):typeof XMLHttpRequest=="function"?$._xhrRequest(n,p,h):(N.default("[WireClient] You need to add a polyfill for fetch or XMLHttpRequest"),Promise.reject("[WireClient] You need to add a polyfill for fetch or XMLHttpRequest"))})}static _fetchRequest(n,p,h){let T;const E={};let O;typeof AbortController=="function"&&(O=new AbortController);const q=fetch(p,{method:n,headers:h.headers,body:h.body,signal:O?O.signal:void 0}).then(B=>{switch(N.default("[WireClient fetch]",B),B.headers.forEach((k,D)=>{E[D.toUpperCase()]=k}),T={readyState:4,status:B.status,statusText:B.statusText,response:void 0,getResponseHeader:k=>E[k.toUpperCase()]||null,responseType:h.responseType,responseURL:p},h.responseType){case"arraybuffer":return B.arrayBuffer();case"blob":return B.blob();case"json":return B.json();case void 0:case"":case"text":return B.text();default:throw new Error("responseType 'document' is not currently supported using fetch")}}).then(B=>(T.response=B,h.responseType&&h.responseType!=="text"||(T.responseText=B),T)),J=new Promise((B,k)=>{setTimeout(()=>{k("timeout"),O&&O.abort()},y.default.requestTimeout)});return Promise.race([q,J])}static _xhrRequest(n,p,h){return new Promise((T,E)=>{N.default("[WireClient]",n,p);let O=!1;const q=setTimeout(()=>{O=!0,E("timeout")},y.default.requestTimeout),J=new XMLHttpRequest;if(J.open(n,p,!0),h.responseType&&(J.responseType=h.responseType),h.headers)for(const k in h.headers)J.setRequestHeader(k,h.headers[k]);J.onload=()=>{O||(clearTimeout(q),T(J))},J.onerror=k=>{O||(clearTimeout(q),E(k))};let B=h.body;typeof B=="object"&&!_(B)&&B instanceof ArrayBuffer&&(B=new Uint8Array(B)),J.send(B)})}static _rs_init(n){n.remote=new $(n),n.remote.online=!0}static _rs_supported(){return typeof fetch=="function"||typeof XMLHttpRequest=="function"}static _rs_cleanup(){w&&delete localStorage[v]}}$.isArrayBufferView=_,x.applyMixins($,[b.default]),r.exports=$}).call(this,s(5))},function(r,a,s){class o extends Error{constructor(d){super(),this.name="SyncError",this.message="Sync failed: ",typeof d=="string"?this.message+=d:(this.message+=d.message,this.stack=d.stack,this.originalError=d)}}r.exports=o},function(r,a,s){var o=this&&this.__importDefault||function(v){return v&&v.__esModule?v:{default:v}};const f=o(s(2)),d=o(s(3)),g=o(s(1)),b=s(0);class A{constructor(){this._updateNodesRunning=!1,this._updateNodesQueued=[]}get(P,_,U){return typeof _=="number"?this.getNodes(b.pathsFromRoot(P)).then(I=>{const $=y(I[P]);return N(I,_)?U(P):$?{statusCode:200,body:$.body||$.itemsMap,contentType:$.contentType}:{statusCode:404}}):this.getNodes([P]).then(I=>{const $=y(I[P]);if($){if(b.isFolder(P))for(const C in $.itemsMap)$.itemsMap.hasOwnProperty(C)&&$.itemsMap[C]===!1&&delete $.itemsMap[C];return{statusCode:200,body:$.body||$.itemsMap,contentType:$.contentType}}return{statusCode:404}})}put(P,_,U){const I=b.pathsFromRoot(P);return this._updateNodes(I,function($,C){try{for(let n=0,p=$.length;n<p;n++){const h=$[n];let T,E=C[h];E||(C[h]=E=x(h)),n===0?(T=y(E),E.local={body:_,contentType:U,previousBody:T?T.body:void 0,previousContentType:T?T.contentType:void 0}):E=w(E,$[n-1].substring(h.length))}return C}catch(n){throw g.default("[Cachinglayer] Error during PUT",C,n),n}})}delete(P){const _=b.pathsFromRoot(P);return this._updateNodes(_,function(U,I){for(let $=0,C=U.length;$<C;$++){const n=U[$],p=I[n];let h;if(p)if($===0)h=y(p),p.local={body:!1,previousBody:h?h.body:void 0,previousContentType:h?h.contentType:void 0};else{p.local||(p.local=b.deepClone(p.common));const T=U[$-1].substring(n.length);if(delete p.local.itemsMap[T],Object.getOwnPropertyNames(p.local.itemsMap).length>0)break}else console.error("Cannot delete non-existing node "+n)}return I})}flush(P){return this._getAllDescendentPaths(P).then(_=>this.getNodes(_)).then(_=>{for(const U in _){const I=_[U];I&&I.common&&I.local&&this._emitChange({path:I.path,origin:"local",oldValue:I.local.body===!1?void 0:I.local.body,newValue:I.common.body===!1?void 0:I.common.body}),_[U]=void 0}return this.setNodes(_)})}_emitChange(P){d.default.changeEvents[P.origin]&&this._emit("change",P)}fireInitial(){d.default.changeEvents.local&&this.forAllNodes(P=>{if(b.isDocument(P.path)){const _=y(P);_&&this._emitChange({path:P.path,origin:"local",oldValue:void 0,oldContentType:void 0,newValue:_.body,newContentType:_.contentType})}}).then(()=>{this._emit("local-events-done")})}onDiff(P){this.diffHandler=P}migrate(P){return typeof P!="object"||P.common||(P.common={},typeof P.path=="string"?P.path.substr(-1)==="/"&&typeof P.body=="object"&&(P.common.itemsMap=P.body):(P.local||(P.local={}),P.local.body=P.body,P.local.contentType=P.contentType)),P}_updateNodes(P,_){return new Promise((U,I)=>{this._doUpdateNodes(P,_,{resolve:U,reject:I})})}_doUpdateNodes(P,_,U){this._updateNodesRunning?this._updateNodesQueued.push({paths:P,cb:_,promise:U}):(this._updateNodesRunning=!0,this.getNodes(P).then(I=>{const $=b.deepClone(I),C=[];I=_(P,I);for(const n in I){const p=I[n];b.equal(p,$[n])?delete I[n]:b.isDocument(n)&&(b.equal(p.local.body,p.local.previousBody)&&p.local.contentType===p.local.previousContentType||C.push({path:n,origin:"window",oldValue:p.local.previousBody,newValue:p.local.body===!1?void 0:p.local.body,oldContentType:p.local.previousContentType,newContentType:p.local.contentType}),delete p.local.previousBody,delete p.local.previousContentType)}this.setNodes(I).then(()=>{this._emitChangeEvents(C),U.resolve({statusCode:200})})}).then(()=>Promise.resolve(),I=>{U.reject(I)}).then(()=>{this._updateNodesRunning=!1;const I=this._updateNodesQueued.shift();I&&this._doUpdateNodes(I.paths,I.cb,I.promise)}))}_emitChangeEvents(P){for(let _=0,U=P.length;_<U;_++)this._emitChange(P[_]),this.diffHandler&&this.diffHandler(P[_].path)}_getAllDescendentPaths(P){return b.isFolder(P)?this.getNodes([P]).then(_=>{const U=[P],I=y(_[P]),$=Object.keys(I.itemsMap).map(C=>this._getAllDescendentPaths(P+C).then(n=>{for(let p=0,h=n.length;p<h;p++)U.push(n[p])}));return Promise.all($).then(()=>U)}):Promise.resolve([P])}_getInternals(){return{getLatest:y,makeNode:x,isOutdated:N}}}function y(v){if(typeof v=="object"&&typeof v.path=="string")if(b.isFolder(v.path)){if(v.local&&v.local.itemsMap)return v.local;if(v.common&&v.common.itemsMap)return v.common}else{if(v.local){if(v.local.body&&v.local.contentType)return v.local;if(v.local.body===!1)return}if(v.common&&v.common.body&&v.common.contentType)return v.common;if(v.body&&v.contentType)return{body:v.body,contentType:v.contentType}}}function N(v,P){for(const _ in v){if(v[_]&&v[_].remote)return!0;const U=y(v[_]);if(U&&U.timestamp&&new Date().getTime()-U.timestamp<=P)return!1;if(!U)return!0}return!0}function x(v){const P={path:v,common:{}};return b.isFolder(v)&&(P.common.itemsMap={}),P}function w(v,P){return v.common||(v.common={itemsMap:{}}),v.common.itemsMap||(v.common.itemsMap={}),v.local||(v.local=b.deepClone(v.common)),v.local.itemsMap||(v.local.itemsMap=v.common.itemsMap),v.local.itemsMap[P]=!0,v}b.applyMixins(A,[f.default]),r.exports=A},function(r,a,s){r.exports=class{constructor(){this.reset()}static _rs_init(){}get scopes(){return Object.keys(this.scopeModeMap).map(o=>({name:o,mode:this.scopeModeMap[o]}))}get scopeParameter(){return this.scopes.map(o=>`${this._scopeNameForParameter(o)}:${o.mode}`).join(" ")}claim(o,f){if(typeof o!="string"||o.indexOf("/")!==-1||o.length===0)throw new Error("Scope should be a non-empty string without forward slashes");if(!f.match(/^rw?$/))throw new Error("Mode should be either 'r' or 'rw'");this._adjustRootPaths(o),this.scopeModeMap[o]=f}get(o){return this.scopeModeMap[o]}remove(o){const f={};for(const d in this.scopeModeMap)f[d]=this.scopeModeMap[d];this.reset(),delete f[o];for(const d in f)this.claim(d,f[d])}checkPermission(o,f){const d=this.get(o);return d&&(f==="r"||d==="rw")}checkPathPermission(o,f){if(this.checkPermission("*",f))return!0;const d=this._getModuleName(o);return!!this.checkPermission(d,f)}reset(){this.rootPaths=[],this.scopeModeMap={}}_getModuleName(o){if(o[0]!=="/")throw new Error("Path should start with a slash");const f=o.replace(/^\/public/,"").match(/^\/([^/]*)\//);return f?f[1]:"*"}_adjustRootPaths(o){"*"in this.scopeModeMap||o==="*"?this.rootPaths=["/"]:o in this.scopeModeMap||(this.rootPaths.push("/"+o+"/"),this.rootPaths.push("/public/"+o+"/"))}_scopeNameForParameter(o){if(o.name==="*"&&this.storageType){if(this.storageType==="2012.04")return"";if(this.storageType.match(/remotestorage-0[01]/))return"root"}return o.name}setStorageType(o){this.storageType=o}}},function(r,a,s){var o=this&&this.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};const f=s(0),d=o(s(1));r.exports=class{constructor(){this.pendingActivations=[],this.reset()}set(g,b){if(typeof g!="string")throw new Error("path should be a string");if(!f.isFolder(g))throw new Error("path should be a folder");if(!b.match(/^(FLUSH|SEEN|ALL)$/))throw new Error("strategy should be 'FLUSH', 'SEEN', or 'ALL'");this._rootPaths[g]=b,b==="ALL"&&(this.activateHandler?this.activateHandler(g):this.pendingActivations.push(g))}enable(g){this.set(g,"ALL")}disable(g){this.set(g,"FLUSH")}onActivate(g){d.default("[Caching] Setting activate handler",g,this.pendingActivations),this.activateHandler=g;for(let b=0;b<this.pendingActivations.length;b++)g(this.pendingActivations[b]);this.pendingActivations=[]}checkPath(g){return this._rootPaths[g]!==void 0?this._rootPaths[g]:g==="/"?"SEEN":this.checkPath(f.containingFolder(g))}reset(){this._rootPaths={}}static _rs_init(){}}},function(r,a,s){var o=this&&this.__importDefault||function($){return $&&$.__esModule?$:{default:$}};const f=o(s(7)),d=o(s(8)),g=o(s(2)),b=s(0),A="https://www.googleapis.com",y="remotestorage:googledrive";let N;function x($){return $.substr(-1)==="/"&&($=$.substr(0,$.length-1)),decodeURIComponent($)}function w($){return $.replace(/[^\/]+\/?$/,"")}function v($){const C=$.split("/");return $.substr(-1)==="/"?C[C.length-2]+"/":C[C.length-1]}function P($){return b.cleanPath("/remotestorage/"+$)}function _($){return $.replace(/^["'](.*)["']$/,"$1")}class U{constructor(C){this._items={},this.maxAge=C,this._items={}}get(C){const n=this._items[C],p=new Date().getTime();return n&&n.t>=p-this.maxAge?n.v:void 0}set(C,n){this._items[C]={v:n,t:new Date().getTime()}}}class I{constructor(C,n){if(this.connected=!1,this.online=!0,this.addEvents(["connected","not-connected"]),this.rs=C,this.clientId=n,this._fileIdCache=new U(300),N=b.localStorageAvailable(),N){const p=b.getJSONFromLocalStorage(y);p&&this.configure(p)}}configure(C){C.userAddress!==void 0&&(this.userAddress=C.userAddress),C.token!==void 0&&(this.token=C.token);const n=function(){N&&localStorage.setItem(y,JSON.stringify({userAddress:this.userAddress,token:this.token}))},p=function(){this.connected=!1,delete this.token,N&&localStorage.removeItem(y)};this.token?(this.connected=!0,this.userAddress?(this._emit("connected"),n.apply(this)):this.info().then(h=>{this.userAddress=h.user.emailAddress,this._emit("connected"),n.apply(this)}).catch(()=>{p.apply(this),this.rs._emit("error",new Error("Could not fetch user info."))})):p.apply(this)}connect(){this.rs.setBackend("googledrive"),this.rs.authorize({authURL:"https://accounts.google.com/o/oauth2/auth",scope:"https://www.googleapis.com/auth/drive",clientId:this.clientId})}stopWaitingForToken(){this.connected||this._emit("not-connected")}get(C,n){return b.isFolder(C)?this._getFolder(P(C)):this._getFile(P(C),n)}put(C,n,p,h){const T=P(C);function E(O){if(O.status>=200&&O.status<300){const q=JSON.parse(O.responseText),J=_(q.etag);return Promise.resolve({statusCode:200,contentType:q.mimeType,revision:J})}return O.status===412?Promise.resolve({statusCode:412,revision:"conflict"}):Promise.reject("PUT failed with status "+O.status+" ("+O.responseText+")")}return this._getFileId(T).then(O=>O?h&&h.ifNoneMatch==="*"?E({status:412}):this._updateFile(O,T,n,p,h).then(E):this._createFile(T,n,p).then(E))}delete(C,n){const p=P(C);return this._getFileId(p).then(h=>h?this._getMeta(h).then(T=>{let E;return typeof T=="object"&&typeof T.etag=="string"&&(E=_(T.etag)),n&&n.ifMatch&&n.ifMatch!==E?{statusCode:412,revision:E}:this._request("DELETE",A+"/drive/v2/files/"+h,{}).then(O=>O.status===200||O.status===204?{statusCode:200}:Promise.reject("Delete failed: "+O.status+" ("+O.responseText+")"))}):Promise.resolve({statusCode:200}))}info(){return this._request("GET","https://www.googleapis.com/drive/v2/about?fields=user",{}).then(function(C){try{const n=JSON.parse(C.responseText);return Promise.resolve(n)}catch(n){return Promise.reject(n)}})}_updateFile(C,n,p,h,T){const E={mimeType:h},O={"Content-Type":"application/json; charset=UTF-8"};return T&&T.ifMatch&&(O["If-Match"]='"'+T.ifMatch+'"'),this._request("PUT",A+"/upload/drive/v2/files/"+C+"?uploadType=resumable",{body:JSON.stringify(E),headers:O}).then(q=>q.status===412?q:this._request("PUT",q.getResponseHeader("Location"),{body:h.match(/^application\/json/)?JSON.stringify(p):p}))}_createFile(C,n,p){return this._getParentId(C).then(h=>{const T={title:x(v(C)),mimeType:p,parents:[{kind:"drive#fileLink",id:h}]};return this._request("POST",A+"/upload/drive/v2/files?uploadType=resumable",{body:JSON.stringify(T),headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(E=>this._request("POST",E.getResponseHeader("Location"),{body:p.match(/^application\/json/)?JSON.stringify(n):n}))})}_getFile(C,n){return this._getFileId(C).then(p=>this._getMeta(p).then(h=>{let T;if(typeof h=="object"&&typeof h.etag=="string"&&(T=_(h.etag)),n&&n.ifNoneMatch&&T===n.ifNoneMatch)return Promise.resolve({statusCode:304});if(!h.downloadUrl){if(!h.exportLinks||!h.exportLinks["text/html"])return Promise.resolve({statusCode:200,body:"",contentType:h.mimeType,revision:T});h.mimeType+=";export=text/html",h.downloadUrl=h.exportLinks["text/html"]}return this._request("GET",h.downloadUrl,{responseType:"arraybuffer"}).then(E=>b.getTextFromArrayBuffer(E.response,"UTF-8").then(function(O){let q=O;if(h.mimeType.match(/^application\/json/))try{q=JSON.parse(q)}catch{}else b.shouldBeTreatedAsBinary(O,h.mimeType)&&(q=E.response);return{statusCode:200,body:q,contentType:h.mimeType,revision:T}}))}))}_getFolder(C){return this._getFileId(C).then(n=>{let p,h,T;if(!n)return Promise.resolve({statusCode:404});const E="'"+n+"' in parents";return this._request("GET",A+"/drive/v2/files?q="+encodeURIComponent(E)+"&fields="+encodeURIComponent("items(downloadUrl,etag,fileSize,id,mimeType,title)")+"&maxResults=1000",{}).then(O=>{if(O.status!==200)return Promise.reject("request failed or something: "+O.status);try{p=JSON.parse(O.responseText)}catch{return Promise.reject("non-JSON response from GoogleDrive")}T={};for(const q of p.items)h=_(q.etag),q.mimeType==="application/vnd.google-apps.folder"?(this._fileIdCache.set(C+b.cleanPath(q.title)+"/",q.id),T[q.title+"/"]={ETag:h}):(this._fileIdCache.set(C+b.cleanPath(q.title),q.id),T[q.title]={ETag:h,"Content-Type":q.mimeType,"Content-Length":q.fileSize});return Promise.resolve({statusCode:200,body:T,contentType:"application/json; charset=UTF-8",revision:void 0})})})}_getParentId(C){const n=w(C);return this._getFileId(n).then(p=>p?Promise.resolve(p):this._createFolder(n))}_createFolder(C){return this._getParentId(C).then(n=>this._request("POST",A+"/drive/v2/files",{body:JSON.stringify({title:x(v(C)),mimeType:"application/vnd.google-apps.folder",parents:[{id:n}]}),headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(p=>{const h=JSON.parse(p.responseText);return Promise.resolve(h.id)}))}_getFileId(C){let n;return C==="/"?Promise.resolve("root"):(n=this._fileIdCache.get(C))?Promise.resolve(n):this._getFolder(w(C)).then(()=>(n=this._fileIdCache.get(C),n?Promise.resolve(n):C.substr(-1)==="/"?this._createFolder(C).then(()=>this._getFileId(C)):Promise.resolve()))}_getMeta(C){return this._request("GET",A+"/drive/v2/files/"+C,{}).then(function(n){return n.status===200?Promise.resolve(JSON.parse(n.responseText)):Promise.reject("request (getting metadata for "+C+") failed with status: "+n.status)})}_request(C,n,p){return p.headers||(p.headers={}),p.headers.Authorization="Bearer "+this.token,this.rs._emit("wire-busy",{method:C,isFolder:b.isFolder(n)}),d.default.request.call(this,C,n,p).then(h=>h&&h.status===401?void this.connect():(this.online||(this.online=!0,this.rs._emit("network-online")),this.rs._emit("wire-done",{method:C,isFolder:b.isFolder(n),success:!0}),Promise.resolve(h)),h=>(this.online&&(this.online=!1,this.rs._emit("network-offline")),this.rs._emit("wire-done",{method:C,isFolder:b.isFolder(n),success:!1}),Promise.reject(h)))}static _rs_init(C){const n=C.apiKeys.googledrive;var p;n&&(C.googledrive=new I(C,n.clientId),C.backend==="googledrive"&&(C._origRemote=C.remote,C.remote=C.googledrive,(p=C)._origBaseClientGetItemURL||(p._origBaseClientGetItemURL=f.default.prototype.getItemURL,f.default.prototype.getItemURL=function(){throw new Error("getItemURL is not implemented for Google Drive yet")})))}static _rs_supported(){return!0}static _rs_cleanup(C){var n;C.setBackend(void 0),C._origRemote&&(C.remote=C._origRemote,delete C._origRemote),(n=C)._origBaseClientGetItemURL&&(f.default.prototype.getItemURL=n._origBaseClientGetItemURL,delete n._origBaseClientGetItemURL)}}b.applyMixins(I,[g.default]),r.exports=I},function(r,a,s){var o=this&&this.__awaiter||function(p,h,T,E){return new(T||(T=Promise))(function(O,q){function J(D){try{k(E.next(D))}catch(u){q(u)}}function B(D){try{k(E.throw(D))}catch(u){q(u)}}function k(D){var u;D.done?O(D.value):(u=D.value,u instanceof T?u:new T(function(l){l(u)})).then(J,B)}k((E=E.apply(p,h||[])).next())})},f=this&&this.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};const d=f(s(2)),g=f(s(8)),b=f(s(7)),A=f(s(26)),y=f(s(9)),N=f(s(4)),x=s(0);let w;const v="remotestorage:dropbox";function P(p){return x.cleanPath("/remotestorage/"+p).replace(/\/$/,"")}function _(p,h){return new RegExp("^"+h.join("\\/")+"(\\/|$)").test(p.error_summary)}function U(p){return p instanceof ArrayBuffer||g.default.isArrayBufferView(p)}class I{constructor(h){if(this.rs=h,this.connected=!1,this.online=!0,this._initialFetchDone=!1,this.addEvents(["connected","not-connected"]),this.clientId=h.apiKeys.dropbox.appKey,this._revCache=new A.default("rev"),this._fetchDeltaCursor=null,this._fetchDeltaPromise=null,this._itemRefs={},w=x.localStorageAvailable(),w){const T=x.getJSONFromLocalStorage(v);T&&this.configure(T),this._itemRefs=x.getJSONFromLocalStorage(v+":shares")||{}}this.connected&&setTimeout(this._emit.bind(this),0,"connected")}connect(){this.rs.setBackend("dropbox"),this.token?n(this.rs):this.rs.authorize({authURL:"https://www.dropbox.com/oauth2/authorize",scope:"",clientId:this.clientId})}configure(h){h.userAddress!==void 0&&(this.userAddress=h.userAddress),h.token!==void 0&&(this.token=h.token);const T=function(){w&&localStorage.setItem(v,JSON.stringify({userAddress:this.userAddress,token:this.token}))},E=function(){this.connected=!1,w&&localStorage.removeItem(v)};this.token?(this.connected=!0,this.userAddress?(this._emit("connected"),T.apply(this)):this.info().then(function(O){this.userAddress=O.email,this._emit("connected"),T.apply(this)}.bind(this)).catch(function(){E.apply(this),this.rs._emit("error",new Error("Could not fetch user info."))}.bind(this))):E.apply(this)}stopWaitingForToken(){this.connected||this._emit("not-connected")}_getFolder(h){const T=this._revCache,E=q=>{let J;if(q.status!==200&&q.status!==409)return Promise.reject("Unexpected response status: "+q.status);try{J=JSON.parse(q.responseText)}catch(k){return Promise.reject(k)}if(q.status===409)return _(J,["path","not_found"])?Promise.resolve({}):Promise.reject(new Error("API returned an error: "+J.error_summary));const B=J.entries.reduce((k,D)=>{const u=D[".tag"]==="folder",l=D.path_lower.split("/").slice(-1)[0]+(u?"/":"");return u?k[l]={ETag:T.get(h+l)}:(k[l]={ETag:D.rev},this._revCache.set(h+l,D.rev)),k},{});return J.has_more?O(J.cursor).then(function(k){return Object.assign(B,k)}):Promise.resolve(B)},O=q=>{const J={body:{cursor:q}};return this._request("POST","https://api.dropboxapi.com/2/files/list_folder/continue",J).then(E)};return this._request("POST","https://api.dropboxapi.com/2/files/list_folder",{body:{path:P(h)}}).then(E).then(function(q){return Promise.resolve({statusCode:200,body:q,contentType:"application/json; charset=UTF-8",revision:T.get(h)})})}get(h,T){if(!this.connected)return Promise.reject("not connected (path: "+h+")");const E=this._revCache.get(h);if(E===null)return Promise.resolve({statusCode:404});if(T&&T.ifNoneMatch){if(!this._initialFetchDone)return this.fetchDelta().then(()=>this.get(h,T));if(E&&E===T.ifNoneMatch)return Promise.resolve({statusCode:304})}if(h.substr(-1)==="/")return this._getFolder(h);const O={headers:{"Dropbox-API-Arg":JSON.stringify({path:P(h)})},responseType:"arraybuffer"};return T&&T.ifNoneMatch&&(O.headers["If-None-Match"]=T.ifNoneMatch),this._request("GET","https://content.dropboxapi.com/2/files/download",O).then(q=>{const J=q.status;let B,k,D,u;return J!==200&&J!==409?Promise.resolve({statusCode:J}):(B=q.getResponseHeader("Dropbox-API-Result"),x.getTextFromArrayBuffer(q.response,"UTF-8").then(l=>{k=l,J===409&&(B=k);try{B=JSON.parse(B)}catch(S){return Promise.reject(S)}if(J===409)return _(B,["path","not_found"])?{statusCode:404}:Promise.reject(new Error('API error while downloading file ("'+h+'"): '+B.error_summary));if(D=q.getResponseHeader("Content-Type"),u=B.rev,this._revCache.set(h,u),this._shareIfNeeded(h),x.shouldBeTreatedAsBinary(l,D))k=q.response;else try{k=JSON.parse(k),D="application/json; charset=UTF-8"}catch{}return{statusCode:J,body:k,contentType:D,revision:u}}))})}put(h,T,E,O){if(!this.connected)throw new Error("not connected (path: "+h+")");const q=this._revCache.get(h);if(O&&O.ifMatch&&q&&q!==O.ifMatch)return Promise.resolve({statusCode:412,revision:q});if(O&&O.ifNoneMatch==="*"&&q&&q!=="rev")return Promise.resolve({statusCode:412,revision:q});if(!E.match(/charset=/)&&U(T)&&(E+="; charset=binary"),T.length>157286400)return Promise.reject(new Error("Cannot upload file larger than 150MB"));let J;const B=O&&(O.ifMatch||O.ifNoneMatch==="*"),k={body:T,contentType:E,path:h};return J=B?this._getMetadata(h).then(D=>O&&O.ifNoneMatch==="*"&&D||O&&O.ifMatch&&D&&D.rev!==O.ifMatch?Promise.resolve({statusCode:412,revision:D.rev}):this._uploadSimple(k)):this._uploadSimple(k),J.then(D=>(this._shareIfNeeded(h),D))}delete(h,T){if(!this.connected)throw new Error("not connected (path: "+h+")");const E=this._revCache.get(h);return T&&T.ifMatch&&E&&T.ifMatch!==E?Promise.resolve({statusCode:412,revision:E}):T&&T.ifMatch?this._getMetadata(h).then(O=>T&&T.ifMatch&&O&&O.rev!==T.ifMatch?Promise.resolve({statusCode:412,revision:O.rev}):this._deleteSimple(h)):this._deleteSimple(h)}_shareIfNeeded(h){h.match(/^\/public\/.*[^/]$/)&&this._itemRefs[h]===void 0&&this.share(h)}share(h){const T={body:{path:P(h)}};return this._request("POST","https://api.dropboxapi.com/2/sharing/create_shared_link_with_settings",T).then(E=>{if(E.status!==200&&E.status!==409)return Promise.reject(new Error("Invalid response status:"+E.status));let O;try{O=JSON.parse(E.responseText)}catch{return Promise.reject(new Error("Invalid response body: "+E.responseText))}return E.status===409?_(O,["shared_link_already_exists"])?this._getSharedLink(h):Promise.reject(new Error("API error: "+O.error_summary)):Promise.resolve(O.url)}).then(E=>(this._itemRefs[h]=E,w&&localStorage.setItem(v+":shares",JSON.stringify(this._itemRefs)),Promise.resolve(E)),E=>(E.message='Sharing Dropbox file or folder ("'+h+'") failed: '+E.message,Promise.reject(E)))}info(){return this._request("POST","https://api.dropboxapi.com/2/users/get_current_account",{}).then(function(h){let T=h.responseText;try{T=JSON.parse(T)}catch{return Promise.reject(new Error("Could not query current account info: Invalid API response: "+T))}return Promise.resolve({email:T.email})})}_request(h,T,E){return E.headers||(E.headers={}),E.headers.Authorization="Bearer "+this.token,typeof E.body!="object"||U(E.body)||(E.body=JSON.stringify(E.body),E.headers["Content-Type"]="application/json; charset=UTF-8"),this.rs._emit("wire-busy",{method:h,isFolder:x.isFolder(T)}),g.default.request.call(this,h,T,E).then(O=>O&&O.status===503?(this.online&&(this.online=!1,this.rs._emit("network-offline")),setTimeout(this._request(h,T,E),3210)):(this.online||(this.online=!0,this.rs._emit("network-online")),this.rs._emit("wire-done",{method:h,isFolder:x.isFolder(T),success:!0}),Promise.resolve(O)),O=>(this.online&&(this.online=!1,this.rs._emit("network-offline")),this.rs._emit("wire-done",{method:h,isFolder:x.isFolder(T),success:!1}),Promise.reject(O)))}fetchDelta(...h){if(this._fetchDeltaPromise)return this._fetchDeltaPromise;const T=E=>{let O,q="https://api.dropboxapi.com/2/files/list_folder";return typeof E=="string"?(q+="/continue",O={cursor:E}):O={path:"/remotestorage",recursive:!0,include_deleted:!0},this._request("POST",q,{body:O}).then(J=>{if(J.status===401)return this.rs._emit("error",new N.default),Promise.resolve(h);if(J.status!==200&&J.status!==409)return Promise.reject(new Error("Invalid response status: "+J.status));let B;try{B=JSON.parse(J.responseText)}catch{return Promise.reject(new Error("Invalid response body: "+J.responseText))}if(J.status===409){if(!_(B,["path","not_found"]))return Promise.reject(new Error("API returned an error: "+B.error_summary));B={cursor:null,entries:[],has_more:!1}}if(E||this._revCache.deactivatePropagation(),B.entries.forEach(k=>{const D=k.path_lower.substr("/remotestorage".length);k[".tag"]==="deleted"?(this._revCache.delete(D),this._revCache.delete(D+"/")):k[".tag"]==="file"&&this._revCache.set(D,k.rev)}),this._fetchDeltaCursor=B.cursor,B.has_more)return T(B.cursor);this._revCache.activatePropagation(),this._initialFetchDone=!0}).catch(J=>J==="timeout"||J instanceof ProgressEvent?Promise.resolve():Promise.reject(J))};return this._fetchDeltaPromise=T(this._fetchDeltaCursor).catch(E=>(typeof E=="object"&&"message"in E?E.message="Dropbox: fetchDelta: "+E.message:E="Dropbox: fetchDelta: "+E,this._fetchDeltaPromise=null,Promise.reject(E))).then(()=>(this._fetchDeltaPromise=null,Promise.resolve(h))),this._fetchDeltaPromise}_getMetadata(h){const T={path:P(h)};return this._request("POST","https://api.dropboxapi.com/2/files/get_metadata",{body:T}).then(E=>{if(E.status!==200&&E.status!==409)return Promise.reject(new Error("Invalid response status:"+E.status));let O;try{O=JSON.parse(E.responseText)}catch{return Promise.reject(new Error("Invalid response body: "+E.responseText))}return E.status===409?_(O,["path","not_found"])?Promise.resolve():Promise.reject(new Error("API error: "+O.error_summary)):Promise.resolve(O)}).then(void 0,E=>(E.message='Could not load metadata for file or folder ("'+h+'"): '+E.message,Promise.reject(E)))}_uploadSimple(h){const T={path:P(h.path),mode:{".tag":"overwrite",update:void 0},mute:!0};return h.ifMatch&&(T.mode={".tag":"update",update:h.ifMatch}),this._request("POST","https://content.dropboxapi.com/2/files/upload",{body:h.body,headers:{"Content-Type":"application/octet-stream","Dropbox-API-Arg":JSON.stringify(T)}}).then(E=>{if(E.status!==200&&E.status!==409)return Promise.resolve({statusCode:E.status});let O=E.responseText;try{O=JSON.parse(O)}catch{return Promise.reject(new Error("Invalid API result: "+O))}return E.status===409?_(O,["path","conflict"])?this._getMetadata(h.path).then(function(q){return Promise.resolve({statusCode:412,revision:q.rev})}):Promise.reject(new Error("API error: "+O.error_summary)):(this._revCache.set(h.path,O.rev),Promise.resolve({statusCode:E.status,revision:O.rev}))})}_deleteSimple(h){const T={path:P(h)};return this._request("POST","https://api.dropboxapi.com/2/files/delete",{body:T}).then(E=>{if(E.status!==200&&E.status!==409)return Promise.resolve({statusCode:E.status});let O=E.responseText;try{O=JSON.parse(O)}catch{return Promise.reject(new Error("Invalid response body: "+O))}return E.status===409?_(O,["path_lookup","not_found"])?Promise.resolve({statusCode:404}):Promise.reject(new Error("API error: "+O.error_summary)):Promise.resolve({statusCode:200})}).then(E=>(E.statusCode!==200&&E.statusCode!==404||(this._revCache.delete(h),delete this._itemRefs[h]),Promise.resolve(E)),E=>(E.message='Could not delete Dropbox file or folder ("'+h+'"): '+E.message,Promise.reject(E)))}_getSharedLink(h){return o(this,void 0,void 0,function*(){const T={body:{path:P(h),direct_only:!0}};return this._request("POST","https://api.dropbox.com/2/sharing/list_shared_links",T).then(E=>{if(E.status!==200&&E.status!==409)return Promise.reject(new Error("Invalid response status: "+E.status));let O;try{O=JSON.parse(E.responseText)}catch{return Promise.reject(new Error("Invalid response body: "+E.responseText))}return E.status===409?Promise.reject(new Error("API error: "+E.error_summary)):O.links.length?Promise.resolve(O.links[0].url):Promise.reject(new Error("No links returned"))},E=>(E.message='Could not get link to a shared file or folder ("'+h+'"): '+E.message,Promise.reject(E)))})}static _rs_init(h){w=x.localStorageAvailable(),h.apiKeys.dropbox&&(h.dropbox=new I(h)),h.backend==="dropbox"&&n(h)}static _rs_supported(){return!0}static _rs_cleanup(h){(function(T){(function(E){E._origRemote&&(E.remote=E._origRemote,delete E._origRemote)})(T),function(E){!E._dropboxOrigSync||(E.sync.sync=E._dropboxOrigSync,delete E._dropboxOrigSync)}(T),function(E){!E._origBaseClientGetItemURL||(b.default.prototype.getItemURL=E._origBaseClientGetItemURL,delete E._origBaseClientGetItemURL)}(T),C(T)})(h),w&&localStorage.removeItem(v),h.setBackend(void 0)}}function $(p,...h){p._dropboxOrigSync||(p._dropboxOrigSync=p.sync.sync.bind(p.sync),p.sync.sync=function(){return this.dropbox.fetchDelta(p,...h).then(p._dropboxOrigSync,function(T){p._emit("error",new y.default(T)),p._emit("sync-done")})}.bind(p))}function C(p){p._dropboxOrigSyncCycle&&(p.syncCycle=p._dropboxOrigSyncCycle,delete p._dropboxOrigSyncCycle)}function n(p){(function(h){h._origRemote||(h._origRemote=h.remote,h.remote=h.dropbox)})(p),p.sync?$(p):function(h,...T){h._dropboxOrigSyncCycle||(h._dropboxOrigSyncCycle=h.syncCycle,h.syncCycle=()=>{if(!h.sync)throw new Error("expected sync to be initialized by now");$(h),h._dropboxOrigSyncCycle(h,...T),C(h)})}(p),function(h){h._origBaseClientGetItemURL||(h._origBaseClientGetItemURL=b.default.prototype.getItemURL,b.default.prototype.getItemURL=function(){throw new Error("getItemURL is not implemented for Dropbox yet")})}(p)}x.applyMixins(I,[d.default]),r.exports=I},function(r,a,s){var o=this&&this.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};const f=o(s(27)),d=o(s(1)),g=s(0);let b,A,y={};const N=function(x){return new Promise((w,v)=>x in y?w(y[x]):new f.default({tls_only:!1,uri_fallback:!0,request_timeout:5e3}).lookup(x,function(P,_){if(P)return v(P);if(typeof _.idx.links.remotestorage!="object"||typeof _.idx.links.remotestorage.length!="number"||_.idx.links.remotestorage.length<=0)return d.default("[Discover] WebFinger record for "+x+" does not have remotestorage defined in the links section ",JSON.stringify(_.json)),v("WebFinger record for "+x+" does not have remotestorage defined in the links section.");const U=_.idx.links.remotestorage[0],I=U.properties["http://tools.ietf.org/html/rfc6749#section-4.2"]||U.properties["auth-endpoint"],$=U.properties["http://remotestorage.io/spec/version"]||U.type;return y[x]={href:U.href,storageApi:$,authURL:I,properties:U.properties},A&&(localStorage["remotestorage:discover"]=JSON.stringify({cache:y})),w(y[x])}))};(N.DiscoveryError=function(x){this.name="DiscoveryError",this.message=x,this.stack=new Error().stack}).prototype=Object.create(Error.prototype),N.DiscoveryError.prototype.constructor=N.DiscoveryError,N._rs_init=function(){if(A=g.localStorageAvailable(),A)try{y=JSON.parse(localStorage["remotestorage:discover"]).cache}catch{}},N._rs_supported=function(){return b=Object.prototype.hasOwnProperty.call(g.globalContext,"XMLHttpRequest"),b},N._rs_cleanup=function(){A&&delete localStorage["remotestorage:discover"]},r.exports=N},function(r,a,s){const o=(this&&this.__importDefault||function(g){return g&&g.__esModule?g:{default:g}})(s(2)),f=s(0);class d{constructor(){this.addEvents(["background","foreground"]),this.mode=typeof window!="undefined"?"browser":"node",this.mode==="browser"&&(this.setBrowserPrefixedNames(),document.addEventListener(this.visibilityChangeEvent,this.setVisibility.bind(this),!1),this.setVisibility())}setBrowserPrefixedNames(){this.mode==="browser"&&(document.hidden!==void 0?(this.hiddenProperty="hidden",this.visibilityChangeEvent="visibilitychange"):document.mozHidden!==void 0?(this.hiddenProperty="mozHidden",this.visibilityChangeEvent="mozvisibilitychange"):document.msHidden!==void 0?(this.hiddenProperty="msHidden",this.visibilityChangeEvent="msvisibilitychange"):document.webkitHidden!==void 0&&(this.hiddenProperty="webkitHidden",this.visibilityChangeEvent="webkitvisibilitychange"))}setVisibility(){document[this.hiddenProperty]?this.goBackground():this.goForeground()}isBrowser(){return this.mode==="browser"}isNode(){return this.mode==="node"}goBackground(){this._emit("background")}goForeground(){this._emit("foreground")}static _rs_init(){}static _rs_cleanup(){}}f.applyMixins(d,[o.default]),r.exports=d},function(r,a,s){r.exports=s(18)},function(r,a,s){var o=this&&this.__createBinding||(Object.create?function(B,k,D,u){u===void 0&&(u=D),Object.defineProperty(B,u,{enumerable:!0,get:function(){return k[D]}})}:function(B,k,D,u){u===void 0&&(u=D),B[u]=k[D]}),f=this&&this.__setModuleDefault||(Object.create?function(B,k){Object.defineProperty(B,"default",{enumerable:!0,value:k})}:function(B,k){B.default=k}),d=this&&this.__importStar||function(B){if(B&&B.__esModule)return B;var k={};if(B!=null)for(var D in B)D!=="default"&&Object.hasOwnProperty.call(B,D)&&o(k,B,D);return f(k,B),k},g=this&&this.__importDefault||function(B){return B&&B.__esModule?B:{default:B}};const b=g(s(3)),A=g(s(1)),y=s(0),N=g(s(11)),x=g(s(6)),w=g(s(7)),v=g(s(12)),P=g(s(2)),_=g(s(13)),U=g(s(14)),I=g(s(15)),$=g(s(9)),C=g(s(4)),n=g(s(29)),p=d(s(0)),h=y.getGlobalContext();let T;function E(B){return B.statusCode!==403&&B.statusCode!==401||this._emit("error",new C.default),Promise.resolve(B)}function O(B){return typeof B=="number"&&B>1e3&&B<36e5}class q{constructor(k){this._pending=[],this._cleanups=[],this._pathHandlers={change:{}},this.apiKeys={},this._init=n.default.loadFeatures,this.features=n.default.features,this.loadFeature=n.default.loadFeature,this.featureSupported=n.default.featureSupported,this.featureDone=n.default.featureDone,this.featuresDone=n.default.featuresDone,this.featuresLoaded=n.default.featuresLoaded,this.featureInitialized=n.default.featureInitialized,this.featureFailed=n.default.featureFailed,this.hasFeature=n.default.hasFeature,this._setCachingModule=n.default._setCachingModule,this._collectCleanupFunctions=n.default._collectCleanupFunctions,this._fireReady=n.default._fireReady,this.initFeature=n.default.initFeature,typeof k=="object"&&y.extend(b.default,k),this.addEvents(["ready","authing","connecting","connected","disconnected","not-connected","conflict","error","features-loaded","sync-interval-change","sync-req-done","sync-done","wire-busy","wire-done","network-offline","network-online"]),this._setGPD({get:this._pendingGPD("get"),put:this._pendingGPD("put"),delete:this._pendingGPD("delete")}),T=y.localStorageAvailable(),T&&(this.apiKeys=y.getJSONFromLocalStorage("remotestorage:api-keys")||{},this.setBackend(localStorage.getItem("remotestorage:backend")||"remotestorage"));const D=this.on;this.on=function(u,l){if(this._allLoaded)switch(u){case"features-loaded":setTimeout(l,0);break;case"ready":this.remote&&setTimeout(l,0);break;case"connected":this.remote&&this.remote.connected&&setTimeout(l,0);break;case"not-connected":this.remote&&!this.remote.connected&&setTimeout(l,0)}return D.call(this,u,l)},this._init(),this.fireInitial=function(){this.local&&setTimeout(this.local.fireInitial.bind(this.local),0)}.bind(this),this.on("ready",this.fireInitial.bind(this)),this.loadModules()}get connected(){return this.remote.connected}loadModules(){b.default.modules.forEach(this.addModule.bind(this))}authorize(k){if(this.access.setStorageType(this.remote.storageApi),k.scope===void 0&&(k.scope=this.access.scopeParameter),h.cordova)k.redirectUri=b.default.cordovaRedirectUri;else{const D=x.default.getLocation();let u=D.origin;D.pathname!=="/"&&(u+=D.pathname),k.redirectUri=u}k.clientId===void 0&&(k.clientId=k.redirectUri.match(/^(https?:\/\/[^/]+)/)[0]),x.default.authorize(this,k)}impliedauth(k,D){k=k||this.remote.storageApi,D=D||String(document.location),A.default("ImpliedAuth proceeding due to absent authURL; storageApi = "+k+" redirectUri = "+D),this.remote.configure({token:x.default.IMPLIED_FAKE_TOKEN}),document.location.href=D}connect(k,D){if(this.setBackend("remotestorage"),k.indexOf("@")<0)return void this._emit("error",new q.DiscoveryError("User address doesn't contain an @."));if(h.cordova){if(typeof b.default.cordovaRedirectUri!="string")return void this._emit("error",new q.DiscoveryError("Please supply a custom HTTPS redirect URI for your Cordova app"));if(!h.cordova.InAppBrowser)return void this._emit("error",new q.DiscoveryError("Please include the InAppBrowser Cordova plugin to enable OAuth"))}this.remote.configure({userAddress:k}),this._emit("connecting");const u=setTimeout(()=>{this._emit("error",new q.DiscoveryError("No storage information found for this user address."))},b.default.discoveryTimeout);I.default(k).then(l=>{if(clearTimeout(u),this._emit("authing"),l.userAddress=k,this.remote.configure(l),!this.remote.connected)if(l.authURL)if(D===void 0)this.authorize({authURL:l.authURL});else{if(typeof D!="string")throw new Error("Supplied bearer token must be a string");A.default("Skipping authorization sequence and connecting with known token"),this.remote.configure({token:D})}else this.impliedauth()},()=>{clearTimeout(u),this._emit("error",new q.DiscoveryError("No storage information found for this user address."))})}reconnect(){this.remote.configure({token:null}),this.backend==="remotestorage"?this.connect(this.remote.userAddress):this.remote.connect()}disconnect(){this.remote&&this.remote.configure({userAddress:null,href:null,storageApi:null,token:null,properties:null}),this._setGPD({get:this._pendingGPD("get"),put:this._pendingGPD("put"),delete:this._pendingGPD("delete")});const k=this._cleanups.length;let D=0;const u=()=>{D++,D>=k&&(this._init(),this._emit("disconnected"))};k>0?this._cleanups.forEach(l=>{const S=l(this);typeof S=="object"&&typeof S.then=="function"?S.then(u):u()}):u()}setBackend(k){this.backend=k,T&&(k?localStorage.setItem("remotestorage:backend",k):localStorage.removeItem("remotestorage:backend"))}onChange(k,D){this._pathHandlers.change[k]||(this._pathHandlers.change[k]=[]),this._pathHandlers.change[k].push(D)}enableLog(){b.default.logging=!0}disableLog(){b.default.logging=!1}log(...k){A.default.apply(q,k)}setApiKeys(k){const D=[J.GOOGLE,J.DROPBOX];if(typeof k!="object"||!Object.keys(k).every(u=>D.includes(u)))return console.error("setApiKeys() was called with invalid arguments"),!1;Object.keys(k).forEach(u=>{const l=k[u];if(l){switch(u){case J.DROPBOX:this.apiKeys[J.DROPBOX]={appKey:l},this.dropbox!==void 0&&this.dropbox.clientId===l||U.default._rs_init(this);break;case J.GOOGLE:this.apiKeys[J.GOOGLE]={clientId:l},this.googledrive!==void 0&&this.googledrive.clientId===l||_.default._rs_init(this)}return!0}delete this.apiKeys[u]}),T&&localStorage.setItem("remotestorage:api-keys",JSON.stringify(this.apiKeys))}setCordovaRedirectUri(k){if(typeof k!="string"||!k.match(/http(s)?:\/\//))throw new Error("Cordova redirect URI must be a URI string");b.default.cordovaRedirectUri=k}_setGPD(k,D){function u(l){return function(...S){return l.apply(D,S).then(E.bind(this))}}this.get=u(k.get),this.put=u(k.put),this.delete=u(k.delete)}_pendingGPD(k){return(...D)=>{const u=Array.prototype.slice.call(D);return new Promise((l,S)=>{this._pending.push({method:k,args:u,promise:{resolve:l,reject:S}})})}}_processPending(){this._pending.forEach(k=>{try{this[k.method](...k.args).then(k.promise.resolve,k.promise.reject)}catch(D){k.promise.reject(D)}}),this._pending=[]}_bindChange(k){k.on("change",this._dispatchEvent.bind(this,"change"))}_dispatchEvent(k,D){Object.keys(this._pathHandlers[k]).forEach(u=>{const l=u.length;D.path.substr(0,l)===u&&this._pathHandlers[k][u].forEach(S=>{const R={};for(const F in D)R[F]=D[F];R.relativePath=D.path.replace(new RegExp("^"+u),"");try{S(R)}catch(F){console.error("'change' handler failed: ",F,F.stack),this._emit("error",F)}})})}scope(k){if(typeof k!="string")throw"Argument 'path' of baseClient.scope must be a string";return this.access.checkPathPermission(k,"r")||console.warn("WARNING: Please use remoteStorage.access.claim() to ask for access permissions first: https://remotestoragejs.readthedocs.io/en/latest/js-api/access.html#claim"),new w.default(this,k)}getSyncInterval(){return b.default.syncInterval}setSyncInterval(k){if(!O(k))throw k+" is not a valid sync interval";const D=b.default.syncInterval;b.default.syncInterval=k,this._emit("sync-interval-change",{oldValue:D,newValue:k})}getBackgroundSyncInterval(){return b.default.backgroundSyncInterval}setBackgroundSyncInterval(k){if(!O(k))throw k+" is not a valid sync interval";const D=b.default.backgroundSyncInterval;b.default.backgroundSyncInterval=k,this._emit("sync-interval-change",{oldValue:D,newValue:k})}getCurrentSyncInterval(){return b.default.isBackground?b.default.backgroundSyncInterval:b.default.syncInterval}getRequestTimeout(){return b.default.requestTimeout}setRequestTimeout(k){if(typeof k!="number")throw k+" is not a valid request timeout";b.default.requestTimeout=k}syncCycle(){this.sync&&!this.sync.stopped&&(this.on("sync-done",()=>{this.sync&&!this.sync.stopped&&(this._syncTimer&&(clearTimeout(this._syncTimer),this._syncTimer=void 0),this._syncTimer=setTimeout(this.sync.sync.bind(this.sync),this.getCurrentSyncInterval()))}),this.sync.sync())}startSync(){return b.default.cache?(this.sync.stopped=!1,this.syncStopped=!1,this.sync.sync()):(console.warn("Nothing to sync, because caching is disabled."),Promise.resolve())}stopSync(){clearTimeout(this._syncTimer),this._syncTimer=void 0,this.sync?this.sync.stopped=!0:this.syncStopped=!0}addModule(k){const D=k.name,u=k.builder;if(Object.defineProperty(this,D,{configurable:!0,get:function(){const l=this._loadModule(D,u);return Object.defineProperty(this,D,{value:l}),l}}),D.indexOf("-")!==-1){const l=D.replace(/\-[a-z]/g,function(S){return S[1].toUpperCase()});Object.defineProperty(this,l,{get:function(){return this[D]}})}}_loadModule(k,D){if(D)return D(new w.default(this,"/"+k+"/"),new w.default(this,"/public/"+k+"/")).exports;throw"Unknown module: "+k}}var J;q.Authorize=x.default,q.SyncError=$.default,q.Unauthorized=C.default,q.DiscoveryError=I.default.DiscoveryError,q.util=p,Object.defineProperty(q.prototype,"access",{get:function(){const B=new N.default;return Object.defineProperty(this,"access",{value:B}),B},configurable:!0}),Object.defineProperty(q.prototype,"caching",{configurable:!0,get:function(){const B=new v.default;return Object.defineProperty(this,"caching",{value:B}),B}}),y.applyMixins(q,[P.default]),function(B){B.GOOGLE="googledrive",B.DROPBOX="dropbox"}(J||(J={})),r.exports=q},function(r,a,s){(function(o){/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */var f=s(20),d=s(21),g=s(22);function b(){return y.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function A(i,c){if(b()<c)throw new RangeError("Invalid typed array length");return y.TYPED_ARRAY_SUPPORT?(i=new Uint8Array(c)).__proto__=y.prototype:(i===null&&(i=new y(c)),i.length=c),i}function y(i,c,m){if(!(y.TYPED_ARRAY_SUPPORT||this instanceof y))return new y(i,c,m);if(typeof i=="number"){if(typeof c=="string")throw new Error("If encoding is specified then the first argument must be a string");return w(this,i)}return N(this,i,c,m)}function N(i,c,m,j){if(typeof c=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer!="undefined"&&c instanceof ArrayBuffer?function(M,L,z,X){if(L.byteLength,z<0||L.byteLength<z)throw new RangeError("'offset' is out of bounds");if(L.byteLength<z+(X||0))throw new RangeError("'length' is out of bounds");return L=z===void 0&&X===void 0?new Uint8Array(L):X===void 0?new Uint8Array(L,z):new Uint8Array(L,z,X),y.TYPED_ARRAY_SUPPORT?(M=L).__proto__=y.prototype:M=v(M,L),M}(i,c,m,j):typeof c=="string"?function(M,L,z){if(typeof z=="string"&&z!==""||(z="utf8"),!y.isEncoding(z))throw new TypeError('"encoding" must be a valid string encoding');var X=0|_(L,z),nt=(M=A(M,X)).write(L,z);return nt!==X&&(M=M.slice(0,nt)),M}(i,c,m):function(M,L){if(y.isBuffer(L)){var z=0|P(L.length);return(M=A(M,z)).length===0||L.copy(M,0,0,z),M}if(L){if(typeof ArrayBuffer!="undefined"&&L.buffer instanceof ArrayBuffer||"length"in L)return typeof L.length!="number"||(X=L.length)!=X?A(M,0):v(M,L);if(L.type==="Buffer"&&g(L.data))return v(M,L.data)}var X;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(i,c)}function x(i){if(typeof i!="number")throw new TypeError('"size" argument must be a number');if(i<0)throw new RangeError('"size" argument must not be negative')}function w(i,c){if(x(c),i=A(i,c<0?0:0|P(c)),!y.TYPED_ARRAY_SUPPORT)for(var m=0;m<c;++m)i[m]=0;return i}function v(i,c){var m=c.length<0?0:0|P(c.length);i=A(i,m);for(var j=0;j<m;j+=1)i[j]=255&c[j];return i}function P(i){if(i>=b())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+b().toString(16)+" bytes");return 0|i}function _(i,c){if(y.isBuffer(i))return i.length;if(typeof ArrayBuffer!="undefined"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(i)||i instanceof ArrayBuffer))return i.byteLength;typeof i!="string"&&(i=""+i);var m=i.length;if(m===0)return 0;for(var j=!1;;)switch(c){case"ascii":case"latin1":case"binary":return m;case"utf8":case"utf-8":case void 0:return it(i).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*m;case"hex":return m>>>1;case"base64":return rt(i).length;default:if(j)return it(i).length;c=(""+c).toLowerCase(),j=!0}}function U(i,c,m){var j=!1;if((c===void 0||c<0)&&(c=0),c>this.length||((m===void 0||m>this.length)&&(m=this.length),m<=0)||(m>>>=0)<=(c>>>=0))return"";for(i||(i="utf8");;)switch(i){case"hex":return D(this,c,m);case"utf8":case"utf-8":return J(this,c,m);case"ascii":return B(this,c,m);case"latin1":case"binary":return k(this,c,m);case"base64":return q(this,c,m);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u(this,c,m);default:if(j)throw new TypeError("Unknown encoding: "+i);i=(i+"").toLowerCase(),j=!0}}function I(i,c,m){var j=i[c];i[c]=i[m],i[m]=j}function $(i,c,m,j,M){if(i.length===0)return-1;if(typeof m=="string"?(j=m,m=0):m>2147483647?m=2147483647:m<-2147483648&&(m=-2147483648),m=+m,isNaN(m)&&(m=M?0:i.length-1),m<0&&(m=i.length+m),m>=i.length){if(M)return-1;m=i.length-1}else if(m<0){if(!M)return-1;m=0}if(typeof c=="string"&&(c=y.from(c,j)),y.isBuffer(c))return c.length===0?-1:C(i,c,m,j,M);if(typeof c=="number")return c&=255,y.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?M?Uint8Array.prototype.indexOf.call(i,c,m):Uint8Array.prototype.lastIndexOf.call(i,c,m):C(i,[c],m,j,M);throw new TypeError("val must be string, number or Buffer")}function C(i,c,m,j,M){var L,z=1,X=i.length,nt=c.length;if(j!==void 0&&((j=String(j).toLowerCase())==="ucs2"||j==="ucs-2"||j==="utf16le"||j==="utf-16le")){if(i.length<2||c.length<2)return-1;z=2,X/=2,nt/=2,m/=2}function tt(yt,Dt){return z===1?yt[Dt]:yt.readUInt16BE(Dt*z)}if(M){var V=-1;for(L=m;L<X;L++)if(tt(i,L)===tt(c,V===-1?0:L-V)){if(V===-1&&(V=L),L-V+1===nt)return V*z}else V!==-1&&(L-=L-V),V=-1}else for(m+nt>X&&(m=X-nt),L=m;L>=0;L--){for(var lt=!0,pt=0;pt<nt;pt++)if(tt(i,L+pt)!==tt(c,pt)){lt=!1;break}if(lt)return L}return-1}function n(i,c,m,j){m=Number(m)||0;var M=i.length-m;j?(j=Number(j))>M&&(j=M):j=M;var L=c.length;if(L%2!=0)throw new TypeError("Invalid hex string");j>L/2&&(j=L/2);for(var z=0;z<j;++z){var X=parseInt(c.substr(2*z,2),16);if(isNaN(X))return z;i[m+z]=X}return z}function p(i,c,m,j){return K(it(c,i.length-m),i,m,j)}function h(i,c,m,j){return K(function(M){for(var L=[],z=0;z<M.length;++z)L.push(255&M.charCodeAt(z));return L}(c),i,m,j)}function T(i,c,m,j){return h(i,c,m,j)}function E(i,c,m,j){return K(rt(c),i,m,j)}function O(i,c,m,j){return K(function(M,L){for(var z,X,nt,tt=[],V=0;V<M.length&&!((L-=2)<0);++V)z=M.charCodeAt(V),X=z>>8,nt=z%256,tt.push(nt),tt.push(X);return tt}(c,i.length-m),i,m,j)}function q(i,c,m){return c===0&&m===i.length?f.fromByteArray(i):f.fromByteArray(i.slice(c,m))}function J(i,c,m){m=Math.min(i.length,m);for(var j=[],M=c;M<m;){var L,z,X,nt,tt=i[M],V=null,lt=tt>239?4:tt>223?3:tt>191?2:1;if(M+lt<=m)switch(lt){case 1:tt<128&&(V=tt);break;case 2:(192&(L=i[M+1]))==128&&(nt=(31&tt)<<6|63&L)>127&&(V=nt);break;case 3:L=i[M+1],z=i[M+2],(192&L)==128&&(192&z)==128&&(nt=(15&tt)<<12|(63&L)<<6|63&z)>2047&&(nt<55296||nt>57343)&&(V=nt);break;case 4:L=i[M+1],z=i[M+2],X=i[M+3],(192&L)==128&&(192&z)==128&&(192&X)==128&&(nt=(15&tt)<<18|(63&L)<<12|(63&z)<<6|63&X)>65535&&nt<1114112&&(V=nt)}V===null?(V=65533,lt=1):V>65535&&(V-=65536,j.push(V>>>10&1023|55296),V=56320|1023&V),j.push(V),M+=lt}return function(pt){var yt=pt.length;if(yt<=4096)return String.fromCharCode.apply(String,pt);for(var Dt="",xe=0;xe<yt;)Dt+=String.fromCharCode.apply(String,pt.slice(xe,xe+=4096));return Dt}(j)}a.Buffer=y,a.SlowBuffer=function(i){return+i!=i&&(i=0),y.alloc(+i)},a.INSPECT_MAX_BYTES=50,y.TYPED_ARRAY_SUPPORT=o.TYPED_ARRAY_SUPPORT!==void 0?o.TYPED_ARRAY_SUPPORT:function(){try{var i=new Uint8Array(1);return i.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},i.foo()===42&&typeof i.subarray=="function"&&i.subarray(1,1).byteLength===0}catch{return!1}}(),a.kMaxLength=b(),y.poolSize=8192,y._augment=function(i){return i.__proto__=y.prototype,i},y.from=function(i,c,m){return N(null,i,c,m)},y.TYPED_ARRAY_SUPPORT&&(y.prototype.__proto__=Uint8Array.prototype,y.__proto__=Uint8Array,typeof Symbol!="undefined"&&Symbol.species&&y[Symbol.species]===y&&Object.defineProperty(y,Symbol.species,{value:null,configurable:!0})),y.alloc=function(i,c,m){return function(j,M,L,z){return x(M),M<=0?A(j,M):L!==void 0?typeof z=="string"?A(j,M).fill(L,z):A(j,M).fill(L):A(j,M)}(null,i,c,m)},y.allocUnsafe=function(i){return w(null,i)},y.allocUnsafeSlow=function(i){return w(null,i)},y.isBuffer=function(i){return!(i==null||!i._isBuffer)},y.compare=function(i,c){if(!y.isBuffer(i)||!y.isBuffer(c))throw new TypeError("Arguments must be Buffers");if(i===c)return 0;for(var m=i.length,j=c.length,M=0,L=Math.min(m,j);M<L;++M)if(i[M]!==c[M]){m=i[M],j=c[M];break}return m<j?-1:j<m?1:0},y.isEncoding=function(i){switch(String(i).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},y.concat=function(i,c){if(!g(i))throw new TypeError('"list" argument must be an Array of Buffers');if(i.length===0)return y.alloc(0);var m;if(c===void 0)for(c=0,m=0;m<i.length;++m)c+=i[m].length;var j=y.allocUnsafe(c),M=0;for(m=0;m<i.length;++m){var L=i[m];if(!y.isBuffer(L))throw new TypeError('"list" argument must be an Array of Buffers');L.copy(j,M),M+=L.length}return j},y.byteLength=_,y.prototype._isBuffer=!0,y.prototype.swap16=function(){var i=this.length;if(i%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var c=0;c<i;c+=2)I(this,c,c+1);return this},y.prototype.swap32=function(){var i=this.length;if(i%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var c=0;c<i;c+=4)I(this,c,c+3),I(this,c+1,c+2);return this},y.prototype.swap64=function(){var i=this.length;if(i%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var c=0;c<i;c+=8)I(this,c,c+7),I(this,c+1,c+6),I(this,c+2,c+5),I(this,c+3,c+4);return this},y.prototype.toString=function(){var i=0|this.length;return i===0?"":arguments.length===0?J(this,0,i):U.apply(this,arguments)},y.prototype.equals=function(i){if(!y.isBuffer(i))throw new TypeError("Argument must be a Buffer");return this===i||y.compare(this,i)===0},y.prototype.inspect=function(){var i="",c=a.INSPECT_MAX_BYTES;return this.length>0&&(i=this.toString("hex",0,c).match(/.{2}/g).join(" "),this.length>c&&(i+=" ... ")),"<Buffer "+i+">"},y.prototype.compare=function(i,c,m,j,M){if(!y.isBuffer(i))throw new TypeError("Argument must be a Buffer");if(c===void 0&&(c=0),m===void 0&&(m=i?i.length:0),j===void 0&&(j=0),M===void 0&&(M=this.length),c<0||m>i.length||j<0||M>this.length)throw new RangeError("out of range index");if(j>=M&&c>=m)return 0;if(j>=M)return-1;if(c>=m)return 1;if(this===i)return 0;for(var L=(M>>>=0)-(j>>>=0),z=(m>>>=0)-(c>>>=0),X=Math.min(L,z),nt=this.slice(j,M),tt=i.slice(c,m),V=0;V<X;++V)if(nt[V]!==tt[V]){L=nt[V],z=tt[V];break}return L<z?-1:z<L?1:0},y.prototype.includes=function(i,c,m){return this.indexOf(i,c,m)!==-1},y.prototype.indexOf=function(i,c,m){return $(this,i,c,m,!0)},y.prototype.lastIndexOf=function(i,c,m){return $(this,i,c,m,!1)},y.prototype.write=function(i,c,m,j){if(c===void 0)j="utf8",m=this.length,c=0;else if(m===void 0&&typeof c=="string")j=c,m=this.length,c=0;else{if(!isFinite(c))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");c|=0,isFinite(m)?(m|=0,j===void 0&&(j="utf8")):(j=m,m=void 0)}var M=this.length-c;if((m===void 0||m>M)&&(m=M),i.length>0&&(m<0||c<0)||c>this.length)throw new RangeError("Attempt to write outside buffer bounds");j||(j="utf8");for(var L=!1;;)switch(j){case"hex":return n(this,i,c,m);case"utf8":case"utf-8":return p(this,i,c,m);case"ascii":return h(this,i,c,m);case"latin1":case"binary":return T(this,i,c,m);case"base64":return E(this,i,c,m);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,i,c,m);default:if(L)throw new TypeError("Unknown encoding: "+j);j=(""+j).toLowerCase(),L=!0}},y.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function B(i,c,m){var j="";m=Math.min(i.length,m);for(var M=c;M<m;++M)j+=String.fromCharCode(127&i[M]);return j}function k(i,c,m){var j="";m=Math.min(i.length,m);for(var M=c;M<m;++M)j+=String.fromCharCode(i[M]);return j}function D(i,c,m){var j=i.length;(!c||c<0)&&(c=0),(!m||m<0||m>j)&&(m=j);for(var M="",L=c;L<m;++L)M+=Z(i[L]);return M}function u(i,c,m){for(var j=i.slice(c,m),M="",L=0;L<j.length;L+=2)M+=String.fromCharCode(j[L]+256*j[L+1]);return M}function l(i,c,m){if(i%1!=0||i<0)throw new RangeError("offset is not uint");if(i+c>m)throw new RangeError("Trying to access beyond buffer length")}function S(i,c,m,j,M,L){if(!y.isBuffer(i))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>M||c<L)throw new RangeError('"value" argument is out of bounds');if(m+j>i.length)throw new RangeError("Index out of range")}function R(i,c,m,j){c<0&&(c=65535+c+1);for(var M=0,L=Math.min(i.length-m,2);M<L;++M)i[m+M]=(c&255<<8*(j?M:1-M))>>>8*(j?M:1-M)}function F(i,c,m,j){c<0&&(c=4294967295+c+1);for(var M=0,L=Math.min(i.length-m,4);M<L;++M)i[m+M]=c>>>8*(j?M:3-M)&255}function H(i,c,m,j,M,L){if(m+j>i.length)throw new RangeError("Index out of range");if(m<0)throw new RangeError("Index out of range")}function G(i,c,m,j,M){return M||H(i,0,m,4),d.write(i,c,m,j,23,4),m+4}function W(i,c,m,j,M){return M||H(i,0,m,8),d.write(i,c,m,j,52,8),m+8}y.prototype.slice=function(i,c){var m,j=this.length;if((i=~~i)<0?(i+=j)<0&&(i=0):i>j&&(i=j),(c=c===void 0?j:~~c)<0?(c+=j)<0&&(c=0):c>j&&(c=j),c<i&&(c=i),y.TYPED_ARRAY_SUPPORT)(m=this.subarray(i,c)).__proto__=y.prototype;else{var M=c-i;m=new y(M,void 0);for(var L=0;L<M;++L)m[L]=this[L+i]}return m},y.prototype.readUIntLE=function(i,c,m){i|=0,c|=0,m||l(i,c,this.length);for(var j=this[i],M=1,L=0;++L<c&&(M*=256);)j+=this[i+L]*M;return j},y.prototype.readUIntBE=function(i,c,m){i|=0,c|=0,m||l(i,c,this.length);for(var j=this[i+--c],M=1;c>0&&(M*=256);)j+=this[i+--c]*M;return j},y.prototype.readUInt8=function(i,c){return c||l(i,1,this.length),this[i]},y.prototype.readUInt16LE=function(i,c){return c||l(i,2,this.length),this[i]|this[i+1]<<8},y.prototype.readUInt16BE=function(i,c){return c||l(i,2,this.length),this[i]<<8|this[i+1]},y.prototype.readUInt32LE=function(i,c){return c||l(i,4,this.length),(this[i]|this[i+1]<<8|this[i+2]<<16)+16777216*this[i+3]},y.prototype.readUInt32BE=function(i,c){return c||l(i,4,this.length),16777216*this[i]+(this[i+1]<<16|this[i+2]<<8|this[i+3])},y.prototype.readIntLE=function(i,c,m){i|=0,c|=0,m||l(i,c,this.length);for(var j=this[i],M=1,L=0;++L<c&&(M*=256);)j+=this[i+L]*M;return j>=(M*=128)&&(j-=Math.pow(2,8*c)),j},y.prototype.readIntBE=function(i,c,m){i|=0,c|=0,m||l(i,c,this.length);for(var j=c,M=1,L=this[i+--j];j>0&&(M*=256);)L+=this[i+--j]*M;return L>=(M*=128)&&(L-=Math.pow(2,8*c)),L},y.prototype.readInt8=function(i,c){return c||l(i,1,this.length),128&this[i]?-1*(255-this[i]+1):this[i]},y.prototype.readInt16LE=function(i,c){c||l(i,2,this.length);var m=this[i]|this[i+1]<<8;return 32768&m?4294901760|m:m},y.prototype.readInt16BE=function(i,c){c||l(i,2,this.length);var m=this[i+1]|this[i]<<8;return 32768&m?4294901760|m:m},y.prototype.readInt32LE=function(i,c){return c||l(i,4,this.length),this[i]|this[i+1]<<8|this[i+2]<<16|this[i+3]<<24},y.prototype.readInt32BE=function(i,c){return c||l(i,4,this.length),this[i]<<24|this[i+1]<<16|this[i+2]<<8|this[i+3]},y.prototype.readFloatLE=function(i,c){return c||l(i,4,this.length),d.read(this,i,!0,23,4)},y.prototype.readFloatBE=function(i,c){return c||l(i,4,this.length),d.read(this,i,!1,23,4)},y.prototype.readDoubleLE=function(i,c){return c||l(i,8,this.length),d.read(this,i,!0,52,8)},y.prototype.readDoubleBE=function(i,c){return c||l(i,8,this.length),d.read(this,i,!1,52,8)},y.prototype.writeUIntLE=function(i,c,m,j){i=+i,c|=0,m|=0,j||S(this,i,c,m,Math.pow(2,8*m)-1,0);var M=1,L=0;for(this[c]=255&i;++L<m&&(M*=256);)this[c+L]=i/M&255;return c+m},y.prototype.writeUIntBE=function(i,c,m,j){i=+i,c|=0,m|=0,j||S(this,i,c,m,Math.pow(2,8*m)-1,0);var M=m-1,L=1;for(this[c+M]=255&i;--M>=0&&(L*=256);)this[c+M]=i/L&255;return c+m},y.prototype.writeUInt8=function(i,c,m){return i=+i,c|=0,m||S(this,i,c,1,255,0),y.TYPED_ARRAY_SUPPORT||(i=Math.floor(i)),this[c]=255&i,c+1},y.prototype.writeUInt16LE=function(i,c,m){return i=+i,c|=0,m||S(this,i,c,2,65535,0),y.TYPED_ARRAY_SUPPORT?(this[c]=255&i,this[c+1]=i>>>8):R(this,i,c,!0),c+2},y.prototype.writeUInt16BE=function(i,c,m){return i=+i,c|=0,m||S(this,i,c,2,65535,0),y.TYPED_ARRAY_SUPPORT?(this[c]=i>>>8,this[c+1]=255&i):R(this,i,c,!1),c+2},y.prototype.writeUInt32LE=function(i,c,m){return i=+i,c|=0,m||S(this,i,c,4,4294967295,0),y.TYPED_ARRAY_SUPPORT?(this[c+3]=i>>>24,this[c+2]=i>>>16,this[c+1]=i>>>8,this[c]=255&i):F(this,i,c,!0),c+4},y.prototype.writeUInt32BE=function(i,c,m){return i=+i,c|=0,m||S(this,i,c,4,4294967295,0),y.TYPED_ARRAY_SUPPORT?(this[c]=i>>>24,this[c+1]=i>>>16,this[c+2]=i>>>8,this[c+3]=255&i):F(this,i,c,!1),c+4},y.prototype.writeIntLE=function(i,c,m,j){if(i=+i,c|=0,!j){var M=Math.pow(2,8*m-1);S(this,i,c,m,M-1,-M)}var L=0,z=1,X=0;for(this[c]=255&i;++L<m&&(z*=256);)i<0&&X===0&&this[c+L-1]!==0&&(X=1),this[c+L]=(i/z>>0)-X&255;return c+m},y.prototype.writeIntBE=function(i,c,m,j){if(i=+i,c|=0,!j){var M=Math.pow(2,8*m-1);S(this,i,c,m,M-1,-M)}var L=m-1,z=1,X=0;for(this[c+L]=255&i;--L>=0&&(z*=256);)i<0&&X===0&&this[c+L+1]!==0&&(X=1),this[c+L]=(i/z>>0)-X&255;return c+m},y.prototype.writeInt8=function(i,c,m){return i=+i,c|=0,m||S(this,i,c,1,127,-128),y.TYPED_ARRAY_SUPPORT||(i=Math.floor(i)),i<0&&(i=255+i+1),this[c]=255&i,c+1},y.prototype.writeInt16LE=function(i,c,m){return i=+i,c|=0,m||S(this,i,c,2,32767,-32768),y.TYPED_ARRAY_SUPPORT?(this[c]=255&i,this[c+1]=i>>>8):R(this,i,c,!0),c+2},y.prototype.writeInt16BE=function(i,c,m){return i=+i,c|=0,m||S(this,i,c,2,32767,-32768),y.TYPED_ARRAY_SUPPORT?(this[c]=i>>>8,this[c+1]=255&i):R(this,i,c,!1),c+2},y.prototype.writeInt32LE=function(i,c,m){return i=+i,c|=0,m||S(this,i,c,4,2147483647,-2147483648),y.TYPED_ARRAY_SUPPORT?(this[c]=255&i,this[c+1]=i>>>8,this[c+2]=i>>>16,this[c+3]=i>>>24):F(this,i,c,!0),c+4},y.prototype.writeInt32BE=function(i,c,m){return i=+i,c|=0,m||S(this,i,c,4,2147483647,-2147483648),i<0&&(i=4294967295+i+1),y.TYPED_ARRAY_SUPPORT?(this[c]=i>>>24,this[c+1]=i>>>16,this[c+2]=i>>>8,this[c+3]=255&i):F(this,i,c,!1),c+4},y.prototype.writeFloatLE=function(i,c,m){return G(this,i,c,!0,m)},y.prototype.writeFloatBE=function(i,c,m){return G(this,i,c,!1,m)},y.prototype.writeDoubleLE=function(i,c,m){return W(this,i,c,!0,m)},y.prototype.writeDoubleBE=function(i,c,m){return W(this,i,c,!1,m)},y.prototype.copy=function(i,c,m,j){if(m||(m=0),j||j===0||(j=this.length),c>=i.length&&(c=i.length),c||(c=0),j>0&&j<m&&(j=m),j===m||i.length===0||this.length===0)return 0;if(c<0)throw new RangeError("targetStart out of bounds");if(m<0||m>=this.length)throw new RangeError("sourceStart out of bounds");if(j<0)throw new RangeError("sourceEnd out of bounds");j>this.length&&(j=this.length),i.length-c<j-m&&(j=i.length-c+m);var M,L=j-m;if(this===i&&m<c&&c<j)for(M=L-1;M>=0;--M)i[M+c]=this[M+m];else if(L<1e3||!y.TYPED_ARRAY_SUPPORT)for(M=0;M<L;++M)i[M+c]=this[M+m];else Uint8Array.prototype.set.call(i,this.subarray(m,m+L),c);return L},y.prototype.fill=function(i,c,m,j){if(typeof i=="string"){if(typeof c=="string"?(j=c,c=0,m=this.length):typeof m=="string"&&(j=m,m=this.length),i.length===1){var M=i.charCodeAt(0);M<256&&(i=M)}if(j!==void 0&&typeof j!="string")throw new TypeError("encoding must be a string");if(typeof j=="string"&&!y.isEncoding(j))throw new TypeError("Unknown encoding: "+j)}else typeof i=="number"&&(i&=255);if(c<0||this.length<c||this.length<m)throw new RangeError("Out of range index");if(m<=c)return this;var L;if(c>>>=0,m=m===void 0?this.length:m>>>0,i||(i=0),typeof i=="number")for(L=c;L<m;++L)this[L]=i;else{var z=y.isBuffer(i)?i:it(new y(i,j).toString()),X=z.length;for(L=0;L<m-c;++L)this[L+c]=z[L%X]}return this};var Y=/[^+\/0-9A-Za-z-_]/g;function Z(i){return i<16?"0"+i.toString(16):i.toString(16)}function it(i,c){var m;c=c||1/0;for(var j=i.length,M=null,L=[],z=0;z<j;++z){if((m=i.charCodeAt(z))>55295&&m<57344){if(!M){if(m>56319){(c-=3)>-1&&L.push(239,191,189);continue}if(z+1===j){(c-=3)>-1&&L.push(239,191,189);continue}M=m;continue}if(m<56320){(c-=3)>-1&&L.push(239,191,189),M=m;continue}m=65536+(M-55296<<10|m-56320)}else M&&(c-=3)>-1&&L.push(239,191,189);if(M=null,m<128){if((c-=1)<0)break;L.push(m)}else if(m<2048){if((c-=2)<0)break;L.push(m>>6|192,63&m|128)}else if(m<65536){if((c-=3)<0)break;L.push(m>>12|224,m>>6&63|128,63&m|128)}else{if(!(m<1114112))throw new Error("Invalid code point");if((c-=4)<0)break;L.push(m>>18|240,m>>12&63|128,m>>6&63|128,63&m|128)}}return L}function rt(i){return f.toByteArray(function(c){if((c=function(m){return m.trim?m.trim():m.replace(/^\s+|\s+$/g,"")}(c).replace(Y,"")).length<2)return"";for(;c.length%4!=0;)c+="=";return c}(i))}function K(i,c,m,j){for(var M=0;M<j&&!(M+m>=c.length||M>=i.length);++M)c[M+m]=i[M];return M}}).call(this,s(5))},function(r,a,s){a.byteLength=function(x){var w=y(x),v=w[0],P=w[1];return 3*(v+P)/4-P},a.toByteArray=function(x){var w,v,P=y(x),_=P[0],U=P[1],I=new d(function(n,p,h){return 3*(p+h)/4-h}(0,_,U)),$=0,C=U>0?_-4:_;for(v=0;v<C;v+=4)w=f[x.charCodeAt(v)]<<18|f[x.charCodeAt(v+1)]<<12|f[x.charCodeAt(v+2)]<<6|f[x.charCodeAt(v+3)],I[$++]=w>>16&255,I[$++]=w>>8&255,I[$++]=255&w;return U===2&&(w=f[x.charCodeAt(v)]<<2|f[x.charCodeAt(v+1)]>>4,I[$++]=255&w),U===1&&(w=f[x.charCodeAt(v)]<<10|f[x.charCodeAt(v+1)]<<4|f[x.charCodeAt(v+2)]>>2,I[$++]=w>>8&255,I[$++]=255&w),I},a.fromByteArray=function(x){for(var w,v=x.length,P=v%3,_=[],U=0,I=v-P;U<I;U+=16383)_.push(N(x,U,U+16383>I?I:U+16383));return P===1?(w=x[v-1],_.push(o[w>>2]+o[w<<4&63]+"==")):P===2&&(w=(x[v-2]<<8)+x[v-1],_.push(o[w>>10]+o[w>>4&63]+o[w<<2&63]+"=")),_.join("")};for(var o=[],f=[],d=typeof Uint8Array!="undefined"?Uint8Array:Array,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b=0,A=g.length;b<A;++b)o[b]=g[b],f[g.charCodeAt(b)]=b;function y(x){var w=x.length;if(w%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var v=x.indexOf("=");return v===-1&&(v=w),[v,v===w?0:4-v%4]}function N(x,w,v){for(var P,_,U=[],I=w;I<v;I+=3)P=(x[I]<<16&16711680)+(x[I+1]<<8&65280)+(255&x[I+2]),U.push(o[(_=P)>>18&63]+o[_>>12&63]+o[_>>6&63]+o[63&_]);return U.join("")}f["-".charCodeAt(0)]=62,f["_".charCodeAt(0)]=63},function(r,a){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */a.read=function(s,o,f,d,g){var b,A,y=8*g-d-1,N=(1<<y)-1,x=N>>1,w=-7,v=f?g-1:0,P=f?-1:1,_=s[o+v];for(v+=P,b=_&(1<<-w)-1,_>>=-w,w+=y;w>0;b=256*b+s[o+v],v+=P,w-=8);for(A=b&(1<<-w)-1,b>>=-w,w+=d;w>0;A=256*A+s[o+v],v+=P,w-=8);if(b===0)b=1-x;else{if(b===N)return A?NaN:1/0*(_?-1:1);A+=Math.pow(2,d),b-=x}return(_?-1:1)*A*Math.pow(2,b-d)},a.write=function(s,o,f,d,g,b){var A,y,N,x=8*b-g-1,w=(1<<x)-1,v=w>>1,P=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,_=d?0:b-1,U=d?1:-1,I=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(y=isNaN(o)?1:0,A=w):(A=Math.floor(Math.log(o)/Math.LN2),o*(N=Math.pow(2,-A))<1&&(A--,N*=2),(o+=A+v>=1?P/N:P*Math.pow(2,1-v))*N>=2&&(A++,N/=2),A+v>=w?(y=0,A=w):A+v>=1?(y=(o*N-1)*Math.pow(2,g),A+=v):(y=o*Math.pow(2,v-1)*Math.pow(2,g),A=0));g>=8;s[f+_]=255&y,_+=U,y/=256,g-=8);for(A=A<<g|y,x+=g;x>0;s[f+_]=255&A,_+=U,A/=256,x-=8);s[f+_-U]|=128*I}},function(r,a){var s={}.toString;r.exports=Array.isArray||function(o){return s.call(o)=="[object Array]"}},function(r,a,s){var o,f,d;f=[],(d=typeof(o=function(){var g,b,A,y;Object.keys||(Object.keys=(g=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),y=(A=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(u){if(typeof u!="object"&&typeof u!="function"||u===null)throw new TypeError("Object.keys called on non-object");var l=[];for(var S in u)g.call(u,S)&&l.push(S);if(b)for(var R=0;R<y;R++)g.call(u,A[R])&&l.push(A[R]);return l})),Object.create||(Object.create=function(){function u(){}return function(l){if(arguments.length!==1)throw new Error("Object.create implementation only accepts one parameter.");return u.prototype=l,new u}}()),Array.isArray||(Array.isArray=function(u){return Object.prototype.toString.call(u)==="[object Array]"}),Array.prototype.indexOf||(Array.prototype.indexOf=function(u){if(this===null)throw new TypeError;var l=Object(this),S=l.length>>>0;if(S===0)return-1;var R=0;if(arguments.length>1&&((R=Number(arguments[1]))!=R?R=0:R!==0&&R!==1/0&&R!==-1/0&&(R=(R>0||-1)*Math.floor(Math.abs(R)))),R>=S)return-1;for(var F=R>=0?R:Math.max(S-Math.abs(R),0);F<S;F++)if(F in l&&l[F]===u)return F;return-1}),Object.isFrozen||(Object.isFrozen=function(u){for(var l="tv4_test_frozen_key";u.hasOwnProperty(l);)l+=Math.random();try{return u[l]=!0,delete u[l],!1}catch{return!0}});var N={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},x={"*":!0};function w(u){return encodeURI(u).replace(/%25[0-9][0-9]/g,function(l){return"%"+l.substring(3)})}function v(u){var l="";N[u.charAt(0)]&&(l=u.charAt(0),u=u.substring(1));var S="",R="",F=!0,H=!1,G=!1;l==="+"?F=!1:l==="."?(R=".",S="."):l==="/"?(R="/",S="/"):l==="#"?(R="#",F=!1):l===";"?(R=";",S=";",H=!0,G=!0):l==="?"?(R="?",S="&",H=!0):l==="&"&&(R="&",S="&",H=!0);for(var W=[],Y=u.split(","),Z=[],it={},rt=0;rt<Y.length;rt++){var K=Y[rt],i=null;if(K.indexOf(":")!==-1){var c=K.split(":");K=c[0],i=parseInt(c[1],10)}for(var m={};x[K.charAt(K.length-1)];)m[K.charAt(K.length-1)]=!0,K=K.substring(0,K.length-1);var j={truncate:i,name:K,suffices:m};Z.push(j),it[K]=j,W.push(K)}var M=function(L){for(var z="",X=0,nt=0;nt<Z.length;nt++){var tt=Z[nt],V=L(tt.name);if(V==null||Array.isArray(V)&&V.length===0||typeof V=="object"&&Object.keys(V).length===0)X++;else if(z+=nt===X?R:S||",",Array.isArray(V)){H&&(z+=tt.name+"=");for(var lt=0;lt<V.length;lt++)lt>0&&(z+=tt.suffices["*"]&&S||",",tt.suffices["*"]&&H&&(z+=tt.name+"=")),z+=F?encodeURIComponent(V[lt]).replace(/!/g,"%21"):w(V[lt])}else if(typeof V=="object"){H&&!tt.suffices["*"]&&(z+=tt.name+"=");var pt=!0;for(var yt in V)pt||(z+=tt.suffices["*"]&&S||","),pt=!1,z+=F?encodeURIComponent(yt).replace(/!/g,"%21"):w(yt),z+=tt.suffices["*"]?"=":",",z+=F?encodeURIComponent(V[yt]).replace(/!/g,"%21"):w(V[yt])}else H&&(z+=tt.name,G&&V===""||(z+="=")),tt.truncate!=null&&(V=V.substring(0,tt.truncate)),z+=F?encodeURIComponent(V).replace(/!/g,"%21"):w(V)}return z};return M.varNames=W,{prefix:R,substitution:M}}function P(u){if(!(this instanceof P))return new P(u);for(var l=u.split("{"),S=[l.shift()],R=[],F=[],H=[];l.length>0;){var G=l.shift(),W=G.split("}")[0],Y=G.substring(W.length+1),Z=v(W);F.push(Z.substitution),R.push(Z.prefix),S.push(Y),H=H.concat(Z.substitution.varNames)}this.fill=function(it){for(var rt=S[0],K=0;K<F.length;K++)rt+=(0,F[K])(it),rt+=S[K+1];return rt},this.varNames=H,this.template=u}P.prototype={toString:function(){return this.template},fillFromObject:function(u){return this.fill(function(l){return u[l]})}};var _=function(u,l,S,R,F){if(this.missing=[],this.missingMap={},this.formatValidators=u?Object.create(u.formatValidators):{},this.schemas=u?Object.create(u.schemas):{},this.collectMultiple=l,this.errors=[],this.handleError=l?this.collectError:this.returnError,R&&(this.checkRecursive=!0,this.scanned=[],this.scannedFrozen=[],this.scannedFrozenSchemas=[],this.scannedFrozenValidationErrors=[],this.validatedSchemasKey="tv4_validation_id",this.validationErrorsKey="tv4_validation_errors_id"),F&&(this.trackUnknownProperties=!0,this.knownPropertyPaths={},this.unknownPropertyPaths={}),this.errorReporter=S||T("en"),typeof this.errorReporter=="string")throw new Error("debug");if(this.definedKeywords={},u)for(var H in u.definedKeywords)this.definedKeywords[H]=u.definedKeywords[H].slice(0)};function U(u,l){if(u===l)return!0;if(u&&l&&typeof u=="object"&&typeof l=="object"){if(Array.isArray(u)!==Array.isArray(l))return!1;if(Array.isArray(u)){if(u.length!==l.length)return!1;for(var S=0;S<u.length;S++)if(!U(u[S],l[S]))return!1}else{var R;for(R in u)if(l[R]===void 0&&u[R]!==void 0)return!1;for(R in l)if(u[R]===void 0&&l[R]!==void 0)return!1;for(R in u)if(!U(u[R],l[R]))return!1}return!0}return!1}_.prototype.defineKeyword=function(u,l){this.definedKeywords[u]=this.definedKeywords[u]||[],this.definedKeywords[u].push(l)},_.prototype.createError=function(u,l,S,R,F,H,G){var W=new B(u,l,S,R,F);return W.message=this.errorReporter(W,H,G),W},_.prototype.returnError=function(u){return u},_.prototype.collectError=function(u){return u&&this.errors.push(u),null},_.prototype.prefixErrors=function(u,l,S){for(var R=u;R<this.errors.length;R++)this.errors[R]=this.errors[R].prefixWith(l,S);return this},_.prototype.banUnknownProperties=function(u,l){for(var S in this.unknownPropertyPaths){var R=this.createError(E.UNKNOWN_PROPERTY,{path:S},S,"",null,u,l),F=this.handleError(R);if(F)return F}return null},_.prototype.addFormat=function(u,l){if(typeof u=="object"){for(var S in u)this.addFormat(S,u[S]);return this}this.formatValidators[u]=l},_.prototype.resolveRefs=function(u,l){if(u.$ref!==void 0){if((l=l||{})[u.$ref])return this.createError(E.CIRCULAR_REFERENCE,{urls:Object.keys(l).join(", ")},"","",null,void 0,u);l[u.$ref]=!0,u=this.getSchema(u.$ref,l)}return u},_.prototype.getSchema=function(u,l){var S;if(this.schemas[u]!==void 0)return S=this.schemas[u],this.resolveRefs(S,l);var R=u,F="";if(u.indexOf("#")!==-1&&(F=u.substring(u.indexOf("#")+1),R=u.substring(0,u.indexOf("#"))),typeof this.schemas[R]=="object"){S=this.schemas[R];var H=decodeURIComponent(F);if(H==="")return this.resolveRefs(S,l);if(H.charAt(0)!=="/")return;for(var G=H.split("/").slice(1),W=0;W<G.length;W++){var Y=G[W].replace(/~1/g,"/").replace(/~0/g,"~");if(S[Y]===void 0){S=void 0;break}S=S[Y]}if(S!==void 0)return this.resolveRefs(S,l)}this.missing[R]===void 0&&(this.missing.push(R),this.missing[R]=R,this.missingMap[R]=R)},_.prototype.searchSchemas=function(u,l){if(Array.isArray(u))for(var S=0;S<u.length;S++)this.searchSchemas(u[S],l);else if(u&&typeof u=="object"){for(var R in typeof u.id=="string"&&function(H,G){if(G.substring(0,H.length)===H){var W=G.substring(H.length);if(G.length>0&&G.charAt(H.length-1)==="/"||W.charAt(0)==="#"||W.charAt(0)==="?")return!0}return!1}(l,u.id)&&this.schemas[u.id]===void 0&&(this.schemas[u.id]=u),u)if(R!=="enum"){if(typeof u[R]=="object")this.searchSchemas(u[R],l);else if(R==="$ref"){var F=p(u[R]);F&&this.schemas[F]===void 0&&this.missingMap[F]===void 0&&(this.missingMap[F]=F)}}}},_.prototype.addSchema=function(u,l){if(typeof u!="string"||l===void 0){if(typeof u!="object"||typeof u.id!="string")return;u=(l=u).id}u===p(u)+"#"&&(u=p(u)),this.schemas[u]=l,delete this.missingMap[u],h(l,u),this.searchSchemas(l,u)},_.prototype.getSchemaMap=function(){var u={};for(var l in this.schemas)u[l]=this.schemas[l];return u},_.prototype.getSchemaUris=function(u){var l=[];for(var S in this.schemas)u&&!u.test(S)||l.push(S);return l},_.prototype.getMissingUris=function(u){var l=[];for(var S in this.missingMap)u&&!u.test(S)||l.push(S);return l},_.prototype.dropSchemas=function(){this.schemas={},this.reset()},_.prototype.reset=function(){this.missing=[],this.missingMap={},this.errors=[]},_.prototype.validateAll=function(u,l,S,R,F){var H;if(!(l=this.resolveRefs(l)))return null;if(l instanceof B)return this.errors.push(l),l;var G,W=this.errors.length,Y=null,Z=null;if(this.checkRecursive&&u&&typeof u=="object"){if(H=!this.scanned.length,u[this.validatedSchemasKey]){var it=u[this.validatedSchemasKey].indexOf(l);if(it!==-1)return this.errors=this.errors.concat(u[this.validationErrorsKey][it]),null}if(Object.isFrozen(u)&&(G=this.scannedFrozen.indexOf(u))!==-1){var rt=this.scannedFrozenSchemas[G].indexOf(l);if(rt!==-1)return this.errors=this.errors.concat(this.scannedFrozenValidationErrors[G][rt]),null}if(this.scanned.push(u),Object.isFrozen(u))G===-1&&(G=this.scannedFrozen.length,this.scannedFrozen.push(u),this.scannedFrozenSchemas.push([])),Y=this.scannedFrozenSchemas[G].length,this.scannedFrozenSchemas[G][Y]=l,this.scannedFrozenValidationErrors[G][Y]=[];else{if(!u[this.validatedSchemasKey])try{Object.defineProperty(u,this.validatedSchemasKey,{value:[],configurable:!0}),Object.defineProperty(u,this.validationErrorsKey,{value:[],configurable:!0})}catch{u[this.validatedSchemasKey]=[],u[this.validationErrorsKey]=[]}Z=u[this.validatedSchemasKey].length,u[this.validatedSchemasKey][Z]=l,u[this.validationErrorsKey][Z]=[]}}var K=this.errors.length,i=this.validateBasic(u,l,F)||this.validateNumeric(u,l,F)||this.validateString(u,l,F)||this.validateArray(u,l,F)||this.validateObject(u,l,F)||this.validateCombinations(u,l,F)||this.validateHypermedia(u,l,F)||this.validateFormat(u,l,F)||this.validateDefinedKeywords(u,l,F)||null;if(H){for(;this.scanned.length;)delete this.scanned.pop()[this.validatedSchemasKey];this.scannedFrozen=[],this.scannedFrozenSchemas=[]}if(i||K!==this.errors.length)for(;S&&S.length||R&&R.length;){var c=S&&S.length?""+S.pop():null,m=R&&R.length?""+R.pop():null;i&&(i=i.prefixWith(c,m)),this.prefixErrors(K,c,m)}return Y!==null?this.scannedFrozenValidationErrors[G][Y]=this.errors.slice(W):Z!==null&&(u[this.validationErrorsKey][Z]=this.errors.slice(W)),this.handleError(i)},_.prototype.validateFormat=function(u,l){if(typeof l.format!="string"||!this.formatValidators[l.format])return null;var S=this.formatValidators[l.format].call(null,u,l);return typeof S=="string"||typeof S=="number"?this.createError(E.FORMAT_CUSTOM,{message:S},"","/format",null,u,l):S&&typeof S=="object"?this.createError(E.FORMAT_CUSTOM,{message:S.message||"?"},S.dataPath||"",S.schemaPath||"/format",null,u,l):null},_.prototype.validateDefinedKeywords=function(u,l,S){for(var R in this.definedKeywords)if(l[R]!==void 0)for(var F=this.definedKeywords[R],H=0;H<F.length;H++){var G=(0,F[H])(u,l[R],l,S);if(typeof G=="string"||typeof G=="number")return this.createError(E.KEYWORD_CUSTOM,{key:R,message:G},"","",null,u,l).prefixWith(null,R);if(G&&typeof G=="object"){var W=G.code;if(typeof W=="string"){if(!E[W])throw new Error("Undefined error code (use defineError): "+W);W=E[W]}else typeof W!="number"&&(W=E.KEYWORD_CUSTOM);var Y=typeof G.message=="object"?G.message:{key:R,message:G.message||"?"},Z=G.schemaPath||"/"+R.replace(/~/g,"~0").replace(/\//g,"~1");return this.createError(W,Y,G.dataPath||null,Z,null,u,l)}}return null},_.prototype.validateBasic=function(u,l,S){var R;return(R=this.validateType(u,l,S))||(R=this.validateEnum(u,l,S))?R.prefixWith(null,"type"):null},_.prototype.validateType=function(u,l){if(l.type===void 0)return null;var S=typeof u;u===null?S="null":Array.isArray(u)&&(S="array");var R=l.type;Array.isArray(R)||(R=[R]);for(var F=0;F<R.length;F++){var H=R[F];if(H===S||H==="integer"&&S==="number"&&u%1==0)return null}return this.createError(E.INVALID_TYPE,{type:S,expected:R.join("/")},"","",null,u,l)},_.prototype.validateEnum=function(u,l){if(l.enum===void 0)return null;for(var S=0;S<l.enum.length;S++)if(U(u,l.enum[S]))return null;return this.createError(E.ENUM_MISMATCH,{value:typeof JSON!="undefined"?JSON.stringify(u):u},"","",null,u,l)},_.prototype.validateNumeric=function(u,l,S){return this.validateMultipleOf(u,l,S)||this.validateMinMax(u,l,S)||this.validateNaN(u,l,S)||null};var I=Math.pow(2,-51),$=1-I;function C(u){var l=String(u).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return l?{href:l[0]||"",protocol:l[1]||"",authority:l[2]||"",host:l[3]||"",hostname:l[4]||"",port:l[5]||"",pathname:l[6]||"",search:l[7]||"",hash:l[8]||""}:null}function n(u,l){return l=C(l||""),u=C(u||""),l&&u?(l.protocol||u.protocol)+(l.protocol||l.authority?l.authority:u.authority)+(S=l.protocol||l.authority||l.pathname.charAt(0)==="/"?l.pathname:l.pathname?(u.authority&&!u.pathname?"/":"")+u.pathname.slice(0,u.pathname.lastIndexOf("/")+1)+l.pathname:u.pathname,R=[],S.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(F){F==="/.."?R.pop():R.push(F)}),R.join("").replace(/^\//,S.charAt(0)==="/"?"/":""))+(l.protocol||l.authority||l.pathname?l.search:l.search||u.search)+l.hash:null;var S,R}function p(u){return u.split("#")[0]}function h(u,l){if(u&&typeof u=="object")if(l===void 0?l=u.id:typeof u.id=="string"&&(l=n(l,u.id),u.id=l),Array.isArray(u))for(var S=0;S<u.length;S++)h(u[S],l);else for(var R in typeof u.$ref=="string"&&(u.$ref=n(l,u.$ref)),u)R!=="enum"&&h(u[R],l)}function T(u){var l=k[u=u||"en"];return function(S){var R=l[S.code]||J[S.code];if(typeof R!="string")return"Unknown error code "+S.code+": "+JSON.stringify(S.messageParams);var F=S.params;return R.replace(/\{([^{}]*)\}/g,function(H,G){var W=F[G];return typeof W=="string"||typeof W=="number"?W:H})}}_.prototype.validateMultipleOf=function(u,l){var S=l.multipleOf||l.divisibleBy;if(S===void 0)return null;if(typeof u=="number"){var R=u/S%1;if(R>=I&&R<$)return this.createError(E.NUMBER_MULTIPLE_OF,{value:u,multipleOf:S},"","",null,u,l)}return null},_.prototype.validateMinMax=function(u,l){if(typeof u!="number")return null;if(l.minimum!==void 0){if(u<l.minimum)return this.createError(E.NUMBER_MINIMUM,{value:u,minimum:l.minimum},"","/minimum",null,u,l);if(l.exclusiveMinimum&&u===l.minimum)return this.createError(E.NUMBER_MINIMUM_EXCLUSIVE,{value:u,minimum:l.minimum},"","/exclusiveMinimum",null,u,l)}if(l.maximum!==void 0){if(u>l.maximum)return this.createError(E.NUMBER_MAXIMUM,{value:u,maximum:l.maximum},"","/maximum",null,u,l);if(l.exclusiveMaximum&&u===l.maximum)return this.createError(E.NUMBER_MAXIMUM_EXCLUSIVE,{value:u,maximum:l.maximum},"","/exclusiveMaximum",null,u,l)}return null},_.prototype.validateNaN=function(u,l){return typeof u!="number"?null:isNaN(u)===!0||u===1/0||u===-1/0?this.createError(E.NUMBER_NOT_A_NUMBER,{value:u},"","/type",null,u,l):null},_.prototype.validateString=function(u,l,S){return this.validateStringLength(u,l,S)||this.validateStringPattern(u,l,S)||null},_.prototype.validateStringLength=function(u,l){return typeof u!="string"?null:l.minLength!==void 0&&u.length<l.minLength?this.createError(E.STRING_LENGTH_SHORT,{length:u.length,minimum:l.minLength},"","/minLength",null,u,l):l.maxLength!==void 0&&u.length>l.maxLength?this.createError(E.STRING_LENGTH_LONG,{length:u.length,maximum:l.maxLength},"","/maxLength",null,u,l):null},_.prototype.validateStringPattern=function(u,l){if(typeof u!="string"||typeof l.pattern!="string"&&!(l.pattern instanceof RegExp))return null;var S;if(l.pattern instanceof RegExp)S=l.pattern;else{var R,F="",H=l.pattern.match(/^\/(.+)\/([img]*)$/);H?(R=H[1],F=H[2]):R=l.pattern,S=new RegExp(R,F)}return S.test(u)?null:this.createError(E.STRING_PATTERN,{pattern:l.pattern},"","/pattern",null,u,l)},_.prototype.validateArray=function(u,l,S){return Array.isArray(u)&&(this.validateArrayLength(u,l,S)||this.validateArrayUniqueItems(u,l,S)||this.validateArrayItems(u,l,S))||null},_.prototype.validateArrayLength=function(u,l){var S;return l.minItems!==void 0&&u.length<l.minItems&&(S=this.createError(E.ARRAY_LENGTH_SHORT,{length:u.length,minimum:l.minItems},"","/minItems",null,u,l),this.handleError(S))||l.maxItems!==void 0&&u.length>l.maxItems&&(S=this.createError(E.ARRAY_LENGTH_LONG,{length:u.length,maximum:l.maxItems},"","/maxItems",null,u,l),this.handleError(S))?S:null},_.prototype.validateArrayUniqueItems=function(u,l){if(l.uniqueItems){for(var S=0;S<u.length;S++)for(var R=S+1;R<u.length;R++)if(U(u[S],u[R])){var F=this.createError(E.ARRAY_UNIQUE,{match1:S,match2:R},"","/uniqueItems",null,u,l);if(this.handleError(F))return F}}return null},_.prototype.validateArrayItems=function(u,l,S){if(l.items===void 0)return null;var R,F;if(Array.isArray(l.items)){for(F=0;F<u.length;F++)if(F<l.items.length){if(R=this.validateAll(u[F],l.items[F],[F],["items",F],S+"/"+F))return R}else if(l.additionalItems!==void 0){if(typeof l.additionalItems=="boolean"){if(!l.additionalItems&&(R=this.createError(E.ARRAY_ADDITIONAL_ITEMS,{},"/"+F,"/additionalItems",null,u,l),this.handleError(R)))return R}else if(R=this.validateAll(u[F],l.additionalItems,[F],["additionalItems"],S+"/"+F))return R}}else for(F=0;F<u.length;F++)if(R=this.validateAll(u[F],l.items,[F],["items"],S+"/"+F))return R;return null},_.prototype.validateObject=function(u,l,S){return typeof u!="object"||u===null||Array.isArray(u)?null:this.validateObjectMinMaxProperties(u,l,S)||this.validateObjectRequiredProperties(u,l,S)||this.validateObjectProperties(u,l,S)||this.validateObjectDependencies(u,l,S)||null},_.prototype.validateObjectMinMaxProperties=function(u,l){var S,R=Object.keys(u);return l.minProperties!==void 0&&R.length<l.minProperties&&(S=this.createError(E.OBJECT_PROPERTIES_MINIMUM,{propertyCount:R.length,minimum:l.minProperties},"","/minProperties",null,u,l),this.handleError(S))||l.maxProperties!==void 0&&R.length>l.maxProperties&&(S=this.createError(E.OBJECT_PROPERTIES_MAXIMUM,{propertyCount:R.length,maximum:l.maxProperties},"","/maxProperties",null,u,l),this.handleError(S))?S:null},_.prototype.validateObjectRequiredProperties=function(u,l){if(l.required!==void 0)for(var S=0;S<l.required.length;S++){var R=l.required[S];if(u[R]===void 0){var F=this.createError(E.OBJECT_REQUIRED,{key:R},"","/required/"+S,null,u,l);if(this.handleError(F))return F}}return null},_.prototype.validateObjectProperties=function(u,l,S){var R;for(var F in u){var H=S+"/"+F.replace(/~/g,"~0").replace(/\//g,"~1"),G=!1;if(l.properties!==void 0&&l.properties[F]!==void 0&&(G=!0,R=this.validateAll(u[F],l.properties[F],[F],["properties",F],H)))return R;if(l.patternProperties!==void 0){for(var W in l.patternProperties)if(new RegExp(W).test(F)&&(G=!0,R=this.validateAll(u[F],l.patternProperties[W],[F],["patternProperties",W],H)))return R}if(G)this.trackUnknownProperties&&(this.knownPropertyPaths[H]=!0,delete this.unknownPropertyPaths[H]);else if(l.additionalProperties!==void 0){if(this.trackUnknownProperties&&(this.knownPropertyPaths[H]=!0,delete this.unknownPropertyPaths[H]),typeof l.additionalProperties=="boolean"){if(!l.additionalProperties&&(R=this.createError(E.OBJECT_ADDITIONAL_PROPERTIES,{key:F},"","/additionalProperties",null,u,l).prefixWith(F,null),this.handleError(R)))return R}else if(R=this.validateAll(u[F],l.additionalProperties,[F],["additionalProperties"],H))return R}else this.trackUnknownProperties&&!this.knownPropertyPaths[H]&&(this.unknownPropertyPaths[H]=!0)}return null},_.prototype.validateObjectDependencies=function(u,l,S){var R;if(l.dependencies!==void 0){for(var F in l.dependencies)if(u[F]!==void 0){var H=l.dependencies[F];if(typeof H=="string"){if(u[H]===void 0&&(R=this.createError(E.OBJECT_DEPENDENCY_KEY,{key:F,missing:H},"","",null,u,l).prefixWith(null,F).prefixWith(null,"dependencies"),this.handleError(R)))return R}else if(Array.isArray(H))for(var G=0;G<H.length;G++){var W=H[G];if(u[W]===void 0&&(R=this.createError(E.OBJECT_DEPENDENCY_KEY,{key:F,missing:W},"","/"+G,null,u,l).prefixWith(null,F).prefixWith(null,"dependencies"),this.handleError(R)))return R}else if(R=this.validateAll(u,H,[],["dependencies",F],S))return R}}return null},_.prototype.validateCombinations=function(u,l,S){return this.validateAllOf(u,l,S)||this.validateAnyOf(u,l,S)||this.validateOneOf(u,l,S)||this.validateNot(u,l,S)||null},_.prototype.validateAllOf=function(u,l,S){if(l.allOf===void 0)return null;for(var R,F=0;F<l.allOf.length;F++){var H=l.allOf[F];if(R=this.validateAll(u,H,[],["allOf",F],S))return R}return null},_.prototype.validateAnyOf=function(u,l,S){if(l.anyOf===void 0)return null;var R,F,H=[],G=this.errors.length;this.trackUnknownProperties&&(R=this.unknownPropertyPaths,F=this.knownPropertyPaths);for(var W=!0,Y=0;Y<l.anyOf.length;Y++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var Z=l.anyOf[Y],it=this.errors.length,rt=this.validateAll(u,Z,[],["anyOf",Y],S);if(rt===null&&it===this.errors.length){if(this.errors=this.errors.slice(0,G),this.trackUnknownProperties){for(var K in this.knownPropertyPaths)F[K]=!0,delete R[K];for(var i in this.unknownPropertyPaths)F[i]||(R[i]=!0);W=!1;continue}return null}rt&&H.push(rt.prefixWith(null,""+Y).prefixWith(null,"anyOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=R,this.knownPropertyPaths=F),W?(H=H.concat(this.errors.slice(G)),this.errors=this.errors.slice(0,G),this.createError(E.ANY_OF_MISSING,{},"","/anyOf",H,u,l)):void 0},_.prototype.validateOneOf=function(u,l,S){if(l.oneOf===void 0)return null;var R,F,H=null,G=[],W=this.errors.length;this.trackUnknownProperties&&(R=this.unknownPropertyPaths,F=this.knownPropertyPaths);for(var Y=0;Y<l.oneOf.length;Y++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var Z=l.oneOf[Y],it=this.errors.length,rt=this.validateAll(u,Z,[],["oneOf",Y],S);if(rt===null&&it===this.errors.length){if(H!==null)return this.errors=this.errors.slice(0,W),this.createError(E.ONE_OF_MULTIPLE,{index1:H,index2:Y},"","/oneOf",null,u,l);if(H=Y,this.trackUnknownProperties){for(var K in this.knownPropertyPaths)F[K]=!0,delete R[K];for(var i in this.unknownPropertyPaths)F[i]||(R[i]=!0)}}else rt&&G.push(rt)}return this.trackUnknownProperties&&(this.unknownPropertyPaths=R,this.knownPropertyPaths=F),H===null?(G=G.concat(this.errors.slice(W)),this.errors=this.errors.slice(0,W),this.createError(E.ONE_OF_MISSING,{},"","/oneOf",G,u,l)):(this.errors=this.errors.slice(0,W),null)},_.prototype.validateNot=function(u,l,S){if(l.not===void 0)return null;var R,F,H=this.errors.length;this.trackUnknownProperties&&(R=this.unknownPropertyPaths,F=this.knownPropertyPaths,this.unknownPropertyPaths={},this.knownPropertyPaths={});var G=this.validateAll(u,l.not,null,null,S),W=this.errors.slice(H);return this.errors=this.errors.slice(0,H),this.trackUnknownProperties&&(this.unknownPropertyPaths=R,this.knownPropertyPaths=F),G===null&&W.length===0?this.createError(E.NOT_PASSED,{},"","/not",null,u,l):null},_.prototype.validateHypermedia=function(u,l,S){if(!l.links)return null;for(var R,F=0;F<l.links.length;F++){var H=l.links[F];if(H.rel==="describedby"){for(var G=new P(H.href),W=!0,Y=0;Y<G.varNames.length;Y++)if(!(G.varNames[Y]in u)){W=!1;break}if(W){var Z={$ref:G.fillFromObject(u)};if(R=this.validateAll(u,Z,[],["links",F],S))return R}}}};var E={INVALID_TYPE:0,ENUM_MISMATCH:1,ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,NUMBER_NOT_A_NUMBER:105,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403,FORMAT_CUSTOM:500,KEYWORD_CUSTOM:501,CIRCULAR_REFERENCE:600,UNKNOWN_PROPERTY:1e3},O={};for(var q in E)O[E[q]]=q;var J={INVALID_TYPE:"Invalid type: {type} (expected {expected})",ENUM_MISMATCH:"No enum match for: {value}",ANY_OF_MISSING:'Data does not match any schemas from "anyOf"',ONE_OF_MISSING:'Data does not match any schemas from "oneOf"',ONE_OF_MULTIPLE:'Data is valid against more than one schema from "oneOf": indices {index1} and {index2}',NOT_PASSED:'Data matches schema from "not"',NUMBER_MULTIPLE_OF:"Value {value} is not a multiple of {multipleOf}",NUMBER_MINIMUM:"Value {value} is less than minimum {minimum}",NUMBER_MINIMUM_EXCLUSIVE:"Value {value} is equal to exclusive minimum {minimum}",NUMBER_MAXIMUM:"Value {value} is greater than maximum {maximum}",NUMBER_MAXIMUM_EXCLUSIVE:"Value {value} is equal to exclusive maximum {maximum}",NUMBER_NOT_A_NUMBER:"Value {value} is not a valid number",STRING_LENGTH_SHORT:"String is too short ({length} chars), minimum {minimum}",STRING_LENGTH_LONG:"String is too long ({length} chars), maximum {maximum}",STRING_PATTERN:"String does not match pattern: {pattern}",OBJECT_PROPERTIES_MINIMUM:"Too few properties defined ({propertyCount}), minimum {minimum}",OBJECT_PROPERTIES_MAXIMUM:"Too many properties defined ({propertyCount}), maximum {maximum}",OBJECT_REQUIRED:"Missing required property: {key}",OBJECT_ADDITIONAL_PROPERTIES:"Additional properties not allowed",OBJECT_DEPENDENCY_KEY:"Dependency failed - key must exist: {missing} (due to key: {key})",ARRAY_LENGTH_SHORT:"Array is too short ({length}), minimum {minimum}",ARRAY_LENGTH_LONG:"Array is too long ({length}), maximum {maximum}",ARRAY_UNIQUE:"Array items are not unique (indices {match1} and {match2})",ARRAY_ADDITIONAL_ITEMS:"Additional items not allowed",FORMAT_CUSTOM:"Format validation failed ({message})",KEYWORD_CUSTOM:"Keyword failed: {key} ({message})",CIRCULAR_REFERENCE:"Circular $refs: {urls}",UNKNOWN_PROPERTY:"Unknown property (not in schema)"};function B(u,l,S,R,F){if(Error.call(this),u===void 0)throw new Error("No error code supplied: "+R);this.message="",this.params=l,this.code=u,this.dataPath=S||"",this.schemaPath=R||"",this.subErrors=F||null;var H=new Error(this.message);if(this.stack=H.stack||H.stacktrace,!this.stack)try{throw H}catch(G){this.stack=G.stack||G.stacktrace}}B.prototype=Object.create(Error.prototype),B.prototype.constructor=B,B.prototype.name="ValidationError",B.prototype.prefixWith=function(u,l){if(u!==null&&(u=u.replace(/~/g,"~0").replace(/\//g,"~1"),this.dataPath="/"+u+this.dataPath),l!==null&&(l=l.replace(/~/g,"~0").replace(/\//g,"~1"),this.schemaPath="/"+l+this.schemaPath),this.subErrors!==null)for(var S=0;S<this.subErrors.length;S++)this.subErrors[S].prefixWith(u,l);return this};var k={},D=function u(l){var S,R,F=new _,H={setErrorReporter:function(G){return typeof G=="string"?this.language(G):(R=G,!0)},addFormat:function(){F.addFormat.apply(F,arguments)},language:function(G){return G?(k[G]||(G=G.split("-")[0]),!!k[G]&&(S=G,G)):S},addLanguage:function(G,W){var Y;for(Y in E)W[Y]&&!W[E[Y]]&&(W[E[Y]]=W[Y]);var Z=G.split("-")[0];if(k[Z])for(Y in k[G]=Object.create(k[Z]),W)k[Z][Y]===void 0&&(k[Z][Y]=W[Y]),k[G][Y]=W[Y];else k[G]=W,k[Z]=W;return this},freshApi:function(G){var W=u();return G&&W.language(G),W},validate:function(G,W,Y,Z){var it=T(S),rt=new _(F,!1,R?function(i,c,m){return R(i,c,m)||it(i,c,m)}:it,Y,Z);typeof W=="string"&&(W={$ref:W}),rt.addSchema("",W);var K=rt.validateAll(G,W,null,null,"");return!K&&Z&&(K=rt.banUnknownProperties(G,W)),this.error=K,this.missing=rt.missing,this.valid=K===null,this.valid},validateResult:function(){var G={toString:function(){return this.valid?"valid":this.error.message}};return this.validate.apply(G,arguments),G},validateMultiple:function(G,W,Y,Z){var it=T(S),rt=new _(F,!0,R?function(i,c,m){return R(i,c,m)||it(i,c,m)}:it,Y,Z);typeof W=="string"&&(W={$ref:W}),rt.addSchema("",W),rt.validateAll(G,W,null,null,""),Z&&rt.banUnknownProperties(G,W);var K={toString:function(){return this.valid?"valid":this.error.message}};return K.errors=rt.errors,K.missing=rt.missing,K.valid=K.errors.length===0,K},addSchema:function(){return F.addSchema.apply(F,arguments)},getSchema:function(){return F.getSchema.apply(F,arguments)},getSchemaMap:function(){return F.getSchemaMap.apply(F,arguments)},getSchemaUris:function(){return F.getSchemaUris.apply(F,arguments)},getMissingUris:function(){return F.getMissingUris.apply(F,arguments)},dropSchemas:function(){F.dropSchemas.apply(F,arguments)},defineKeyword:function(){F.defineKeyword.apply(F,arguments)},defineError:function(G,W,Y){if(typeof G!="string"||!/^[A-Z]+(_[A-Z]+)*$/.test(G))throw new Error("Code name must be a string in UPPER_CASE_WITH_UNDERSCORES");if(typeof W!="number"||W%1!=0||W<1e4)throw new Error("Code number must be an integer > 10000");if(E[G]!==void 0)throw new Error("Error already defined: "+G+" as "+E[G]);if(O[W]!==void 0)throw new Error("Error code already used: "+O[W]+" as "+W);for(var Z in E[G]=W,O[W]=G,J[G]=J[W]=Y,k){var it=k[Z];it[G]&&(it[W]=it[W]||it[G])}},reset:function(){F.reset(),this.error=null,this.missing=[],this.valid=!0},missing:[],error:null,valid:!0,normSchema:h,resolveUrl:n,getDocumentUri:p,errorCodes:E};return H.language(l||"en"),H}();return D.addLanguage("en-gb",J),D.tv4=D,D})=="function"?o.apply(a,f):o)===void 0||(r.exports=d)},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.BaseClientTypes=void 0;class o{constructor(){this.uris={},this.schemas={},this.aliases={}}declare(g,b,A,y){const N=g+"/"+b;if(y.extends){const x=y.extends.split("/"),w=x.length===1?g+"/"+x.shift():x.join("/"),v=this.uris[w];if(!v)throw"Type '"+N+"' tries to extend unknown schema '"+w+"'";y.extends=this.schemas[v]}this.uris[N]=A,this.aliases[A]=N,this.schemas[A]=y}resolveAlias(g){return this.uris[g]}getSchema(g){return this.schemas[g]}inScope(g){const b=g.length,A={};for(const y in this.uris)if(y.substr(0,b+1)===g+"/"){const N=this.uris[y];A[N]=this.schemas[N]}return A}}a.BaseClientTypes=o;const f=new o;a.default=f},function(r,a,s){class o extends Error{constructor(d){super();const g=new Error("Schema not found: "+d);return g.name="SchemaNotFound",g}}r.exports=o},function(r,a,s){r.exports=class{constructor(o){this._itemsRev={},this._storage={},this._canPropagate=!1,this.defaultValue=o,this.activatePropagation()}get(o){o=o.toLowerCase();let f=this._storage[o];return f===void 0&&(f=this.defaultValue,this._storage[o]=f),f}set(o,f){return o=o.toLowerCase(),this._storage[o]===f||(this._storage[o]=f,f||delete this._itemsRev[o],this._updateParentFolderItemRev(o,f),this._canPropagate&&this._propagate(o)),f}delete(o){return this.set(o,null)}deactivatePropagation(){return this._canPropagate=!1,!0}activatePropagation(){return this._canPropagate||(this._generateFolderRev("/"),this._canPropagate=!0),!0}_hashCode(o){let f=0;if(o.length===0)return f;for(let d=0;d<o.length;d++)f=(f<<5)-f+o.charCodeAt(d),f|=0;return f}_generateHash(o){const f=o.sort().join("|");return""+this._hashCode(f)}_updateParentFolderItemRev(o,f){if(o!=="/"){const d=this._getParentFolder(o);this._itemsRev[d]||(this._itemsRev[d]={});const g=this._itemsRev[d];f?g[o]=f:delete g[o],this._updateParentFolderItemRev(d,this.defaultValue)}}_getParentFolder(o){return o.substr(0,o.lastIndexOf("/",o.length-2)+1)}_propagate(o){if(o!=="/"){const f=this._getParentFolder(o),d=this._itemsRev[f],g=[];for(const A in d)g.push(d[A]);const b=this._generateHash(g);this.set(f,b)}}_generateFolderRev(o){const f=this._itemsRev[o];let d=this.defaultValue;if(f){const g=[];for(const b in f){let A;A=b.substr(-1)==="/"?this._generateFolderRev(b):f[b],g.push(A)}g.length>0&&(d=this._generateHash(g))}return this.set(o,d),d}}},function(r,a,s){var o;/*!
 * webfinger.js
 *   version 2.7.0
 *   http://github.com/silverbucket/webfinger.js
 *
 * Developed and Maintained by:
 *   Nick Jennings <nick@silverbucket.net> 2012
 *
 * webfinger.js is released under the AGPL (see LICENSE).
 *
 * You don't have to do anything special to choose one license or the other and you don't
 * have to notify anyone which license you are using.
 * Please see the corresponding license file for details of these licenses.
 * You are free to use, modify and distribute this software, but all copyright
 * information must remain.
 *
 */typeof fetch!="function"&&typeof XMLHttpRequest!="function"&&(XMLHttpRequest=s(28)),function(f){var d={"http://webfist.org/spec/rel":"webfist","http://webfinger.net/rel/avatar":"avatar",remotestorage:"remotestorage","http://tools.ietf.org/id/draft-dejong-remotestorage":"remotestorage",remoteStorage:"remotestorage","http://www.packetizer.com/rel/share":"share","http://webfinger.net/rel/profile-page":"profile",me:"profile",vcard:"vcard",blog:"blog","http://packetizer.com/rel/blog":"blog","http://schemas.google.com/g/2010#updates-from":"updates","https://camlistore.org/rel/server":"camilstore"},g={avatar:[],remotestorage:[],blog:[],vcard:[],updates:[],share:[],profile:[],webfist:[],camlistore:[]},b=["webfinger","host-meta","host-meta.json"];function A(N){return N.toString=function(){return this.message},N}function y(N){typeof N!="object"&&(N={}),this.config={tls_only:N.tls_only===void 0||N.tls_only,webfist_fallback:N.webfist_fallback!==void 0&&N.webfist_fallback,uri_fallback:N.uri_fallback!==void 0&&N.uri_fallback,request_timeout:N.request_timeout!==void 0?N.request_timeout:1e4}}y.prototype.__fetchJRD=function(N,x,w){if(typeof fetch=="function")return this.__fetchJRD_fetch(N,x,w);if(typeof XMLHttpRequest=="function")return this.__fetchJRD_XHR(N,x,w);throw new Error("add a polyfill for fetch or XMLHttpRequest")},y.prototype.__fetchJRD_fetch=function(N,x,w){var v,P=this;typeof AbortController=="function"&&(v=new AbortController);var _=fetch(N,{headers:{Accept:"application/jrd+json, application/json"},signal:v?v.signal:void 0}).then(function(I){if(I.ok)return I.text();throw I.status===404?A({message:"resource not found",url:N,status:I.status}):A({message:"error during request",url:N,status:I.status})},function(I){throw A({message:"error during request",url:N,status:void 0,err:I})}).then(function(I){if(P.__isValidJSON(I))return I;throw A({message:"invalid json",url:N,status:void 0})}),U=new Promise(function(I,$){setTimeout(function(){$(A({message:"request timed out",url:N,status:void 0})),v&&v.abort()},P.config.request_timeout)});Promise.race([_,U]).then(function(I){w(I)}).catch(function(I){x(I)})},y.prototype.__fetchJRD_XHR=function(N,x,w){var v=this,P=!1,_=new XMLHttpRequest;function U(){if(!P){if(P=!0,_.status===200)return v.__isValidJSON(_.responseText)?w(_.responseText):x(A({message:"invalid json",url:N,status:_.status}));if(_.status===404)return x(A({message:"resource not found",url:N,status:_.status}));if(_.status>=301&&_.status<=302){var $=_.getResponseHeader("Location");return function(C){return typeof C=="string"&&C.split("://")[0]==="https"}($)?I():x(A({message:"no redirect URL found",url:N,status:_.status}))}return x(A({message:"error during request",url:N,status:_.status}))}}function I(){_.onreadystatechange=function(){_.readyState===4&&U()},_.onload=function(){U()},_.ontimeout=function(){return x(A({message:"request timed out",url:N,status:_.status}))},_.open("GET",N,!0),_.timeout=v.config.request_timeout,_.setRequestHeader("Accept","application/jrd+json, application/json"),_.send()}return I()},y.prototype.__isValidJSON=function(N){try{JSON.parse(N)}catch{return!1}return!0},y.prototype.__isLocalhost=function(N){return/^localhost(\.localdomain)?(\:[0-9]+)?$/.test(N)},y.prototype.__processJRD=function(N,x,w,v){var P=JSON.parse(x);if(typeof P!="object"||typeof P.links!="object")return P.error!==void 0?w(A({message:P.error,request:N})):w(A({message:"unknown response from server",request:N}));var _=P.links;Array.isArray(_)||(_=[]);var U={object:P,json:x,idx:{}};U.idx.properties={name:void 0},U.idx.links=JSON.parse(JSON.stringify(g)),_.map(function(C,n){if(d.hasOwnProperty(C.rel)&&U.idx.links[d[C.rel]]){var p={};Object.keys(C).map(function(h,T){p[h]=C[h]}),U.idx.links[d[C.rel]].push(p)}});var I=JSON.parse(x).properties;for(var $ in I)I.hasOwnProperty($)&&$==="http://packetizer.com/ns/name"&&(U.idx.properties.name=I[$]);return v(U)},y.prototype.lookup=function(N,x){if(typeof N!="string")throw new Error("first parameter must be a user address");if(typeof x!="function")throw new Error("second parameter must be a callback");var w=this,v="";v=N.indexOf("://")>-1?N.replace(/ /g,"").split("/")[2]:N.replace(/ /g,"").split("@")[1];var P=0,_="https";function U(){var C="";return N.split("://")[1]||(C="acct:"),_+"://"+v+"/.well-known/"+b[P]+"?resource="+C+N}function I(C){if(w.config.uri_fallback&&v!=="webfist.org"&&P!==b.length-1)return P+=1,$();if(!w.config.tls_only&&_==="https")return P=0,_="http",$();if(!w.config.webfist_fallback||v==="webfist.org")return x(C);P=0,_="http",v="webfist.org";var n=U();w.__fetchJRD(n,x,function(p){w.__processJRD(n,p,x,function(h){typeof h.idx.links.webfist=="object"&&typeof h.idx.links.webfist[0].href=="string"&&w.__fetchJRD(h.idx.links.webfist[0].href,x,function(T){w.__processJRD(n,T,x,function(E){return x(null,x)})})})})}function $(){var C=U();w.__fetchJRD(C,I,function(n){w.__processJRD(C,n,x,function(p){x(null,p)})})}return w.__isLocalhost(v)&&(_="http"),setTimeout($,0)},y.prototype.lookupLink=function(N,x,w){if(!g.hasOwnProperty(x))return w("unsupported rel "+x);this.lookup(N,function(v,P){var _=P.idx.links[x];return v?w(v):_.length===0?w('no links found with rel="'+x+'"'):w(null,_[0])})},(o=function(){return y}.apply(a,[]))===void 0||(r.exports=o)}()},function(r,a){r.exports=XMLHttpRequest},function(r,a,s){var o=this&&this.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};const f=o(s(3)),d=o(s(16)),g=o(s(1)),b=s(0),A=o(s(30)),y=o(s(11)),N=o(s(6)),x=o(s(15)),w=o(s(7)),v=o(s(13)),P=o(s(14)),_=o(s(8)),U=o(s(31)),I=o(s(12)),$=o(s(32)),C=o(s(33)),n=o(s(34)),p={features:[],featuresDone:0,readyFired:!1,loadFeatures(){this.features=[],this.featuresDone=0,this.readyFired=!1,this.featureModules={WireClient:_.default,Dropbox:P.default,GoogleDrive:v.default,Access:y.default,Discover:x.default,Authorize:N.default,BaseClient:w.default,Env:d.default},f.default.cache&&b.extend(this.featureModules,{Caching:I.default,IndexedDB:$.default,LocalStorage:C.default,InMemoryStorage:n.default,Sync:U.default}),f.default.disableFeatures.forEach(h=>{this.featureModules[h]&&delete this.featureModules[h]}),this._allLoaded=!1;for(const h in this.featureModules)this.loadFeature(h)},hasFeature(h){for(let T=this.features.length-1;T>=0;T--)if(this.features[T].name===h)return this.features[T].supported;return!1},loadFeature(h){const T=this.featureModules[h],E=!T._rs_supported||T._rs_supported();g.default(`[RemoteStorage] [FEATURE ${h}] initializing ...`),typeof E=="object"?E.then(()=>{this.featureSupported(h,!0),this.initFeature(h)},()=>{this.featureSupported(h,!1)}):typeof E=="boolean"?(this.featureSupported(h,E),E&&this.initFeature(h)):this.featureSupported(h,!1)},initFeature(h){const T=this.featureModules[h];let E;try{E=T._rs_init(this)}catch(O){return void this.featureFailed(h,O)}typeof E=="object"&&typeof E.then=="function"?E.then(()=>{this.featureInitialized(h)},O=>{this.featureFailed(h,O)}):this.featureInitialized(h)},featureFailed(h,T){g.default(`[RemoteStorage] [FEATURE ${h}] initialization failed (${T})`),this.featureDone()},featureSupported(h,T){g.default(`[RemoteStorage] [FEATURE ${h}]${T?"":"not "} supported`),T||this.featureDone()},featureInitialized(h){g.default(`[RemoteStorage] [FEATURE ${h}] initialized`),this.features.push({name:h,init:this.featureModules[h]._rs_init,supported:!0,cleanup:this.featureModules[h]._rs_cleanup}),this.featureDone()},featureDone(){this.featuresDone++,this.featuresDone===Object.keys(this.featureModules).length&&setTimeout(this.featuresLoaded.bind(this),0)},_setCachingModule(){["IndexedDB","LocalStorage","InMemoryStorage"].some(h=>{if(this.features.some(T=>T.name===h))return this.features.local=this.featureModules[h],!0})},_fireReady(){try{this.readyFired||(this._emit("ready"),this.readyFired=!0)}catch(h){console.error("'ready' failed: ",h,h.stack),this._emit("error",h)}},featuresLoaded(){g.default("[RemoteStorage] All features loaded"),this._setCachingModule(),this.local=f.default.cache&&this.features.local&&new this.features.local,this.local&&this.remote?(this._setGPD(A.default,this),this._bindChange(this.local)):this.remote&&this._setGPD(this.remote,this.remote),this.remote&&(this.remote.on("connected",()=>{this._fireReady(),this._emit("connected")}),this.remote.on("not-connected",()=>{this._fireReady(),this._emit("not-connected")}),this.remote.connected&&(this._fireReady(),this._emit("connected")),this.hasFeature("Authorize")||this.remote.stopWaitingForToken()),this._collectCleanupFunctions();try{this._allLoaded=!0,this._emit("features-loaded")}catch(h){b.logError(h),this._emit("error",h)}this._processPending()},_collectCleanupFunctions(){this._cleanups=[];for(let h=0;h<this.features.length;h++){const T=this.features[h].cleanup;typeof T=="function"&&this._cleanups.push(T)}}};r.exports=p},function(r,a,s){var o=this&&this.__awaiter||function(b,A,y,N){return new(y||(y=Promise))(function(x,w){function v(U){try{_(N.next(U))}catch(I){w(I)}}function P(U){try{_(N.throw(U))}catch(I){w(I)}}function _(U){var I;U.done?x(U.value):(I=U.value,I instanceof y?I:new y(function($){$(I)})).then(v,P)}_((N=N.apply(b,A||[])).next())})};const f=(this&&this.__importDefault||function(b){return b&&b.__esModule?b:{default:b}})(s(1));function d(b){return this.backend==="dropbox"&&!!b.match(/^\/public\/.*[^\/]$/)}const g={get:function(b,A){if(this.local){if(A===void 0)A=typeof(y=this).remote=="object"&&y.remote.connected&&y.remote.online?2*y.getSyncInterval():(f.default("Not setting default maxAge, because remote is offline or not connected"),!1);else if(typeof A!="number"&&A!==!1)return Promise.reject("Argument 'maxAge' must be 'false' or a number");return this.local.get(b,A,this.sync.queueGetRequest.bind(this.sync))}return this.remote.get(b);var y},put:function(b,A,y){return d.bind(this)(b)?g._wrapBusyDone.call(this,this.remote.put(b,A,y)):this.local?this.local.put(b,A,y):g._wrapBusyDone.call(this,this.remote.put(b,A,y))},delete:function(b){return this.local?this.local.delete(b):g._wrapBusyDone.call(this,this.remote.delete(b))},_wrapBusyDone:function(b){return o(this,void 0,void 0,function*(){return this._emit("wire-busy"),b.then(A=>(this._emit("wire-done",{success:!0}),Promise.resolve(A)),A=>(this._emit("wire-done",{success:!1}),Promise.reject(A)))})}};r.exports=g},function(r,a,s){var o=this&&this.__awaiter||function(C,n,p,h){return new(p||(p=Promise))(function(T,E){function O(B){try{J(h.next(B))}catch(k){E(k)}}function q(B){try{J(h.throw(B))}catch(k){E(k)}}function J(B){var k;B.done?T(B.value):(k=B.value,k instanceof p?k:new p(function(D){D(k)})).then(O,q)}J((h=h.apply(C,n||[])).next())})},f=this&&this.__importDefault||function(C){return C&&C.__esModule?C:{default:C}};const d=f(s(3)),g=f(s(16)),b=f(s(2)),A=f(s(1)),y=f(s(6)),N=f(s(9)),x=f(s(4)),w=s(0);let v,P;function _(C,n,p){return{action:C,path:n,promise:p}}function U(C,n){return C.common.revision!==n&&(!C.remote||C.remote.revision!==n)}function I(C){return C.common&&C.common.revision}class ${constructor(n){this.rs=n,this._tasks={},this._running={},this._timeStarted={},this.numThreads=10,this.rs.local.onDiff(p=>{this.addTask(p),this.doTasks()}),this.rs.caching.onActivate(p=>{this.addTask(p),this.doTasks()}),this.addEvents(["done","req-done"])}now(){return new Date().getTime()}queueGetRequest(n){return new Promise((p,h)=>{this.rs.remote.connected?this.rs.remote.online?(this.addTask(n,function(){this.rs.local.get(n).then(T=>p(T))}.bind(this)),this.doTasks()):h("cannot fulfill maxAge requirement - remote is not online"):h("cannot fulfill maxAge requirement - remote is not connected")})}corruptServerItemsMap(n,p){if(typeof n!="object"||Array.isArray(n))return!0;for(const h in n){const T=n[h];if(typeof T!="object"||typeof T.ETag!="string")return!0;if(w.isFolder(h)){if(h.substring(0,h.length-1).indexOf("/")!==-1)return!0}else if(h.indexOf("/")!==-1||p&&(typeof T["Content-Type"]!="string"||typeof T["Content-Length"]!="number"))return!0}return!1}corruptItemsMap(n){if(typeof n!="object"||Array.isArray(n))return!0;for(const p in n)if(typeof n[p]!="boolean")return!0;return!1}corruptRevision(n){return typeof n!="object"||Array.isArray(n)||n.revision&&typeof n.revision!="string"||n.body&&typeof n.body!="string"&&typeof n.body!="object"||n.contentType&&typeof n.contentType!="string"||n.contentLength&&typeof n.contentLength!="number"||n.timestamp&&typeof n.timestamp!="number"||n.itemsMap&&this.corruptItemsMap(n.itemsMap)}isCorrupt(n){return typeof n!="object"||Array.isArray(n)||typeof n.path!="string"||this.corruptRevision(n.common)||n.local&&this.corruptRevision(n.local)||n.remote&&this.corruptRevision(n.remote)||n.push&&this.corruptRevision(n.push)}hasTasks(){return Object.getOwnPropertyNames(this._tasks).length>0}collectDiffTasks(){return o(this,void 0,void 0,function*(){let n=0;return this.rs.local.forAllNodes(p=>{n>100||(this.isCorrupt(p)?(A.default("[Sync] WARNING: corrupt node in local cache",p),typeof p=="object"&&p.path&&(this.addTask(p.path),n++)):(this.needsFetch(p)&&this.rs.access.checkPathPermission(p.path,"r")||w.isDocument(p.path)&&this.needsPush(p)&&this.rs.access.checkPathPermission(p.path,"rw"))&&(this.addTask(p.path),n++))}).then(()=>n).catch(p=>{throw p})})}inConflict(n){return n.local&&n.remote&&(n.remote.body!==void 0||n.remote.itemsMap)}needsRefresh(n){return!!n.common&&(!n.common.timestamp||this.now()-n.common.timestamp>d.default.syncInterval)}needsFetch(n){return!!this.inConflict(n)||!(!n.common||n.common.itemsMap!==void 0||n.common.body!==void 0)||!(!n.remote||n.remote.itemsMap!==void 0||n.remote.body!==void 0)}needsPush(n){return!this.inConflict(n)&&(!(!n.local||n.push)||void 0)}needsRemotePut(n){return n.local&&n.local.body}needsRemoteDelete(n){return n.local&&n.local.body===!1}getParentPath(n){const p=n.match(/^(.*\/)([^\/]+\/?)$/);if(p)return p[1];throw new Error('Not a valid path: "'+n+'"')}deleteChildPathsFromTasks(){for(const n in this._tasks){const p=w.pathsFromRoot(n);for(let h=1;h<p.length;h++)this._tasks[p[h]]&&(Array.isArray(this._tasks[n])&&this._tasks[n].length&&Array.prototype.push.apply(this._tasks[p[h]],this._tasks[n]),delete this._tasks[n])}}collectRefreshTasks(){return o(this,void 0,void 0,function*(){return this.rs.local.forAllNodes(n=>{let p;if(this.needsRefresh(n)){try{p=this.getParentPath(n.path)}catch{}p&&this.rs.access.checkPathPermission(p,"r")?this.addTask(p):this.rs.access.checkPathPermission(n.path,"r")&&this.addTask(n.path)}}).then(()=>this.deleteChildPathsFromTasks()).catch(n=>{throw n})})}flush(n){for(const p in n)this.rs.caching.checkPath(p)==="FLUSH"&&n[p]&&!n[p].local&&(A.default("[Sync] Flushing",p),n[p]=void 0);return n}doTask(n){return this.rs.local.getNodes([n]).then(p=>{const h=p[n];return h===void 0||function(T){return T.remote&&T.remote.revision&&!T.remote.itemsMap&&!T.remote.body}(h)?_("get",n,this.rs.remote.get(n)):this.needsRemotePut(h)?(h.push=w.deepClone(h.local),h.push.timestamp=this.now(),this.rs.local.setNodes(this.flush(p)).then(()=>{let T;return T=I(h)?{ifMatch:h.common.revision}:{ifNoneMatch:"*"},_("put",n,this.rs.remote.put(n,h.push.body,h.push.contentType,T))})):this.needsRemoteDelete(h)?(h.push={body:!1,timestamp:this.now()},this.rs.local.setNodes(this.flush(p)).then(()=>I(h)?_("delete",n,this.rs.remote.delete(n,{ifMatch:h.common.revision})):_("get",n,this.rs.remote.get(n)))):I(h)?_("get",n,this.rs.remote.get(n,{ifNoneMatch:h.common.revision})):_("get",n,this.rs.remote.get(n))})}autoMergeFolder(n){if(n.remote.itemsMap&&(n.common=n.remote,delete n.remote,n.common.itemsMap)){for(const p in n.common.itemsMap)n.local.itemsMap[p]||(n.local.itemsMap[p]=!1);w.equal(n.local.itemsMap,n.common.itemsMap)&&delete n.local}return n}autoMergeDocument(n){return function(p){return(!p.remote||!p.remote.revision||p.remote.revision===p.common.revision)&&(p.common.body===void 0&&p.remote.body===!1||p.remote.body===p.common.body&&p.remote.contentType===p.common.contentType)}(n)?delete(n=function(p){return p.remote&&p.remote.body===!1&&p.local&&p.local.body===!1&&delete p.local,p}(n)).remote:n.remote.body!==void 0&&(A.default("[Sync] Emitting keep/revert"),this.rs.local._emitChange({origin:"conflict",path:n.path,oldValue:n.local.body,newValue:n.remote.body,lastCommonValue:n.common.body,oldContentType:n.local.contentType,newContentType:n.remote.contentType,lastCommonContentType:n.common.contentType}),n.remote.body?n.common=n.remote:n.common={},delete n.remote,delete n.local),n}autoMerge(n){if(n.remote){if(n.local)return w.isFolder(n.path)?this.autoMergeFolder(n):this.autoMergeDocument(n);if(w.isFolder(n.path))n.remote.itemsMap!==void 0&&(n.common=n.remote,delete n.remote);else if(n.remote.body!==void 0){const p={origin:"remote",path:n.path,oldValue:n.common.body===!1?void 0:n.common.body,newValue:n.remote.body===!1?void 0:n.remote.body,oldContentType:n.common.contentType,newContentType:n.remote.contentType};if((p.oldValue||p.newValue)&&this.rs.local._emitChange(p),!n.remote.body)return;n.common=n.remote,delete n.remote}return n}n.common.body&&this.rs.local._emitChange({origin:"remote",path:n.path,oldValue:n.common.body,newValue:void 0,oldContentType:n.common.contentType,newContentType:void 0})}updateCommonTimestamp(n,p){return o(this,void 0,void 0,function*(){return this.rs.local.getNodes([n]).then(h=>(h[n]&&h[n].common&&h[n].common.revision===p&&(h[n].common.timestamp=this.now()),this.rs.local.setNodes(this.flush(h))))})}markChildren(n,p,h,T){return o(this,void 0,void 0,function*(){const E=[],O={},q={};for(const J in p)E.push(n+J),O[n+J]=p[J];for(const J in T)E.push(n+J);return this.rs.local.getNodes(E).then(J=>{let B,k;for(const D in J)if(k=J[D],O[D])k&&k.common?U(k,O[D].ETag)&&(h[D]=w.deepClone(k),h[D].remote={revision:O[D].ETag,timestamp:this.now()},h[D]=this.autoMerge(h[D])):(B=this.rs.caching.checkPath(D),B==="ALL"&&(h[D]={path:D,common:{timestamp:this.now()},remote:{revision:O[D].ETag,timestamp:this.now()}})),h[D]&&O[D]["Content-Type"]&&(h[D].remote.contentType=O[D]["Content-Type"]),h[D]&&O[D]["Content-Length"]&&(h[D].remote.contentLength=O[D]["Content-Length"]);else if(T[D.substring(n.length)]&&k&&k.common){if(k.common.itemsMap)for(const u in k.common.itemsMap)q[D+u]=!0;if(k.local&&k.local.itemsMap)for(const u in k.local.itemsMap)q[D+u]=!0;if(k.remote||w.isFolder(D))h[D]=void 0;else if(h[D]=this.autoMerge(k),h[D]===void 0){const u=this.getParentPath(D),l=h[u],S=D.substring(n.length);l&&l.local&&(delete l.local.itemsMap[S],w.equal(l.local.itemsMap,l.common.itemsMap)&&delete l.local)}}return this.deleteRemoteTrees(Object.keys(q),h).then(D=>this.rs.local.setNodes(this.flush(D)))})})}deleteRemoteTrees(n,p){return o(this,void 0,void 0,function*(){return n.length===0?Promise.resolve(p):this.rs.local.getNodes(n).then(h=>o(this,void 0,void 0,function*(){const T={};function E(O,q){if(O&&O.itemsMap)for(const J in O.itemsMap)T[q+J]=!0}for(const O in h){const q=h[O];q&&(w.isFolder(O)?(E(q.common,O),E(q.local,O)):q.common&&typeof q.common.body!==void 0&&(p[O]=w.deepClone(q),p[O].remote={body:!1,timestamp:this.now()},p[O]=this.autoMerge(p[O])))}return this.deleteRemoteTrees(Object.keys(T),p).then(O=>this.rs.local.setNodes(this.flush(O)))}))})}completeFetch(n,p,h,T){return o(this,void 0,void 0,function*(){let E,O;const q=w.pathsFromRoot(n);return w.isFolder(n)?E=[n]:(O=q[1],E=[n,O]),this.rs.local.getNodes(E).then(J=>{let B,k,D=J[n];const u={};function l(S){if(S&&S.itemsMap)for(B in S.itemsMap)p[B]||(u[B]=!0)}if(typeof D=="object"&&D.path===n&&typeof D.common=="object"||(D={path:n,common:{}},J[n]=D),D.remote={revision:T,timestamp:this.now()},w.isFolder(n))for(B in l(D.common),l(D.remote),D.remote.itemsMap={},p)D.remote.itemsMap[B]=!0;else D.remote.body=p,D.remote.contentType=h,k=J[O],k&&k.local&&k.local.itemsMap&&(B=n.substring(O.length),k.local.itemsMap[B]=!0,w.equal(k.local.itemsMap,k.common.itemsMap)&&delete k.local);return J[n]=this.autoMerge(D),{toBeSaved:J,missingChildren:u}})})}completePush(n,p,h,T){return o(this,void 0,void 0,function*(){return this.rs.local.getNodes([n]).then(E=>{const O=E[n];if(!O.push)throw this.stopped=!0,new Error("completePush called but no push version!");return h?(A.default("[Sync] We have a conflict"),O.remote&&O.remote.revision===T||(O.remote={revision:T||"conflict",timestamp:this.now()},delete O.push),E[n]=this.autoMerge(O)):(O.common={revision:T,timestamp:this.now()},p==="put"?(O.common.body=O.push.body,O.common.contentType=O.push.contentType,w.equal(O.local.body,O.push.body)&&O.local.contentType===O.push.contentType&&delete O.local,delete O.push):p==="delete"&&(O.local.body===!1?E[n]=void 0:delete O.push)),this.rs.local.setNodes(this.flush(E))})})}dealWithFailure(n){return o(this,void 0,void 0,function*(){return this.rs.local.getNodes([n]).then(p=>{if(p[n])return delete p[n].push,this.rs.local.setNodes(this.flush(p))})})}interpretStatus(n){const p={statusCode:n,successful:void 0,conflict:void 0,unAuth:void 0,notFound:void 0,changed:void 0,networkProblems:void 0};if(typeof n=="string"&&(n==="offline"||n==="timeout"))return p.successful=!1,p.networkProblems=!0,p;if(typeof n=="number"){const h=Math.floor(n/100);return p.successful=h===2||n===304||n===412||n===404,p.conflict=n===412,p.unAuth=n===401&&this.rs.remote.token!==y.default.IMPLIED_FAKE_TOKEN||n===402||n===403,p.notFound=n===404,p.changed=n!==304,p}}handleGetResponse(n,p,h,T,E){return o(this,void 0,void 0,function*(){return p.notFound&&(h=!!w.isFolder(n)&&{}),p.changed?this.completeFetch(n,h,T,E).then(O=>w.isFolder(n)?this.corruptServerItemsMap(h)?(A.default("[Sync] WARNING: Discarding corrupt folder description from server for "+n),!1):this.markChildren(n,h,O.toBeSaved,O.missingChildren).then(()=>!0):this.rs.local.setNodes(this.flush(O.toBeSaved)).then(()=>!0)):this.updateCommonTimestamp(n,E).then(()=>!0)})}handleResponse(n,p,h){const T=this.interpretStatus(h.statusCode);if(T.successful){if(p==="get")return this.handleGetResponse(n,T,h.body,h.contentType,h.revision);if(p==="put"||p==="delete")return this.completePush(n,p,T.conflict,h.revision).then(function(){return!0});throw new Error("cannot handle response for unknown action "+p)}{let E;return E=T.unAuth?new x.default:T.networkProblems?new N.default("Network request failed."):new Error("HTTP response code "+T.statusCode+" received."),this.dealWithFailure(n).then(()=>{throw this.rs._emit("error",E),E})}}finishTask(n){if(n.action!==void 0)return n.promise.then(p=>this.handleResponse(n.path,n.action,p),p=>(A.default("[Sync] wireclient rejects its promise!",n.path,n.action,p),this.handleResponse(n.path,n.action,{statusCode:"offline"}))).then(p=>{if(delete this._timeStarted[n.path],delete this._running[n.path],p&&this._tasks[n.path]){for(let h=0;h<this._tasks[n.path].length;h++)this._tasks[n.path][h]();delete this._tasks[n.path]}this.rs._emit("sync-req-done"),this.collectTasks(!1).then(()=>{!this.hasTasks()||this.stopped?(A.default("[Sync] Sync is done! Reschedule?",Object.getOwnPropertyNames(this._tasks).length,this.stopped),this.done||(this.done=!0,this.rs._emit("sync-done"))):setTimeout(()=>{this.doTasks()},10)})},p=>{A.default("[Sync] Error",p),delete this._timeStarted[n.path],delete this._running[n.path],this.rs._emit("sync-req-done"),this.done||(this.done=!0,this.rs._emit("sync-done"))});delete this._running[n.path]}doTasks(){let n,p,h=0;n=this.rs.remote.connected?this.rs.remote.online?this.numThreads:1:0;const T=n-Object.getOwnPropertyNames(this._running).length;if(T<=0)return!0;for(p in this._tasks)if(!this._running[p]&&(this._timeStarted[p]=this.now(),this._running[p]=this.doTask(p),this._running[p].then(this.finishTask.bind(this)),h++,h>=T))return!0;return h>=T}collectTasks(n){return o(this,void 0,void 0,function*(){return this.hasTasks()||this.stopped?Promise.resolve():this.collectDiffTasks().then(p=>p||n===!1?Promise.resolve():this.collectRefreshTasks(),function(p){throw p})})}addTask(n,p){this._tasks[n]||(this._tasks[n]=[]),typeof p=="function"&&this._tasks[n].push(p)}sync(){return this.done=!1,this.doTasks()?Promise.resolve():this.collectTasks().then(()=>{try{this.doTasks()}catch(n){A.default("[Sync] doTasks error",n)}},function(n){throw A.default("[Sync] Sync error",n),new Error("Local cache unavailable")})}static _rs_init(n){v=function(){A.default("[Sync] syncCycleCb calling syncCycle");const p=new g.default;p.isBrowser()&&function(h,T){function E(O){const q=T.getCurrentSyncInterval();d.default.isBackground=!O;const J=T.getCurrentSyncInterval();T._emit("sync-interval-change",{oldValue:q,newValue:J})}h.on("background",()=>E(!1)),h.on("foreground",()=>E(!0))}(p,n),n.sync||(n.sync=new $(n),n.syncStopped&&(A.default("[Sync] Instantiating sync stopped"),n.sync.stopped=!0,delete n.syncStopped)),A.default("[Sync] syncCycleCb calling syncCycle"),n.syncCycle()},P=function(){n.removeEventListener("connected",P),n.startSync()},n.on("ready",v),n.on("connected",P)}static _rs_cleanup(n){n.stopSync(),n.removeEventListener("ready",v),n.removeEventListener("connected",P),n.sync=void 0,delete n.sync}}w.applyMixins($,[b.default]),r.exports=$},function(r,a,s){(function(o){var f=this&&this.__awaiter||function(w,v,P,_){return new(P||(P=Promise))(function(U,I){function $(p){try{n(_.next(p))}catch(h){I(h)}}function C(p){try{n(_.throw(p))}catch(h){I(h)}}function n(p){var h;p.done?U(p.value):(h=p.value,h instanceof P?h:new P(function(T){T(h)})).then($,C)}n((_=_.apply(w,v||[])).next())})},d=this&&this.__importDefault||function(w){return w&&w.__esModule?w:{default:w}};const g=d(s(2)),b=d(s(10)),A=d(s(1)),y=s(0);let N;class x extends b.default{constructor(v){super(),this.addEvents(["change","local-events-done"]),this.db=v||N,this.db?(this.getsRunning=0,this.putsRunning=0,this.changesQueued={},this.changesRunning={},this.commitSlownessWarning=null):A.default("[IndexedDB] Failed to open DB")}getNodes(v){return f(this,void 0,void 0,function*(){const P=[],_={};for(let U=0,I=v.length;U<I;U++)this.changesQueued[v[U]]!==void 0?_[v[U]]=y.deepClone(this.changesQueued[v[U]]||void 0):this.changesRunning[v[U]]!==void 0?_[v[U]]=y.deepClone(this.changesRunning[v[U]]||void 0):P.push(v[U]);return P.length>0?this.getNodesFromDb(P).then(function(U){for(const I in _)U[I]=_[I];return U}):Promise.resolve(_)})}setNodes(v){return f(this,void 0,void 0,function*(){for(const P in v)this.changesQueued[P]=v[P]||!1;return this.maybeFlush(),Promise.resolve()})}maybeFlush(){this.putsRunning===0?this.flushChangesQueued():this.commitSlownessWarning||(this.commitSlownessWarning=o.setInterval(function(){console.warn("WARNING: waited more than 10 seconds for previous commit to finish")},1e4))}flushChangesQueued(){this.commitSlownessWarning&&(clearInterval(this.commitSlownessWarning),this.commitSlownessWarning=null),Object.keys(this.changesQueued).length>0&&(this.changesRunning=this.changesQueued,this.changesQueued={},this.setNodesInDb(this.changesRunning).then(this.flushChangesQueued.bind(this)))}getNodesFromDb(v){return new Promise((P,_)=>{const U=this.db.transaction(["nodes"],"readonly"),I=U.objectStore("nodes"),$={};this.getsRunning++,v.map(C=>{I.get(C).onsuccess=n=>{$[C]=n.target.result}}),U.oncomplete=()=>{P($),this.getsRunning--},U.onerror=U.onabort=()=>{_("get transaction error/abort"),this.getsRunning--}})}setNodesInDb(v){return f(this,void 0,void 0,function*(){return new Promise((P,_)=>{const U=this.db.transaction(["nodes"],"readwrite"),I=U.objectStore("nodes"),$=new Date().getTime();this.putsRunning++,A.default("[IndexedDB] Starting put",v,this.putsRunning);for(const C in v){const n=v[C];if(typeof n=="object")try{I.put(n)}catch(p){throw A.default("[IndexedDB] Error while putting",n,p),p}else try{I.delete(C)}catch(p){throw A.default("[IndexedDB] Error while removing",I,n,p),p}}U.oncomplete=()=>{this.putsRunning--,A.default("[IndexedDB] Finished put",v,this.putsRunning,new Date().getTime()-$+"ms"),P()},U.onerror=()=>{this.putsRunning--,_("transaction error")},U.onabort=()=>{_("transaction abort"),this.putsRunning--}})})}reset(v){const P=this.db.name;this.db.close(),x.clean(this.db.name,()=>{x.open(P,(_,U)=>{_?A.default("[IndexedDB] Error while resetting local storage",_):this.db=U,typeof v=="function"&&v(self)})})}forAllNodes(v){return f(this,void 0,void 0,function*(){return new Promise(P=>{this.db.transaction(["nodes"],"readonly").objectStore("nodes").openCursor().onsuccess=_=>{const U=_.target.result;U?(v(this.migrate(U.value)),U.continue()):P()}})})}closeDB(){this.putsRunning===0?this.db.close():setTimeout(this.closeDB.bind(this),100)}static open(v,P){const _=setTimeout(function(){P("timeout trying to open db")},1e4);try{const U=indexedDB.open(v,2);U.onerror=function(){A.default("[IndexedDB] Opening DB failed",U),clearTimeout(_),P(U.error)},U.onupgradeneeded=function(I){const $=U.result;A.default("[IndexedDB] Upgrade: from ",I.oldVersion," to ",I.newVersion),I.oldVersion!==1&&(A.default("[IndexedDB] Creating object store: nodes"),$.createObjectStore("nodes",{keyPath:"path"})),A.default("[IndexedDB] Creating object store: changes"),$.createObjectStore("changes",{keyPath:"path"})},U.onsuccess=function(){clearTimeout(_);const I=U.result;if(!I.objectStoreNames.contains("nodes")||!I.objectStoreNames.contains("changes"))return A.default("[IndexedDB] Missing object store. Resetting the database."),void x.clean(v,function(){x.open(v,P)});P(null,U.result)}}catch(U){A.default("[IndexedDB] Failed to open database: "+U),A.default("[IndexedDB] Resetting database and trying again."),clearTimeout(_),x.clean(v,function(){x.open(v,P)})}}static clean(v,P){const _=indexedDB.deleteDatabase(v);_.onsuccess=function(){A.default("[IndexedDB] Done removing DB"),P()},_.onerror=_.onabort=function(U){console.error('Failed to remove database "'+v+'"',U)}}static _rs_init(v){return new Promise((P,_)=>{x.open("remotestorage",function(U,I){U?_(U):(N=I,I.onerror=()=>{v._emit("error",U)},P())})})}static _rs_supported(){return new Promise((v,P)=>{const _=y.getGlobalContext();let U=!1;if(typeof navigator!="undefined"&&navigator.userAgent.match(/Android (2|3|4\.[0-3])/)&&(navigator.userAgent.match(/Chrome|Firefox/)||(U=!0)),"indexedDB"in _&&!U)try{const I=indexedDB.open("rs-check");I.onerror=function(){P()},I.onsuccess=function(){I.result.close(),indexedDB.deleteDatabase("rs-check"),v()}}catch{P()}else P()})}static _rs_cleanup(v){return new Promise(P=>{v.local&&v.local.closeDB(),x.clean("remotestorage",P)})}diffHandler(){}}y.applyMixins(x,[g.default]),r.exports=x}).call(this,s(5))},function(r,a,s){var o=this&&this.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};const f=o(s(10)),d=o(s(2)),g=o(s(1)),b=s(0),A="remotestorage:cache:nodes:";function y(x){return x.substr(0,A.length)===A||x.substr(0,"remotestorage:cache:changes:".length)==="remotestorage:cache:changes:"}class N extends f.default{constructor(){super(),this.addEvents(["change","local-events-done"])}diffHandler(...w){}getNodes(w){const v={};for(let P=0,_=w.length;P<_;P++)try{v[w[P]]=JSON.parse(localStorage[A+w[P]])}catch{v[w[P]]=void 0}return Promise.resolve(v)}setNodes(w){for(const v in w)localStorage[A+v]=JSON.stringify(w[v]);return Promise.resolve()}forAllNodes(w){let v;for(let P=0,_=localStorage.length;P<_;P++)if(localStorage.key(P).substr(0,A.length)===A){try{v=this.migrate(JSON.parse(localStorage[localStorage.key(P)]))}catch{v=void 0}v&&w(v)}return Promise.resolve()}static _rs_init(){}static _rs_supported(){return b.localStorageAvailable()}static _rs_cleanup(){const w=[];for(let v=0,P=localStorage.length;v<P;v++){const _=localStorage.key(v);y(_)&&w.push(_)}w.forEach(v=>{g.default("[LocalStorage] Removing",v),delete localStorage[v]})}}b.applyMixins(N,[d.default]),r.exports=N},function(r,a,s){var o=this&&this.__importDefault||function(A){return A&&A.__esModule?A:{default:A}};const f=o(s(2)),d=o(s(10)),g=s(0);class b extends d.default{constructor(){super(),this._storage={},this.addEvents(["change","local-events-done"])}getNodes(y){const N={};for(let x=0,w=y.length;x<w;x++)N[y[x]]=this._storage[y[x]];return Promise.resolve(N)}setNodes(y){for(const N in y)y[N]===void 0?delete this._storage[N]:this._storage[N]=y[N];return Promise.resolve()}forAllNodes(y){for(const N in this._storage)y(this.migrate(this._storage[N]));return Promise.resolve()}diffHandler(){}static _rs_init(){}static _rs_supported(){return!0}static _rs_cleanup(){}}g.applyMixins(b,[f.default]),r.exports=b}])})})(yr);var $o=Hn(yr.exports);function vr(e){let t,r;return{c(){t=Nt("title"),r=te(e[0])},l(a){t=$t(a,"title",{});var s=Rt(t);r=pr(s,e[0]),s.forEach(mt)},m(a,s){Bt(a,t,s),Te(t,r)},p(a,s){s&1&&In(r,a[0])},d(a){a&&mt(t)}}}function zn(e){let t,r,a,s=e[0]&&vr(e);const o=e[3].default,f=En(o,e,e[2],null);return{c(){t=Nt("svg"),s&&s.c(),r=hr(),f&&f.c(),this.h()},l(d){t=$t(d,"svg",{xmlns:!0,viewBox:!0,class:!0});var g=Rt(t);s&&s.l(g),r=hr(),f&&f.l(g),g.forEach(mt),this.h()},h(){Et(t,"xmlns","http://www.w3.org/2000/svg"),Et(t,"viewBox",e[1]),Et(t,"class","svelte-c8tyih")},m(d,g){Bt(d,t,g),s&&s.m(t,null),Te(t,r),f&&f.m(t,null),a=!0},p(d,[g]){d[0]?s?s.p(d,g):(s=vr(d),s.c(),s.m(t,r)):s&&(s.d(1),s=null),f&&f.p&&(!a||g&4)&&xn(f,o,d,d[2],a?Pn(o,d[2],g,null):Tn(d[2]),null),(!a||g&2)&&Et(t,"viewBox",d[1])},i(d){a||(Ot(f,d),a=!0)},o(d){ie(f,d),a=!1},d(d){d&&mt(t),s&&s.d(),f&&f.d(d)}}}function Yn(e,t,r){let{$$slots:a={},$$scope:s}=t,{title:o=null}=t,{viewBox:f}=t;return e.$$set=d=>{"title"in d&&r(0,o=d.title),"viewBox"in d&&r(1,f=d.viewBox),"$$scope"in d&&r(2,s=d.$$scope)},[o,f,s,a]}class Ue extends ue{constructor(t){super();ae(this,t,Yn,zn,Lt,{title:0,viewBox:1})}}function Vn(e){let t;return{c(){t=Nt("path"),this.h()},l(r){t=$t(r,"path",{d:!0}),Rt(t).forEach(mt),this.h()},h(){Et(t,"d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z")},m(r,a){Bt(r,t,a)},d(r){r&&mt(t)}}}function Kn(e){let t,r;const a=[{viewBox:"0 0 24 24"},e[0]];let s={$$slots:{default:[Vn]},$$scope:{ctx:e}};for(let o=0;o<a.length;o+=1)s=vt(s,a[o]);return t=new Ue({props:s}),{c(){Ce(t.$$.fragment)},l(o){Me(t.$$.fragment,o)},m(o,f){oe(t,o,f),r=!0},p(o,[f]){const d=f&1?Oe(a,[a[0],Ie(o[0])]):{};f&2&&(d.$$scope={dirty:f,ctx:o}),t.$set(d)},i(o){r||(Ot(t.$$.fragment,o),r=!0)},o(o){ie(t.$$.fragment,o),r=!1},d(o){se(t,o)}}}function Xn(e,t,r){return e.$$set=a=>{r(0,t=vt(vt({},t),kt(a)))},t=kt(t),[t]}class qo extends ue{constructor(t){super();ae(this,t,Xn,Kn,Lt,{})}}const _r=()=>{};function Go(e,t=0,r={}){let a=null,s=!1;const o=r.before||_r,f=r.after||_r;return function(...g){s||(s=!0,o()),a!=null&&(clearTimeout(a),a=null),!!r.isImmediate&&a==null?(s=!1,e.apply(this,g),f()):a=setTimeout(()=>{s=!1,a=null,e.apply(this,g),f()},t)}}function Qn(e){let t;return{c(){t=Nt("path"),this.h()},l(r){t=$t(r,"path",{d:!0}),Rt(t).forEach(mt),this.h()},h(){Et(t,"d","M256 105c-101.8 0-188.4 62.4-224 151 35.6 88.6 122.2 151 224 151s188.4-62.4 224-151c-35.6-88.6-122.2-151-224-151zm0 251.7c-56 0-101.8-45.3-101.8-100.7S200 155.3 256 155.3 357.8 200.6 357.8 256 312 356.7 256 356.7zm0-161.1c-33.6 0-61.1 27.2-61.1 60.4s27.5 60.4 61.1 60.4 61.1-27.2 61.1-60.4-27.5-60.4-61.1-60.4z")},m(r,a){Bt(r,t,a)},d(r){r&&mt(t)}}}function Zn(e){let t,r;const a=[{viewBox:"0 0 512 512"},e[0]];let s={$$slots:{default:[Qn]},$$scope:{ctx:e}};for(let o=0;o<a.length;o+=1)s=vt(s,a[o]);return t=new Ue({props:s}),{c(){Ce(t.$$.fragment)},l(o){Me(t.$$.fragment,o)},m(o,f){oe(t,o,f),r=!0},p(o,[f]){const d=f&1?Oe(a,[a[0],Ie(o[0])]):{};f&2&&(d.$$scope={dirty:f,ctx:o}),t.$set(d)},i(o){r||(Ot(t.$$.fragment,o),r=!0)},o(o){ie(t.$$.fragment,o),r=!1},d(o){se(t,o)}}}function ti(e,t,r){return e.$$set=a=>{r(0,t=vt(vt({},t),kt(a)))},t=kt(t),[t]}class Jo extends ue{constructor(t){super();ae(this,t,ti,Zn,Lt,{})}}function ei(e){let t;return{c(){t=Nt("path"),this.h()},l(r){t=$t(r,"path",{d:!0}),Rt(t).forEach(mt),this.h()},h(){Et(t,"d","M256.1 144.8c56.2 0 101.9 45.3 101.9 101.1 0 13.1-2.6 25.5-7.3 37l59.5 59c30.8-25.5 55-58.4 69.9-96-35.3-88.7-122.3-151.6-224.2-151.6-28.5 0-55.8 5.1-81.1 14.1l44 43.7c11.6-4.6 24.1-7.3 37.3-7.3zM52.4 89.7l46.5 46.1 9.4 9.3c-33.9 26-60.4 60.8-76.3 100.8 35.2 88.7 122.2 151.6 224.1 151.6 31.6 0 61.7-6.1 89.2-17l8.6 8.5 59.7 59 25.9-25.7L78.2 64 52.4 89.7zM165 201.4l31.6 31.3c-1 4.2-1.6 8.7-1.6 13.1 0 33.5 27.3 60.6 61.1 60.6 4.5 0 9-.6 13.2-1.6l31.6 31.3c-13.6 6.7-28.7 10.7-44.8 10.7-56.2 0-101.9-45.3-101.9-101.1 0-15.8 4.1-30.7 10.8-44.3zm87.8-15.7l64.2 63.7.4-3.2c0-33.5-27.3-60.6-61.1-60.6l-3.5.1z")},m(r,a){Bt(r,t,a)},d(r){r&&mt(t)}}}function ri(e){let t,r;const a=[{viewBox:"0 0 512 512"},e[0]];let s={$$slots:{default:[ei]},$$scope:{ctx:e}};for(let o=0;o<a.length;o+=1)s=vt(s,a[o]);return t=new Ue({props:s}),{c(){Ce(t.$$.fragment)},l(o){Me(t.$$.fragment,o)},m(o,f){oe(t,o,f),r=!0},p(o,[f]){const d=f&1?Oe(a,[a[0],Ie(o[0])]):{};f&2&&(d.$$scope={dirty:f,ctx:o}),t.$set(d)},i(o){r||(Ot(t.$$.fragment,o),r=!0)},o(o){ie(t.$$.fragment,o),r=!1},d(o){se(t,o)}}}function ni(e,t,r){return e.$$set=a=>{r(0,t=vt(vt({},t),kt(a)))},t=kt(t),[t]}class Wo extends ue{constructor(t){super();ae(this,t,ni,ri,Lt,{})}}var ii=Object.assign;function br(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return typeof e=="function"?e.apply(void 0,t):e}function wr(e,t){var r;return(r=br(e))!==null&&r!==void 0?r:t}function Er(e){function t(s,o){var f,d,g=r();return s=ii({},g||{},(f=br(e,s,g))!==null&&f!==void 0?f:s),f=a.ctx=Object.freeze(s),a.ancestry.unshift(f),o=o(f),a.ancestry.shift(),a.ctx=(d=a.ancestry[0])!==null&&d!==void 0?d:null,o}function r(){return a.ctx}var a={ancestry:[]};return{bind:function(s,o){return function(){for(var f=[],d=0;d<arguments.length;d++)f[d]=arguments[d];return t(s,function(){return o.apply(void 0,f)})}},run:t,use:r,useX:function(s){var o;if((o=a.ctx)===null||o===void 0)throw s=wr(s,"Context was used after it was closed"),Error(wr(void 0,s));return o}}}var le=Object.assign;function Fe(e){return typeof e=="function"}function ot(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return!e.apply(void 0,t)}}function Pr(e){return e===null}var oi=ot(Pr);function De(e){return e===void 0}var si=ot(De);function Le(e){return e===null||De(e)}var ai=ot(Le);function _t(e){return String(e)===e}function xr(e,t){return _t(e)&&_t(t)&&e.endsWith(t)}var ui=ot(xr);function Tr(e,t){return e===t}var ci=ot(Tr);function at(e){var t=Number(e);return!(isNaN(parseFloat(String(e)))||isNaN(Number(e))||!isFinite(t))}var li=ot(at);function Sr(e,t){return at(e)&&at(t)&&Number(e)>Number(t)}function Be(e,t){return at(e)&&at(t)&&Number(e)>=Number(t)}function $e(e){return!!Array.isArray(e)}var hi=ot($e);function Ar(e,t){return!!($e(t)||_t(t)&&_t(e))&&t.indexOf(e)!==-1}var fi=ot(Ar);function qe(e,t){return at(e)&&at(t)&&Number(e)<=Number(t)}function kr(e,t,r){return Be(e,t)&&qe(e,r)}var di=ot(kr);function Nr(e){return Le(e)||_t(e)&&!e.trim()}var pi=ot(Nr);function Wt(e){return!!e===e}var mi=ot(Wt);function Ge(e){return typeof e=="number"}var gi=ot(Ge);function he(e,t){return e.length===Number(t)}var yi=ot(he);function Je(e){if(e){if(Ge(e))return e===0;if(Object.prototype.hasOwnProperty.call(e,"length"))return he(e,0);if(typeof e=="object")return he(Object.keys(e),0)}return!0}var vi=ot(Je);function Rr(e){return Number.isNaN(e)}var _i=ot(Rr);function Or(e){return!!at(e)&&0>Number(e)}var bi=ot(Or),wi=ot(_t);function Ir(e){return!!e}var Ei=ot(Ir);function Cr(e,t){return at(e)&&at(t)&&Number(e)<Number(t)}function Mr(e,t){return t instanceof RegExp?t.test(e):!!_t(t)&&new RegExp(t).test(e)}var Pi=ot(Mr);function jr(e,t){return at(e)&&at(t)&&Number(e)===Number(t)}var xi=ot(jr);function Ur(e,t){return _t(e)&&_t(t)&&e.startsWith(t)}var xt={condition:function(e,t){try{return t(e)}catch{return!1}},doesNotEndWith:ui,doesNotStartWith:ot(Ur),endsWith:xr,equals:Tr,greaterThan:Sr,greaterThanOrEquals:Be,gt:Sr,gte:Be,inside:Ar,isArray:$e,isBetween:kr,isBlank:Nr,isBoolean:Wt,isEmpty:Je,isEven:function(e){return!!at(e)&&e%2==0},isFalsy:Ei,isNaN:Rr,isNegative:Or,isNotArray:hi,isNotBetween:di,isNotBlank:pi,isNotBoolean:mi,isNotEmpty:vi,isNotNaN:_i,isNotNull:oi,isNotNullish:ai,isNotNumber:gi,isNotNumeric:li,isNotString:wi,isNotUndefined:si,isNull:Pr,isNullish:Le,isNumber:Ge,isNumeric:at,isOdd:function(e){return!!at(e)&&e%2!=0},isPositive:bi,isString:_t,isTruthy:Ir,isUndefined:De,lengthEquals:he,lengthNotEquals:yi,lessThan:Cr,lessThanOrEquals:qe,longerThan:function(e,t){return e.length>Number(t)},longerThanOrEquals:function(e,t){return e.length>=Number(t)},lt:Cr,lte:qe,matches:Mr,notEquals:ci,notInside:fi,notMatches:Pi,numberEquals:jr,numberNotEquals:xi,shorterThan:function(e,t){return e.length<Number(t)},shorterThanOrEquals:function(e,t){return e.length<=Number(t)},startsWith:Ur};function We(e){for(var t in xt){var r=xt[t];Fe(r)&&e(t,r)}}var He=Er(function(e,t){var r={value:e.value,meta:e.meta||{}};return t?e.set?le(r,{parent:function(){return t&&{value:t.value,meta:t.meta,parent:t.parent}}}):t:le(r,{parent:Ti})});function Ti(){return null}function Ht(e,t,r){if(r||arguments.length===2)for(var a,s=0,o=t.length;s<o;s++)!a&&s in t||(a||(a=Array.prototype.slice.call(t,0,s)),a[s]=t[s]);return e.concat(a||t)}function ze(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return Fe(e)?e.apply(void 0,t):e}function Fr(e,t){var r;return(r=ze(e))!==null&&r!==void 0?r:t}function Dr(e,t){throw Error(Fr(t,e))}function Ye(){try{return Fe(Proxy)}catch{return!1}}function fe(e,t){return e={pass:e},t&&(e.message=t),e}function Lr(e,t,r){for(var a=[],s=3;s<arguments.length;s++)a[s-3]=arguments[s];return Wt(e)||e&&Wt(e.pass)||Dr("Incorrect return value for rule: "+JSON.stringify(e)),Wt(e)?fe(e):fe(e.pass,ze.apply(void 0,Ht([e.message,t,r],a)))}function Si(e){function t(s,o,f){return function(){for(var d=[],g=0;g<arguments.length;g++)d[g]=arguments[g];if(!(g=Lr.apply(void 0,Ht([He.run({value:e},function(){return o.apply(void 0,Ht([e],d))}),f,e],d))).pass){if(!Je(g.message))throw g.message;Dr("enforce/"+f+" failed with "+JSON.stringify(e))}return s}}var r={};if(!Ye())return We(function(s,o){r[s]=t(r,o,s)}),r;var a=new Proxy(r,{get:function(s,o){if(s=xt[o])return t(a,s,o)}});return a}function Ai(e,t){function r(f){a=!0,s=f}for(var a=!1,s=null,o=0;o<e.length;o++)if(t(e[o],r,o),a)return s}function Br(e){var t,r=[];return function a(s){return function(){for(var o=[],f=0;f<arguments.length;f++)o[f]=arguments[f];var d=xt[s];r.push(function(b){return Lr.apply(void 0,Ht([d.apply(void 0,Ht([b],o)),s,b],o))});var g={run:function(b){return Fr(Ai(r,function(A,y){var N,x=He.run({value:b},function(){return A(b)});x.pass||y(fe(!!x.pass,(N=ze(t,b,x.message))!==null&&N!==void 0?N:x.message))}),fe(!0))},test:function(b){return g.run(b).pass},message:function(b){return b&&(t=b),g}};return Ye()?g=new Proxy(g,{get:function(b,A){return xt[A]?a(A):b[A]}}):(We(function(b){g[b]=a(b)}),g)}}(e)}var de,Ho=(de={context:function(){return He.useX()},extend:function(e){le(xt,e)}},Ye()?new Proxy(le(Si,de),{get:function(e,t){return t in e?e[t]:xt[t]?Br(t):void 0}}):(We(function(e){de[e]=Br(e)}),de)),$r,zt=Object.assign,qr=($r=0,function(){return""+$r++});function ht(e){return typeof e=="function"}function Ve(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return ht(e)?e.apply(void 0,t):e}function Ke(e,t){var r;return(r=Ve(e))!==null&&r!==void 0?r:t}function Ct(e,t){throw Error(Ke(t,e))}function Gr(e,t){setTimeout(function(){Ct(e,t)},0)}function ki(e){function t(o,f,d){return a.references.push(),r(o,Ve(f,d)),function(){return[a.references[o],function(g){return r(o,Ve(g,a.references[o]))}]}}function r(o,f){var d=a.references[o];a.references[o]=f,ht(o=s[o][1])&&o(f,d),ht(e)&&e()}var a={references:[]},s=[];return{registerStateKey:function(o,f){var d=s.length;return s.push([o,f]),t(d,o)},reset:function(){var o=a.references;a.references=[],s.forEach(function(f,d){return t(d,f[0],o[d])})}}}var Mt,ft=Mt||(Mt={});function Ni(e,t){var r=t.suiteId;return t=t.suiteName,{optionalFields:e.registerStateKey(function(){return{}}),suiteId:e.registerStateKey(r),suiteName:e.registerStateKey(t),testCallbacks:e.registerStateKey(function(){return{fieldCallbacks:{},doneCallbacks:[]}}),testObjects:e.registerStateKey(function(a){return{prev:a?a.current:[],current:[]}})}}function Yt(e){return(e=[].concat(e))[e.length-1]}function Ri(){function e(){t=[0]}var t=[];return e(),{addLevel:function(){t.push(0)},cursorAt:function(){return Yt(t)},getCursor:function(){return[].concat(t)},next:function(){return t[t.length-1]++,Yt(t)},removeLevel:function(){t.pop()},reset:e}}ft[ft.DEFAULT=0]="DEFAULT",ft[ft.SUITE=1]="SUITE",ft[ft.EACH=2]="EACH",ft[ft.SKIP_WHEN=3]="SKIP_WHEN",ft[ft.OMIT_WHEN=4]="OMIT_WHEN",ft[ft.GROUP=5]="GROUP";var Q=Er(function(e,t){return t?null:zt({},{exclusion:{tests:{},groups:{}},isolate:{type:Mt.DEFAULT,keys:{current:{},prev:{}}},testCursor:Ri()},e)});function Xe(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return!e.apply(void 0,t)}}var Oi=Xe(function(e){return e===null});function pe(e,t){for(var r=[],a=0;a<e.length;a++){var s=e[a];Array.isArray(s)?r.push(pe(s,t)):(s=t(s),Oi(s)&&r.push(s))}return r}function Qe(e){return[].concat(e).reduce(function(t,r){return Array.isArray(r)?t.concat(Qe(r)):[].concat(t).concat(r)},[])}function Vt(e,t){var r=0;for(t=t.slice(0,-1);r<t.length;r++){var a=t[r];e[a]=Ke(e[a],[]),e=e[a]}return e}function Ze(e){return e==null}function Kt(e){return String(e)===e}function me(e){function t(a,s){var o=t.get(a);return o?o[1]:(s=s(),r.unshift([a.concat(),s]),r.length>Number(e)&&(r.length=e),s)}e===void 0&&(e=1);var r=[];return t.invalidate=function(a){var s=r.findIndex(function(o){var f=o[0];return a.length===Number(f.length)&&a.every(function(d,g){return d===f[g]})});-1<s&&r.splice(s,1)},t.get=function(a){return r[r.findIndex(function(s){var o=s[0];return a.length===Number(o.length)&&a.every(function(f,d){return f===o[d]})})]||null},t}function dt(){return Q.useX().stateRef}function Tt(){return dt().testObjects()}function Jr(){(0,Tt()[1])(function(e){return{prev:e.prev,current:[].concat(e.current)}})}function ge(e){(0,Tt()[1])(function(t){return{prev:t.prev,current:[].concat(e(t.current))}})}function Wr(){return Qe(pe(Tt()[0].current,function(e){return e.isPending()?e:null}))}var Ii=me();function gt(){var e=Tt()[0].current;return Ii([e],function(){return Qe(e)})}var Xt,Hr=Xt||(Xt={});Hr.Error="error",Hr.Warning="warning";var zr=function(){function e(t,r,a){var s=a===void 0?{}:a;a=s.message;var o=s.groupName;s=s.key,this.key=null,this.id=qr(),this.severity=Xt.Error,this.status=Yr,this.fieldName=t,this.testFn=r,o&&(this.groupName=o),a&&(this.message=a),s&&(this.key=s)}return e.prototype.run=function(){try{var t=this.testFn()}catch(r){t=r,this.message===void 0&&Kt(t)&&(this.message=r),t=!1}return t===!1&&this.fail(),t},e.prototype.setStatus=function(t){this.isFinalStatus()&&t!==tr||(this.status=t)},e.prototype.warns=function(){return this.severity===Xt.Warning},e.prototype.setPending=function(){this.setStatus(Zr)},e.prototype.fail=function(){this.setStatus(this.warns()?Xr:Kr)},e.prototype.done=function(){this.isFinalStatus()||this.setStatus(Qr)},e.prototype.warn=function(){this.severity=Xt.Warning},e.prototype.isFinalStatus=function(){return this.hasFailures()||this.isCanceled()||this.isPassing()},e.prototype.skip=function(t){this.isPending()&&!t||this.setStatus(Vr)},e.prototype.cancel=function(){this.setStatus(tn),Jr()},e.prototype.omit=function(){this.setStatus(tr)},e.prototype.valueOf=function(){return!this.isFailing()},e.prototype.hasFailures=function(){return this.isFailing()||this.isWarning()},e.prototype.isNonActionable=function(){return this.isSkipped()||this.isOmitted()||this.isCanceled()},e.prototype.isPending=function(){return this.status===Zr},e.prototype.isTested=function(){return this.hasFailures()||this.isPassing()},e.prototype.isOmitted=function(){return this.status===tr},e.prototype.isUntested=function(){return this.status===Yr},e.prototype.isFailing=function(){return this.status===Kr},e.prototype.isCanceled=function(){return this.status===tn},e.prototype.isSkipped=function(){return this.status===Vr},e.prototype.isPassing=function(){return this.status===Qr},e.prototype.isWarning=function(){return this.status===Xr},e}(),Yr="UNTESTED",Vr="SKIPPED",Kr="FAILED",Xr="WARNING",Qr="PASSING",Zr="PENDING",tn="CANCELED",tr="OMITTED";function Qt(){return Q.useX().testCursor.getCursor()}function ye(){return Q.useX().testCursor.next()}function Ci(e,t){if(e=(e=e.type)===void 0?Mt.DEFAULT:e,ht(t)){var r={current:{},prev:{}},a=Qt();return Q.run({isolate:{type:e,keys:r}},function(){Q.useX().testCursor.addLevel(),r.prev=function(){var o=Tt()[0].prev;return[].concat(Vt(o,Qt())).reduce(function(f,d){return d instanceof zr&&!Ze(d.key)&&(f[d.key]=d),f},{})}(),ge(function(o){return Vt(o,a)[Yt(a)]=[],o});var s=t();return Q.useX().testCursor.removeLevel(),ye(),s})}}function St(e){if(e){if(typeof e=="number")return e===0;if(Object.prototype.hasOwnProperty.call(e,"length"))return e.length===Number(0);if(typeof e=="object")return Object.keys(e).length===Number(0)}return!0}var er=Xe(St);function jt(e,t){return!(!t||e.fieldName!==t)}function ve(e){var t=Wr();return!St(t)&&(e?t.some(function(r){return jt(r,e)}):er(t))}function en(e,t){function r(f,d){o[f]++,s&&(o[d]=(o[d]||[]).concat(s))}var a=t.fieldName,s=t.message;e[a]=e[a]||{errorCount:0,warnCount:0,testCount:0};var o=e[a];return t.isNonActionable()||(e[a].testCount++,t.isFailing()?r("errorCount","errors"):t.isWarning()&&r("warnCount","warnings")),o}function rn(){return(rn=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)}function Mi(e,t,r){if(r||arguments.length===2)for(var a,s=0,o=t.length;s<o;s++)!a&&s in t||(a||(a=Array.prototype.slice.call(t,0,s)),a[s]=t[s]);return e.concat(a||t)}function nn(e,t,r){var a;r===void 0&&(r={});var s=(r=r||{}).group,o=r.fieldName;return t.reduce(function(f,d){if(s&&d.groupName!==s)var g=!0;else o&&!jt(d,o)?g=!0:(g=d.warns(),g=e==="warnings"!=!!g);return g||!d.hasFailures()||(f[d.fieldName]=(f[d.fieldName]||[]).concat(d.message||[])),f},rn({},o&&((a={})[o]=[],a)))}function ji(e){return on("errors",e)}function Ui(e){return on("warnings",e)}function on(e,t){return e=nn(e,gt(),{fieldName:t}),t?e[t]:e}function Fi(e,t){return e=sn("errors",e,t),t?e[t]:e}function Di(e,t){return e=sn("warnings",e,t),t?e[t]:e}function sn(e,t,r){return t||Ct("get"+e[0].toUpperCase()+e.slice(1)+"ByGroup requires a group name. Received `"+t+"` instead."),nn(e,gt(),{group:t,fieldName:r})}function an(e,t,r){return(r=!e.hasFailures()||r&&!jt(e,r))||(r=t==="warnings"!=!!(e=e.warns())),!r}function Li(e){return un("errors",e)}function Bi(e){return un("warnings",e)}function un(e,t){return gt().some(function(r){return an(r,e,t)})}function $i(e,t){return cn("errors",e,t)}function qi(e,t){return cn("warnings",e,t)}function cn(e,t,r){return gt().some(function(a){return t===a.groupName&&an(a,e,r)})}var Gi=me(20);function _e(){var e=gt(),t={stateRef:dt()};return Gi([e],Q.bind(t,function(){var r=dt().suiteName()[0];return zt(function(){var a={errorCount:0,groups:{},testCount:0,tests:{},warnCount:0};return gt().forEach(function(s){var o=s.fieldName,f=s.groupName;a.tests[o]=en(a.tests,s),f&&(a.groups[f]=a.groups[f]||{},a.groups[f][o]=en(a.groups[f],s))}),function(s){for(var o in s.tests)s.errorCount+=s.tests[o].errorCount,s.warnCount+=s.tests[o].warnCount,s.testCount+=s.tests[o].testCount;return s}(a)}(),{getErrors:Q.bind(t,ji),getErrorsByGroup:Q.bind(t,Fi),getWarnings:Q.bind(t,Ui),getWarningsByGroup:Q.bind(t,Di),hasErrors:Q.bind(t,Li),hasErrorsByGroup:Q.bind(t,$i),hasWarnings:Q.bind(t,Bi),hasWarningsByGroup:Q.bind(t,qi),isValid:Q.bind(t,function(a){var s=_e(),o=gt().reduce(function(f,d){return f[d.fieldName]||d.isOmitted()&&(f[d.fieldName]=!0),f},{});return(o=!!a&&!!o[a])?a=!0:s.hasErrors(a)?a=!1:a=!(St(o=gt())||a&&St(s.tests[a])||function(f){var d=dt().optionalFields()[0];return er(Wr().filter(function(g){return!(f&&!jt(g,f))&&d[g.fieldName]!==!0}))}(a))&&function(f){var d=gt(),g=dt().optionalFields()[0];return d.every(function(b){return!(!f||jt(b,f))||g[b.fieldName]===!0||b.isTested()||b.isOmitted()})}(a),a}),suiteName:r})}))}var Ji=me(20);function ln(){var e=gt(),t={stateRef:dt()};return Ji([e],Q.bind(t,function(){return zt({},_e(),{done:Q.bind(t,zi)})}))}function Wi(e,t,r){return!(ht(e)&&(!t||r.tests[t]&&!St(r.tests[t].testCount)))}function Hi(e){return!(ve()&&(!e||ve(e)))}function zi(){function e(){return a(_e())}for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var a=(t=t.reverse())[0];return t=t[1],r=ln(),Wi(a,t,r)?r:Hi(t)?(e(),r):(Yi(e,t),r)}function Yi(e,t){var r=Q.bind({},e);(0,dt().testCallbacks()[1])(function(a){return t?a.fieldCallbacks[t]=(a.fieldCallbacks[t]||[]).concat(r):a.doneCallbacks.push(r),a})}function hn(e){return e.forEach(function(t){return t()})}function Vi(){var e=function(){var t={};return{emit:function(r,a){t[r]&&t[r].forEach(function(s){s(a)})},on:function(r,a){return t[r]||(t[r]=[]),t[r].push(a),{off:function(){t[r]=t[r].filter(function(s){return s!==a})}}}}}();return e.on(bt.TEST_COMPLETED,function(t){if(!t.isCanceled()){t.done(),t=t.fieldName;var r=dt().testCallbacks()[0].fieldCallbacks;t&&!ve(t)&&Array.isArray(r[t])&&hn(r[t]),t=dt().testCallbacks()[0].doneCallbacks,ve()||hn(t)}}),e.on(bt.SUITE_COMPLETED,function(){(function(){var t=dt().optionalFields()[0];if(!St(t)){var r={};ge(function(a){return pe(a,function(s){var o=s.fieldName;if(r.hasOwnProperty(o))r[s.fieldName]&&s.omit();else{var f=t[o];ht(f)&&(r[o]=f(),r[s.fieldName]&&s.omit())}return s})})}})()}),e.on(bt.REMOVE_FIELD,function(t){gt().forEach(function(r){jt(r,t)&&(r.cancel(),function(a){ge(function(s){return pe(s,function(o){return a!==o?o:null})})}(r))})}),e}function fn(){var e=Q.useX();return e.bus||Ct(),e.bus}var bt,rr=bt||(bt={});function Ki(e){return dn(0,"tests",e)}function dn(e,t,r){var a=Q.useX("hook called outside of a running suite.");r&&[].concat(r).forEach(function(s){Kt(s)&&(a.exclusion[t][s]=e===0)})}function pn(e){for(var t in e)if(e[t]===!0)return!0;return!1}rr.TEST_COMPLETED="test_completed",rr.REMOVE_FIELD="remove_field",rr.SUITE_COMPLETED="suite_completed",Ki.group=function(e){return dn(0,"groups",e)};var Xi=Xe(Kt);function mn(e){var t=e.asyncTest,r=e.message;if(t&&ht(t.then)){var a=fn().emit,s=dt(),o=Q.bind({stateRef:s},function(){Jr(),a(bt.TEST_COMPLETED,e)});s=Q.bind({stateRef:s},function(f){e.isCanceled()||(e.message=Kt(f)?f:r,e.fail(),o())});try{t.then(o,s)}catch{s()}}}function be(e){var t=Qt();ge(function(r){return Vt(r,t)[Yt(t)]=e,r})}function gn(e){var t=Tt()[0].prev;if(St(t))be(e),t=e;else{var r=Qt();if(t=Vt(t,r)[Yt(r)],Ze(e.key))!er(r=t)||r.fieldName===e.fieldName&&r.groupName===e.groupName||(Q.useX().isolate.type!==Mt.EACH&&Gr(`Vest Critical Error: Tests called in different order than previous run.
    expected: `+t.fieldName+`
    received: `+e.fieldName+`
    This can happen on one of two reasons:
    1. You're using if/else statements to conditionally select tests. Instead, use "skipWhen".
    2. You are iterating over a list of tests, and their order changed. Use "each" and a custom key prop so that Vest retains their state.`),function(){var o=Tt(),f=o[1],d=o[0].prev;o=Vt(d,Qt());var g=Q.useX().testCursor.cursorAt();o.splice(g),f(function(b){return{prev:d,current:b.current}})}(),t=null),be(t=Ke(t,e));else{t=e.key;var a=Q.useX().isolate.keys.prev[t];r=e,a&&(r=a),a=r;var s=Q.useX().isolate.keys.current;Ze(s[t])?s[t]=a:Gr('Encountered the same test key "'+t+`" twice. This may lead to tests overriding each other's results, or to tests being unexpectedly omitted.`),be(t=r)}}if(Q.useX().omitted)return t.omit(),ye(),t;if(function(o){var f=o.fieldName;if(o=o.groupName,Q.useX().skipped)return!0;var d=Q.useX().exclusion,g=d.tests,b=g[f];if(b===!1)return!0;if(b=b===!0,o){t:{var A=Q.useX().exclusion.groups;if(Object.prototype.hasOwnProperty.call(A,o))var y=A[o]===!1;else{for(y in A)if(A[y]===!0){y=!0;break t}y=!1}}if(y)return!0;if(d.groups[o]===!0)return!(b||!pn(g)&&g[f]!==!1)}f=Q.useX().exclusion;t:{for(N in(d=Q.useX().exclusion).groups)if(d.groups[N]){var N=!0;break t}N=!1}return!(!N||o&&o in f.groups&&f.groups[o])||!b&&pn(g)}(e))return t.skip(!!Q.useX().skipped),ye(),t;if(e!==t&&t.fieldName===e.fieldName&&t.groupName===e.groupName&&t.isPending()&&t.cancel(),be(e),ye(),e.isUntested()){t=fn(),r=function(o){return Q.run({currentTest:o},function(){try{var f=o.testFn()}catch(d){f=d,o.message===void 0&&Kt(f)&&(o.message=d),f=!1}return f===!1&&o.fail(),f})}(e);try{r&&ht(r.then)?(e.asyncTest=r,e.setPending(),mn(e)):t.emit(bt.TEST_COMPLETED,e)}catch{Ct("Your test function "+e.fieldName+' returned a value. Only "false" or Promise returns are supported.')}}else(t=e.asyncTest)&&ht(t.then)&&(e.setPending(),mn(e));return e}function yn(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var a=ht(t[1])?t:Mi([void 0],t);t=a[0],r=a[1],a=a[2],Xi(e)&&vn("fieldName","string"),ht(r)||vn("Test callback","function");var s=Q.useX();return gn(t=new zr(e,r,{message:t,groupName:s.groupName,key:a}))}var zo=zt(yn,{memo:function(e){var t=me(100);return function(r){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];s=Q.useX().testCursor.cursorAt();var o=(a=a.reverse())[0],f=a[1],d=a[2];return s=[dt().suiteId()[0],r,s].concat(o),(a=t.get(s))===null?t(s,function(){return e(r,d,f)}):a[1].isCanceled()?(t.invalidate(s),t(s,function(){return e(r,d,f)})):gn(a[1])}}(yn)});function vn(e,t){Ct("Incompatible params passed to test function. "+e+" must be a "+t)}function Yo(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(e=e.reverse())[0];e=e[1],ht(r)||Ct("vest.create: Expected callback to be a function.");var a=Vi(),s=ki();return e={stateRef:Ni(s,{suiteId:qr(),suiteName:e}),bus:a},zt(Q.bind(e,function(){for(var o=[],f=0;f<arguments.length;f++)o[f]=arguments[f];return s.reset(),Ci({type:Mt.SUITE},function(){r.apply(void 0,o)}),a.emit(bt.SUITE_COMPLETED),ln()}),{get:Q.bind(e,_e),reset:s.reset,remove:Q.bind(e,function(o){a.emit(bt.REMOVE_FIELD,o)})})}const nr={},we={};class Ee{constructor(t,r){if(t!==nr)throw new TypeError("Options can only be created with the some or none functions");this._value=r}static some(t){return ut(t)}static none(){return ct()}static from(t){return t!=null?ut(t):ct()}static fromJSON(t){return Ee.from(t)}isNone(){return this._value===we}isSome(){return!this.isNone()}expect(t){if(this.isSome())return this._value;throw new Error(typeof t=="function"?t():t)}unwrap(){return this.expect("Tried to unwrap value of none Option")}unwrapOr(t){return this.isSome()?this._value:t}unwrapOrElse(t){return this.isSome()?this._value:t()}map(t){return this.isSome()?ut(t(this._value)):ct()}mapOr(t,r){return this.isSome()?ut(t(this._value)):ut(r)}mapOrElse(t,r){return this.isSome()?ut(t(this._value)):ut(r())}flatMap(t){return this.isSome()?t(this._value):ct()}flatMapOr(t,r){return this.isSome()?t(this._value):r}flatMapOrElse(t,r){return this.isSome()?t(this._value):r()}and(t){return this.isSome()?t:ct()}andThen(t){return this.isSome()?t(this._value):ct()}or(t){return this.isNone()?t:this}orElse(t){return this.isNone()?t():this}xor(t){const r=this.isSome(),a=t.isSome();return r&&!a?this:!r&&a?t:ct()}filter(t){return this.isSome()&&t(this._value)?this:ct()}getOrInsert(t){return this.isNone()&&(this._value=t),this}getOrInsertWith(t){return this.isNone()&&(this._value=t()),this}take(){if(this.isSome()){const t=this._value;return this._value=we,ut(t)}else return ct()}from(t){return t!=null?this._value=t:this.clear(),this}replace(t){return this._value=t,this}clear(){return this._value=we,this}ifSome(t,r){return this.isSome()?t(this._value):r&&r(),this}ifNone(t,r){return this.isNone()?t():r&&r(this._value),this}toJSON(){return this.unwrapOr(null)}toJS(){return this.unwrapOr(null)}}const ut=e=>new Ee(nr,e),ct=()=>new Ee(nr,we);class et{constructor(t){this._index=0,this._iter=t}[Symbol.iterator](){return this}iter(){return this}next(){return this._iter.next()}nextWithIndex(){const t=this._iter.next();return t.done?t:{value:[t.value,this._index++]}}enumerate(){throw new Error("iter/Enumerate was not imported!")}peekable(){throw new Error("iter/Peekable was not imported!")}forEach(t){throw new Error("iter/ForEach was not imported!")}map(t){throw new Error("iter/Map was not imported!")}merge(t){throw new Error("iter/Merge was not imported!")}concat(t){return this.merge(t)}filter(t){throw new Error("iter/Filter was not imported!")}step(t){throw new Error("iter/Step was not imported!")}skip(t){throw new Error("iter/Skip was not imported!")}take(t){throw new Error("iter/Take was not imported!")}toMap(t,r){throw new Error("iter/ToMap was not imported!")}count(){return this.reduce(0,t=>t+1)}consume(){let t=this.next();for(;!t.done;)t=this.next();return this}toArray(){return this.reduce([],(t,r)=>(t.push(r),t))}join(t){return this.toArray().join(t)}indexOf(t){let r=this.next(),a=0;for(;!r.done;){if(r.value===t)return a;a++,r=this.next()}return-1}findIndex(t){let r=this.nextWithIndex();for(;!r.done;){const[a,s]=r.value;if(t(a,s))return s;r=this.nextWithIndex()}return-1}find(t){let r=this.nextWithIndex();for(;!r.done;){const[a,s]=r.value;if(t(a,s))return ut(a);r=this.nextWithIndex()}return ct()}findAll(t){return this.filter(t)}nth(t=0){let r=this.next();for(t<0&&(t=0);!r.done;){if(t--<=0)return ut(r.value);r=this.next()}return ct()}first(){return this.nth(0)}last(){let t=this.next();for(;!t.done;){const r=this.next();if(r.done)return ut(t.value);t=r}return ct()}any(t){return this.findIndex(t)!==-1}some(t){return this.any(t)}none(t){return this.findIndex(t)===-1}all(t){let r=this.nextWithIndex();for(;!r.done;){const[a,s]=r.value;if(!t(a,s))return!1;r=this.nextWithIndex()}return!0}unflatten(t){throw new Error("iter/Unflatten was not imported!")}reduce(t,r){let a=this.next();for(;!a.done;){const s=a.value;t=r(t,s,this._index-1),a=this.next()}return t}reverse(){return Pe(this.toArray().reverse())}}function Pe(e){return e!=null?typeof e[Symbol.iterator]=="function"?new et(e[Symbol.iterator]()):typeof e.next=="function"?e instanceof et?e:new et(e):Pe(typeof e=="object"?Object.entries(e):[e]):Pe([])}class Qi extends et{constructor(t){super(t)}next(){const t=super.nextWithIndex();return t.done?t:{value:Zi(t.value)}}}et.prototype.enumerate=function(){return new Qi(this)};function Zi(e){const t=e[0],r=e;return r[0]=e[1],r[1]=t,r}class to extends et{constructor(t,r){super(t);this._fn=r}next(){let t=super.nextWithIndex();for(;!t.done;){const[r,a]=t.value;if(this._fn(r,a))return{done:!1,value:r};t=super.nextWithIndex()}return{done:!0,value:void 0}}}et.prototype.filter=function(t){return new to(this,t)};class eo extends et{constructor(t,r){super(t);this._fn=([a,s])=>(r(a,s),a)}next(){const t=super.nextWithIndex();return t.done?t:{done:!1,value:this._fn(t.value)}}}et.prototype.forEach=function(t){return new eo(this,t)};class ro extends et{constructor(t,r){super(t);this._fn=([a,s])=>r(a,s)}next(){const t=super.nextWithIndex();return t.done?t:{done:!1,value:this._fn(t.value)}}}et.prototype.map=function(t){return new ro(this,t)};class no extends et{constructor(t,r){super(t);this._other=r}next(){const t=super.next();return t.done?this._other.next():t}}et.prototype.merge=function(t){return new no(this,t)};class io extends et{constructor(){super(...arguments);this.peeked=[]}unpeekAll(){return this.peeked.length=0,this}unpeek(){return this.peeked.length>0?ut(this.peeked.shift()):ct()}peek(t=0){if(t<this.peeked.length)return ut(this.peeked[t]);{let r=this.peeked.length-t-1,a=super.next();for(;!a.done&&(this.peeked.push(a.value),!(--r<=0));)a=super.next();return a.done?ct():ut(a.value)}}next(){const t=this.unpeek();if(t.isSome())return{done:!1,value:t.unwrap()};const r=super.next();return r.done?r:{done:!1,value:r.value}}}et.prototype.peekable=function(){return new io(this)};class oo extends et{constructor(t,r){super(t);this._skipped=0,this._skip=(r<=0?0:r)|0}next(){let t=super.next();for(;!t.done;)if(this._skipped<=this._skip)this._skipped+=1,t=super.next();else return t;return{done:!0,value:void 0}}}et.prototype.skip=function e(e){return new oo(this,e)};class so extends et{constructor(t,r){super(t);this._stepped=0,this._step=r<=0?1:r|0}next(){let t=super.next();for(;!t.done;)if(this._stepped<this._step)this._stepped+=1,t=super.next();else return this._stepped=0,t;return{done:!0,value:void 0}}}et.prototype.step=function e(e){return new so(this,e)};class ao extends et{constructor(t,r){super(t);this._taken=0,this._count=(r<=0?0:r)|0}next(){return this._taken<this._count?(this._taken+=1,super.next()):{done:!0,value:void 0}}}et.prototype.take=function(t){return new ao(this,t)};const uo=e=>e,co=e=>e;class lo extends et{constructor(t,r=uo,a=co){super(t);this._map=([s,o])=>[r(s,o),a(s,o)]}toObject(){return this.reduce({},(t,r)=>(t[r[0]]=r[1],t))}next(){const t=super.nextWithIndex();return t.done?t:{done:!1,value:this._map(t.value)}}}et.prototype.toMap=function(t,r){return new lo(this,t,r)};class ho extends et{constructor(t,r){super(t);this._fn=r}next(){return this._fn(this._iter)}}et.prototype.unflatten=function(t){return new ho(this,t)};var Ut;(function(e){e[e.Forward=0]="Forward",e[e.Backward=1]="Backward"})(Ut||(Ut={}));class ir{constructor(t,r,a=1){this.start=t!==t?0:t,this.end=r!==r?this.start-1:r,this.step=a!==a?1:Math.abs(a),this.direction=t>r?Ut.Backward:Ut.Forward}static from(t,r,a=1){return new ir(t,r,a)}getStart(){return this.start}getEnd(){return this.end}getStep(){return this.step}getDirection(){return this.direction}contains(t){return this.start<=t&&t<=this.end}isEmpty(){return this.direction===Ut.Forward?this.start>this.end:this.start<this.end}iter(){return new et(this)}[Symbol.iterator](){return this}next(){if(this.isEmpty())return{done:!0,value:void 0};{const t=this.start;return this.direction===Ut.Forward?this.start+=this.step:this.start-=this.step,{done:!1,value:t}}}}const Vo=ir.from,Ft=Math.pow(2,31)-1|0;function fo(e,t){return e[0]=(t&4278190080)>>24,e[1]=(t&16711680)>>16,e[2]=(t&65280)>>8,e[3]=t&255,e}class po extends et{constructor(t){super(t);this.rng=t}iter(){return new et(this)}next(){return{done:!1,value:this.rng.nextFloat()}}}class mo extends et{constructor(t,r=0,a=1){super(t);this.rng=t,this.min=r,this.max=a}iter(){return new et(this)}nextFloat(){return this.rng.nextFloatInRange(this.min,this.max)}next(){return{done:!1,value:this.nextFloat()}}}class go extends et{constructor(t,r=0,a=Ft){super(t);this.rng=t,this.min=r|0,this.max=a|0}iter(){return new et(this)}nextInt(){return this.rng.nextIntInRange(this.min,this.max)}next(){return{done:!1,value:this.nextInt()}}}const yo=new Uint8Array(4);class _n{nextFloat(){return this.nextInt()/Ft}nextFloatInRange(t=0,r=1){return t+this.nextFloat()*(r-t)}nextIntInRange(t=0,r=Ft){return Math.round(this.nextFloatInRange(t,r))}shuffle(t){const r=t.length;for(let a=0;a<r;a++){const s=a+this.nextIntInRange(0,r-a-1),o=t[a];t[a]=t[s],t[s]=o}return t}fromArray(t){return t.length?ut(t[this.nextIntInRange(0,t.length-1)]):ct()}keyFromObject(t){return this.fromArray(Object.keys(t))}valueFromObject(t){return this.fromArray(Object.values(t))}fillBytes(t){const r=yo;for(let a=0,s=t.length;a<s;a++){const o=a%4;o===0&&fo(r,this.nextInt()),t[a]=r[o]}return t}[Symbol.iterator](){return this}iter(){return new et(this)}next(){return{done:!1,value:this.nextInt()}}float(){return new po(this)}uniformFloat(t=0,r=1){return new mo(this,t,r)}uniformInt(t=0,r=Ft){return new go(this,t,r)}}class bn extends _n{constructor(t=423257940){super();this.seed=t}setSeed(t=423257940){return this.seed=t,this}nextInt(){return this.seed=Math.imul(48271,this.seed)|0%Ft,this.seed&Ft}}const vo=new bn;class or extends _n{constructor(t,r,a,s){super();this.x=423257940,this.y=2829571177,this.z=2541948421,this.w=289122235,this.set(t,r,a,s)}static fromSeed(t){return new or().setSeed(t)}setSeed(t){const r=vo.setSeed(t);return this.set(r.nextInt(),r.nextInt(),r.nextInt(),r.nextInt())}set(t=423257940,r=2829571177,a=2541948421,s=289122235){return this.x=t|0,this.y=r|0,this.z=a|0,this.w=s|0,this}nextInt(){const t=this.x,r=t^t<<11;this.x=this.y,this.y=this.z,this.z=this.w;const a=this.w;return this.w=a^a>>19^(r^r>>8),this.w}}new bn;new or;export{or as $,No as A,vt as B,Dn as C,En as D,ko as E,Te as F,xn as G,Tn as H,Pn as I,wt as J,Do as K,Bo as L,qo as M,Ao as N,Eo as O,So as P,ur as Q,$o as R,ue as S,At as T,Wo as U,Jo as V,mr as W,Fo as X,Io as Y,Go as Z,Vo as _,Rt as a,bo as a0,Yo as a1,Ki as a2,zo as a3,Ho as a4,Po as a5,_o as a6,Lo as a7,Nt as a8,$t as a9,Uo as aa,jo as ab,Et as b,xo as c,mt as d,Rn as e,Bt as f,pr as g,In as h,ae as i,Ce as j,wo as k,hr as l,Me as m,To as n,oe as o,Oe as p,Ie as q,Co as r,Lt as s,te as t,ie as u,se as v,Mo as w,Ot as x,Oo as y,Ro as z};
